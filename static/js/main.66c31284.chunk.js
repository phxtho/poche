(this.webpackJsonp501v2=this.webpackJsonp501v2||[]).push([[0],{294:function(e,t,n){},299:function(e,t,n){},301:function(e,t,n){},304:function(e,t,n){},317:function(e,t){},346:function(e,t){},348:function(e,t){},359:function(e,t){},361:function(e,t){},388:function(e,t){},389:function(e,t){},394:function(e,t){},396:function(e,t){},403:function(e,t){},422:function(e,t){},456:function(e,t,n){},457:function(e,t,n){},458:function(e,t,n){},459:function(e,t,n){},460:function(e,t,n){},461:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=461},482:function(e,t,n){},483:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n.n(c),a=n(53),o=n.n(a),i=(n(294),n(66)),s=n(26),u=n(48),l=n(496),d=n(492),j=(n(299),n(5)),f=function(e){return Object(j.jsx)(u.a,{children:function(t){var n=t.location;return Object(j.jsx)(l.a,{className:"transition-group",children:Object(j.jsx)(d.a,{classNames:"fade",timeout:500,children:Object(j.jsx)(u.c,{location:n,children:e.children})},n.key)})}})},b=n(491),h=n(495),O=n(244),x=n(494),v=(n(301),function(e){var t=Object(x.a)({item:e.item,collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(s.a)(t,3),c=n[0].isDragging,r=n[1],a=n[2];return Object(j.jsxs)("div",{id:e.item.id,ref:a,className:"card",style:{display:c&&e.hideSourceOnDrag?"none":"flex",opacity:c?.5:1,top:e.item.y,left:e.item.x},children:[Object(j.jsx)("div",{className:"flex justify-end p-3",children:Object(j.jsx)("div",{ref:r,id:"".concat(e.item.id,"-drag-handle"),className:"card-drag-handle"})}),e.children]})}),p="card",m="collection",g=n(493),w=n(28),k=n.n(w),y=n(33),C=(n(303),n(304),n(45)),N=n(245),R=n(15),E=n(17),S=n(19),I=n(20),A=n(11),D=function(e){Object(S.a)(n,e);var t=Object(I.a)(n);function n(e){var c;return Object(R.a)(this,n),(c=t.call(this,e)).addHandler("onClick",(function(e,t){return window.open(t.href),!0})),c}return Object(E.a)(n,[{key:"createInputRules",value:function(){return[Object(A.O)({regexp:function(){try{return new RegExp("?<!!)[(.*?)]((.*?))")}catch(e){return/[^!]\[(.+?)\]\((.+?)\)/}}(),type:this.type,getAttributes:function(e){var t=Object(s.a)(e,3);t[0];return{text:t[1],href:t[2]}}})]}},{key:"createPasteRules",value:function(){return[]}}]),n}(C.h),q=function(e){Object(S.a)(n,e);var t=Object(I.a)(n);function n(){return Object(R.a)(this,n),t.apply(this,arguments)}return Object(E.a)(n,[{key:"createInputRules",value:function(){return[Object(A.Q)({regexp:/!\[(.+?)\]\((.+?)\)/,type:this.type,getAttributes:function(e){var t=Object(s.a)(e,3),n=(t[0],t[1]);return{src:t[2],alt:n}}})]}}]),n}(C.f),F=q,T=Object(c.forwardRef)((function(e,t){var n,r=Object(c.useCallback)((function(e){var t=e.json,n=e.invalidContent;return e.transformers.remove(t,n)}),[]),a=Object(N.f)({extensions:function(){return[new C.b({}),new C.g,new C.a,new D({defaultTarget:"_blank",autoLink:!0}),new C.e({}),new C.c({}),new C.i,new C.j,new F({enableResizing:!0}),new C.d,new C.k]},onError:r,content:null===(n=e.state)||void 0===n?void 0:n.doc}),o=a.manager,i=a.state,s=a.setState,u=a.getContext;return Object(c.useImperativeHandle)(t,(function(){return u()}),[u]),Object(j.jsx)("div",{className:"remirror-theme",children:Object(j.jsx)(N.b,{manager:o,initialContent:i,onChange:function(t){var n;s(t.state),null===(n=e.onChange)||void 0===n||n.call(e,t)},onFocus:function(t,n){var c;null===(c=e.onFocus)||void 0===c||c.call(e,t,n)},onBlur:function(t,n){var c;null===(c=e.onBlur)||void 0===c||c.call(e,t,n)},children:Object(j.jsx)(N.a,{})})})})),_=n(73),B=n(120),L=n.n(B),W=n(240),V=n.n(W);_.a.plugin(L.a),_.a.plugin(V.a);var M=new _.a("notes");M.search({fields:["title","text"],build:!0}).then((function(){return console.log("Index created succesfully")})).catch((function(e){return console.log("ERROR failed to build index")}));var U={type:"doc",content:[{type:"paragraph"}]};function H(e){return P.apply(this,arguments)}function P(){return(P=Object(y.a)(k.a.mark((function e(t){var n,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.id||t._id,e.next=4,M.upsert(n,(function(e){return t}));case 4:return c=e.sent,e.abrupt("return",c);case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR: couldn't update \n".concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function G(e,t,n,c,r,a){return Q.apply(this,arguments)}function Q(){return(Q=Object(y.a)(k.a.mark((function e(t,n,c,r,a,o){var i,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(i={_id:t||Object(g.a)(),id:null,title:n||null,meta:c||{},state:r||U,createdTime:a||Date.now(),lastEditedTime:o||Date.now()}).id=i._id,e.next=5,M.putIfNotExists(i);case 5:return s=e.sent,e.abrupt("return",s);case 9:e.prev=9,e.t0=e.catch(0),console.log("ERROR: couldn't create doc ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function J(){return(J=Object(y.a)(k.a.mark((function e(t){var n,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.get(t).then((function(e){return e._rev}));case 3:return n=e.sent,e.next=6,M.remove(t,n);case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.log("ERROR: couldn't delete \n".concat(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function z(){return X.apply(this,arguments)}function X(){return(X=Object(y.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.allDocs({include_docs:!0});case 3:return n=e.sent,e.abrupt("return",null===n||void 0===n||null===(t=n.rows)||void 0===t?void 0:t.map((function(e){return e.doc})));case 7:e.prev=7,e.t0=e.catch(0),console.log("ERROR fetching all notes \n".concat(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Y(e){return $.apply(this,arguments)}function $(){return($=Object(y.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.get(t);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log("ERROR fetching  ".concat(t," \n").concat(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function K(e){M.changes({since:"now",live:!0}).on("change",(function(){return e()}))}function Z(){return Z=Object(y.a)(k.a.mark((function e(t){var n,c=arguments;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:["title","text"],e.abrupt("return",null===M||void 0===M?void 0:M.search({query:t,fields:n,include_docs:!0}).then((function(e){return e})).catch((function(e){return console.log("Search failed ".concat(e))})));case 2:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}var ee=n(162),te=n(61),ne=n.n(te),ce=n(9),re={items:[],addItem:function(e,t){re.items=oe(e,t)},removeItem:function(e,t){re.items=ae(e,t)}},ae=function(e,t){return e.filter((function(e){return e!==t}))},oe=function(e,t){return e.find((function(e){return e===t}))?e:[].concat(Object(ce.a)(e),[t])},ie=r.a.createContext(re);ie.displayName="NotesContext";var se=ie,ue={content:{borderRadius:".5rem",height:"fit-content",maxWidth:"40rem",marginLeft:"auto",marginRight:"auto"}},le=function(e){ne.a.setAppElement("#root");var t=Object(c.useContext)(se),n=t.items,r=t.removeItem;return Object(j.jsx)(ne.a,{isOpen:e.isOpen,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,style:ue,children:Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{className:"text-center mb-2",children:"actions"}),Object(j.jsxs)("div",{className:"flex flex-col space-y-4",children:[Object(j.jsxs)("button",{className:"w-full h-16 rounded-lg shadow-md hover:shadow-lg hover:bg-gray-200",onClick:function(){r(n,e.note.id),e.onRequestClose()},children:[Object(j.jsx)(ee.b,{className:"mx-auto"})," Close"]}),Object(j.jsxs)("button",{className:"w-full h-16 rounded-lg shadow-md bg-red-500 text-white hover:shadow-lg hover:bg-red-600",onClick:function(){r(n,e.note.id),function(e){J.apply(this,arguments)}(e.note.id),e.onRequestClose()},children:[Object(j.jsx)(ee.a,{className:"mx-auto"})," Delete"]})]})]})})},de=function(e){var t=Object(c.useState)(),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(!1),u=Object(s.a)(o,2),l=(u[0],u[1]),d=Object(c.useState)(!1),f=Object(s.a)(d,2),b=f[0],h=f[1],O=Object(c.useRef)(),x=Object(c.useCallback)(Object(y.a)(k.a.mark((function t(){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=5;break}return t.next=3,Y(e.id);case 3:(n=t.sent)&&a(n);case 5:case"end":return t.stop()}}),t)}))),[e.id]);Object(c.useEffect)((function(){x()}),[x]);var v=Object(c.useCallback)((function(e){var t=Object(i.a)(Object(i.a)({},r),{},{state:e.state.toJSON(),lastEditedTime:Date.now()});a(t)}),[r]),p=Object(c.useCallback)((function(e,t){var n;r.text=null===(n=O.current)||void 0===n?void 0:n.getState().doc.textContent,H(r),l(!1)}),[r]),m=Object(c.useCallback)((function(t,n){var c;l(!0),null===(c=e.handleFocus)||void 0===c||c.call(e,O.current)}),[]);return r?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"w-full md:w-5/12 lg:w-1/3 shadow-lg rounded-lg p-5 lg:mr-4 mb-4",children:[Object(j.jsxs)("div",{className:"flex justify-between",children:[Object(j.jsx)("textarea",{placeholder:"Title",defaultValue:null===r||void 0===r?void 0:r.title,className:"font-medium text-3xl w-11/12",onChange:function(e){var t=e.target.value;t.replace(/\n/,""),r.title=t,H(r)},wrap:"soft"}),Object(j.jsx)("div",{className:"flex space-x-2",children:Object(j.jsx)("button",{className:"h-4 w-4 rounded-full bg-black hover:bg-gray-700",onClick:function(){return h(!0)}})})]}),Object(j.jsx)(T,{state:r.state,onChange:v,onBlur:p,onFocus:m,ref:O})]}),Object(j.jsx)(le,{isOpen:b,note:r,onRequestClose:function(){h(!1)}})]}):null},je=n(243),fe=(n(456),function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useCallback)(Object(y.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)}))),[a]);return Object(c.useEffect)((function(){o(),K(o)}),[o]),Object(j.jsx)("div",{className:"flex w-64 flex-col rounded items-center divide-y divide-gray-200 divide-opacity-50",children:r.map((function(t,n){var c,r=(null===t||void 0===t||null===(c=t.state)||void 0===c?void 0:c.doc)?t.text:"";return Object(j.jsx)("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:function(){e.handleNoteButtonClick(t)},children:t.title||r},n)}))})});var be=function(){return Object(j.jsx)(b.a,{backend:O.a,children:Object(j.jsx)(he,{})})},he=function(e){var t=Object(c.useState)({x:0,y:0}),n=Object(s.a)(t,2),r=(n[0],n[1]),a=Object(c.useState)({x:0,y:0}),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(je.a)((function(e){return e.cards})),d=Object(h.a)({accept:[p,m],drop:function(e,t){var n=t.getDifferenceFromInitialOffset(),c=Math.round(e.x+n.x),r=Math.round(e.y+n.y);return e.type===p?O(e.id,c,r):u({x:c,y:r}),{x:c,y:r}}}),f=Object(s.a)(d,2)[1],b=Object(c.useCallback)((function(e,t){Object(g.a)()}),[]),O=Object(c.useCallback)((function(e,t,n){}),[]);return Object(j.jsxs)("div",{className:"canvas",ref:f,onMouseMove:function(e){r({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY})},onDoubleClick:function(e){b(e.nativeEvent.offsetX,e.nativeEvent.offsetY)},children:[!1,Object(j.jsx)(v,{item:{type:m,id:Object(g.a)(),x:i.x,y:i.y},children:Object(j.jsx)(fe,{handleNoteButtonClick:function(e){null===e||void 0===e||e.id}})}),Object.entries(l).map((function(e,t){var n=Object(s.a)(e,2),c=(n[0],n[1]);return Object(j.jsx)(v,{item:c,hideSourceOnDrag:!0,children:Object(j.jsx)(de,{id:c.id})},t)}))]})},Oe=n(38);n(457);function xe(){var e,t=Object(c.useState)(!1),n=Object(s.a)(t,2),r=(n[0],n[1]),a=Object(c.useState)(""),o=Object(s.a)(a,2),i=o[0],u=o[1],l=Object(c.useState)(),d=Object(s.a)(l,2),f=d[0],b=d[1],h=Object(c.useContext)(se),O=h.items,x=h.addItem,v=function(e){(function(e){return Z.apply(this,arguments)})(e).then((function(e){return b(e)}))};return Object(j.jsxs)("div",{className:"relative shadow-sm",children:[Object(j.jsxs)("div",{className:"h-10 w-72  rounded-full flex justify-between pl-6 items-center relative",children:[Object(j.jsx)("input",{placeholder:"Search",className:"w-3/4 h-full bg-transparent overflow-ellipsis",type:"text",value:i,onChange:function(e){var t=e.target.value;u(t),v(t)},onFocus:function(e){return r(!0)},onBlur:function(e){return r(!1)}}),Object(j.jsx)("button",{className:"h-10 w-10 rounded-full bg-black text-white flex justify-center items-center",children:Object(j.jsx)(Oe.l,{})})]}),""!==i&&(null===f||void 0===f?void 0:f.total_rows)>0&&Object(j.jsx)("div",{className:"search-results rounded-b-lg overflow-hidden",children:null===f||void 0===f||null===(e=f.rows)||void 0===e?void 0:e.map((function(e,t){var n;return Object(j.jsx)("button",{className:"result",onClick:function(t){x(O,e.doc.id),u("")},children:null!==(n=e.doc.title)&&void 0!==n?n:e.doc.title},t)}))})]})}function ve(){return Object(j.jsxs)("div",{className:"min-h-screen",children:[Object(j.jsx)("div",{id:"top-bar",className:"flex flex-row-reverse p-8",children:Object(j.jsx)(xe,{})}),Object(j.jsx)(be,{})]})}function pe(e){var t=Object(c.useContext)(se),n=t.items,r=t.addItem,a=Object(c.useCallback)(Object(y.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:t=e.sent,r(n,t.id);case 4:case"end":return e.stop()}}),e)}))),[r,n]);return Object(j.jsx)("button",{onClick:function(){var t;a(),null===e||void 0===e||null===(t=e.handleClick)||void 0===t||t.call(e)},className:"rounded-full h-16 w-16 fixed right-8 bottom-8 bg-black text-white flex justify-center items-center shadow-md hover:pointer border-2 border-white",children:Object(j.jsx)(Oe.a,{})})}var me=n(83),ge=(n(458),function(e){return e?"active":""}),we=function(){var e=Object(N.e)(),t=Object(N.d)();return Object(j.jsxs)("div",{className:"toolbar space-x-2",children:[Object(j.jsx)("button",{onClick:function(){e.undo(),e.focus()},children:Object(j.jsx)(Oe.f,{})}),Object(j.jsx)("button",{onClick:function(){e.redo(),e.focus()},children:Object(j.jsx)(Oe.k,{})}),Object(j.jsx)("button",{className:ge(t.bold()),onClick:function(){e.toggleBold(),e.focus()},children:Object(j.jsx)(Oe.b,{})}),Object(j.jsx)("button",{className:ge(t.italic()),onClick:function(){e.toggleItalic(),e.focus()},children:Object(j.jsx)(Oe.g,{})}),Object(j.jsx)("button",{className:ge(t.underline()),onClick:function(){e.toggleUnderline(),e.focus()},children:Object(j.jsx)(me.b,{})}),Object(j.jsx)("button",{className:ge(t.code()),onClick:function(){e.toggleCode(),e.focus()},children:Object(j.jsx)(Oe.e,{})}),Object(j.jsx)("button",{className:ge(t.blockquote()),onClick:function(){e.toggleBlockquote(),e.focus()},children:Object(j.jsx)(Oe.j,{})}),Object(j.jsx)("button",{className:ge(t.bulletList()),onClick:function(){e.toggleBulletList(),e.focus()},children:Object(j.jsx)(Oe.i,{})}),Object(j.jsx)("button",{className:ge(t.taskList()),onClick:function(){e.toggleTaskList(),e.focus()},children:Object(j.jsx)(Oe.c,{})})]})};n(459);function ke(){var e=Object(c.useContext)(se).items,t=Object(c.useState)(),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(u.d)();return Object(c.useEffect)((function(){0===e.length&&o("/experiment-501.V2")}),[e]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"editor-list",children:e.map((function(e,t){return Object(j.jsx)(de,{id:e,handleFocus:function(e){return a(e)}},t)}))}),r&&Object(j.jsx)(N.c.Provider,{value:r,children:Object(j.jsx)(we,{})}),Object(j.jsx)(pe,{})]})}n(460);var ye=function(){var e=Object(u.d)();return Object(j.jsx)("button",{onClick:function(){return e("/experiment-501.V2/settings")},className:"rounded-full h-16 w-16 fixed left-8 bottom-8 hover:bg-black hover:text-white flex justify-center items-center shadow-md hover:pointer",children:Object(j.jsx)(me.a,{})})};function Ce(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),o=Object(s.a)(a,2),i=o[0],l=o[1],d=Object(c.useState)(),f=Object(s.a)(d,2),b=f[0],h=f[1],O=Object(u.d)(),x=Object(c.useContext)(se),v=x.items,p=x.addItem,m=Object(c.useCallback)(Object(y.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)}))),[r]);return Object(c.useEffect)((function(){return m(),K(m),function(){r([])}}),[m]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"p-5",children:[Object(j.jsxs)("table",{className:"rounded-lg divide-y divide-gray-200 note-list shadow-md",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{className:"w-11/12 lg:w-9/12",children:"Note"}),Object(j.jsx)("th",{className:"hidden lg:block w-2/12",children:"Edited"}),Object(j.jsx)("th",{className:"w-1/12"})]})}),Object(j.jsx)("tbody",{children:n.sort((function(e,t){return e.lastEditedTime<t.lastEditedTime?1:-1})).map((function(e,t){return Object(j.jsxs)("tr",{id:"row-".concat(e.id),children:[Object(j.jsx)("td",{children:Object(j.jsx)("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:function(){p(v,e.id),O("/experiment-501.V2/p")},children:Object(j.jsxs)("div",{className:"flex flex-col text-left",children:[Object(j.jsxs)("div",{className:"font-medium flex space-x-1",children:[Object(j.jsx)("span",{children:e.title||"No Title"}),Object(j.jsx)("span",{className:"rounded-full h-2 w-2 bg-green-500 ".concat(v.find((function(t){return t==e.id}))?"inline":"hidden"," ")})]}),Object(j.jsx)("span",{className:"text-sm text-gray-500 font-light",children:e.text||"empty"})]})})}),Object(j.jsx)("td",{className:"hidden md:block",children:new Date(e.lastEditedTime).toLocaleString()}),Object(j.jsx)("td",{children:Object(j.jsx)("button",{onClick:function(){return function(e){h(e),l(!0)}(e)},children:Object(j.jsx)(Oe.h,{})})})]},t)}))})]}),Object(j.jsx)(ye,{}),Object(j.jsx)(pe,{handleClick:function(){return O("/experiment-501.V2/p")}})]}),Object(j.jsx)(le,{isOpen:i,note:b,onRequestClose:function(){h(null),l(!1)}})]})}var Ne=n(164),Re=n.n(Ne);_.a.plugin(L.a);var Ee,Se,Ie,Ae=new _.a("peers");function De(){return(De=Object(y.a)(k.a.mark((function e(t){var n,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.id||t._id,e.next=4,Ae.upsert(n,(function(e){return t}));case 4:return c=e.sent,e.abrupt("return",c);case 8:e.prev=8,e.t0=e.catch(0),console.log("ERROR: couldn't upsert \n".concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function qe(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(y.a)(k.a.mark((function e(){var t,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ae.allDocs({include_docs:!0});case 3:return n=e.sent,e.abrupt("return",null===n||void 0===n||null===(t=n.rows)||void 0===t?void 0:t.map((function(e){return e.doc})));case 7:e.prev=7,e.t0=e.catch(0),console.log("ERROR fetching all peers \n".concat(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}Ee=localStorage.getItem("peerId");try{Se=new Re.a(Ee)}catch(rt){Ee=(Se=new Re.a).id}Se.on("open",(function(e){localStorage.setItem("peerId",e),console.log("My peer ID is: "+e)})),Se.on("connection",(function(e){console.log("Connected to ".concat(e.peer)),Object.keys(Se.connections).forEach((function(e){Te(e)})),(e=e).on("data",(function(t){console.log("Recieved data from ".concat(e.peer)),console.log(t),Array.isArray(t)&&t.forEach((function(e){return H(e)}))}))})),Se.on("error",(function(e){console.error(e)}));var Te=function(e){!function(e){De.apply(this,arguments)}({id:e})};function _e(e){try{Ie=Se.connect(e,{serialization:"json"}),Object.keys(Se.connections).forEach((function(e){Te(e)}))}catch(t){console.log(t)}}function Be(){return Le.apply(this,arguments)}function Le(){return(Le=Object(y.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z();case 3:t=e.sent,Ie.send(t),console.log("data sent"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var We=n(67),Ve=n.n(We),Me=n(121),Ue=n.n(Me),He=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){var e;return qe().then((function(e){return r(e)})),e=function(e){return qe().then((function(e){return r(e)}))},Ae.changes({since:"now",live:!0}).on("change",(function(){return e()})),function(){r([])}}),[]),Object(j.jsx)("div",{className:"flex space-x-2",children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(j.jsx)("button",{className:"rounded-3xl shadow-lg bg-black text-white h-10 w-10 flex flex-col justify-center items-center overflow-hidden ",children:Object(j.jsx)(Oe.m,{})},t)}))})};function Pe(){var e,t,n=Object(c.useState)(""),r=Object(s.a)(n,2),a=r[0],o=r[1],i=Object(c.useState)(),u=Object(s.a)(i,2),l=(u[0],u[1]);Object(c.useEffect)((function(){var e=document.getElementById("qrcode");null===Ve.a||void 0===Ve.a||Ve.a.toCanvas(e,localStorage.getItem("peerId")),t=document.getElementById("videoOutCanvas")}),[]);return requestAnimationFrame((function n(){if(e&&e.readyState===e.HAVE_ENOUGH_DATA){var c=t.getContext("2d");t.height=e.videoHeight,t.width=e.videoWidth,c.drawImage(e,0,0,t.width,t.height);var r=c.getImageData(0,0,t.width,t.height),a=Ue()(r.data,r.width,r.height,{inversionAttempts:"dontInvert"});a&&(console.log("Got QR Code"),console.log(a.data),o(a.data))}requestAnimationFrame(n)})),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"flex",children:[Object(j.jsxs)("div",{className:"flex flex-col",children:[Object(j.jsx)("input",{className:"border border-black",type:"text",value:a,onChange:function(e){o(e.target.value)}}),Object(j.jsx)("button",{className:"rounded bg-blue-500 text-white",onClick:function(e){_e(a)},children:"Connect"})]}),Object(j.jsxs)("div",{className:"flex flex-col",children:[Object(j.jsx)("textarea",{className:"border border-black",onChange:function(e){l(e.target.value)}}),Object(j.jsx)("button",{className:"bg-green-500 text-white rounded",onClick:function(e){Be()},children:"Send"})]})]}),Object(j.jsx)(He,{}),Object(j.jsx)("canvas",{id:"videoOutCanvas",hidden:!0}),Object(j.jsx)("video",{id:"video"})]})}var Ge={content:{borderRadius:".5rem",height:"fit-content",maxWidth:"40rem",marginLeft:"auto",marginRight:"auto"}};ne.a.setAppElement("#root");var Qe=function(e){var t=Object(c.useState)(),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(null),i=Object(s.a)(o,2),u=i[0],l=i[1],d=Object(c.useCallback)((function(e){null!==e&&l(e)}),[]);return Object(c.useEffect)((function(){var e=localStorage.getItem("peerId");a(e)}),[]),Object(c.useEffect)((function(){u&&(null===Ve.a||void 0===Ve.a||Ve.a.toCanvas(u,r))}),[r,u]),Object(j.jsx)(ne.a,{isOpen:e.isOpen,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,style:Ge,children:Object(j.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[Object(j.jsx)("canvas",{id:"qrcode",ref:d}),Object(j.jsx)("p",{className:"text-center",children:r})]})})},Je=n(242),ze={content:{borderRadius:".5rem",height:"fit-content",maxWidth:"40rem",marginLeft:"auto",marginRight:"auto"}};ne.a.setAppElement("#root");var Xe=function(e){var t=Object(c.useState)(null),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(null),i=Object(s.a)(o,2),u=i[0],l=i[1],d=Object(c.useState)(""),f=Object(s.a)(d,2),b=(f[0],f[1]),h=Object(c.useState)(),O=Object(s.a)(h,2),x=O[0],v=O[1],p=Object(c.useCallback)((function(e){null!==e&&a(e)}),[]),m=Object(c.useCallback)((function(e){null!==e&&l(e)}),[]);Object(c.useEffect)((function(){try{navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",frameRate:{ideal:10,max:15}}}).then((function(e){v(e),u&&(u.srcObject=e,u.setAttribute("playsinline","true"),u.play(),requestAnimationFrame(g))}))}catch(e){console.log("Couldn't set up video stream \n:".concat(e))}return function(){g=null,null===x||void 0===x||x.getTracks().forEach((function(e){e.stop()}))}}),[u]),Object(c.useEffect)((function(){!e.isOpen&&(null===x||void 0===x?void 0:x.active)&&x.getTracks().forEach((function(e){e.stop()}))}),[e.isOpen,x]);var g=function(){if(u&&u.readyState===u.HAVE_ENOUGH_DATA){var t=r.getContext("2d");r.height=u.videoHeight,r.width=u.videoWidth,t.drawImage(u,0,0,r.width,r.height);var n=t.getImageData(0,0,r.width,r.height),c=Ue()(n.data,n.width,n.height,{inversionAttempts:"dontInvert"});c&&(console.log("Got QR Code"),console.log(c.data),b(c.data),null===e||void 0===e||e.onScanned(c.data))}g&&requestAnimationFrame(g)};return Object(j.jsxs)(ne.a,{isOpen:e.isOpen,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,style:ze,children:[Object(j.jsx)("canvas",{id:"videoOutCanvas",ref:p,hidden:!0}),Object(j.jsx)("video",{id:"video",ref:m})]})},Ye=function(){var e=Object(c.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),o=Object(s.a)(a,2),i=o[0],u=o[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"p-5",children:Object(j.jsxs)("div",{className:"flex flex-col items-center",children:[Object(j.jsx)("h1",{children:"Connected Devices"}),Object(j.jsx)(He,{}),Object(j.jsx)("h1",{children:"Add Devices"}),Object(j.jsxs)("div",{className:"flex items-center justify-center w-full flex-wrap md:space-x-4",children:[Object(j.jsxs)("button",{className:"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2",onClick:function(){return r(!0)},children:[Object(j.jsx)(Je.a,{})," ",Object(j.jsx)("span",{children:"Show QR Code"})]}),Object(j.jsxs)("button",{className:"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2",onClick:function(){return u(!0)},children:[Object(j.jsx)(me.c,{})," ",Object(j.jsx)("span",{children:"Scan"})]})]})]})}),Object(j.jsx)(Qe,{isOpen:n,onRequestClose:function(){return r(!1)}}),Object(j.jsx)(Xe,{isOpen:i,onRequestClose:function(){return u(!1)},onScanned:function(){var e=Object(y.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _e(t),e.next=3,Be();case 3:u(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]})},$e=function(){var e=Object(u.d)();return Object(j.jsx)("button",{className:"h-8 w-8 hover:bg-black hover:text-white rounded-full flex justify-center items-center",onClick:function(){return e(-1)},children:Object(j.jsx)(Oe.d,{})})},Ke=function(e){return Object(j.jsxs)("div",{className:"min-h-screen max-w-full",children:[Object(j.jsxs)("div",{className:"w-full flex justify-between items-center mb-2 p-2",children:[Object(j.jsx)($e,{}),Object(j.jsx)("div",{className:"hidden md:inline-block",children:Object(j.jsx)(xe,{})})]}),e.children]})};function Ze(e){return Object(j.jsxs)(f,{children:[Object(j.jsx)(u.b,{from:"/",to:"experiment-501.V2",noThrow:!0}),Object(j.jsxs)(Ke,{path:"/experiment-501.V2",children:[Object(j.jsx)(ve,{path:"/c"}),Object(j.jsx)(ke,{path:"/p"}),Object(j.jsx)(Ce,{path:"/"}),Object(j.jsx)(Ye,{path:"/settings"}),Object(j.jsx)(Pe,{path:"/demo"})]})]})}n(482);var et=function(){var e=Object(c.useState)({items:[],addItem:function(e,t){e.find((function(e){return e===t}))||r(Object(i.a)(Object(i.a)({},n),{},{items:oe(e,t)}))},removeItem:function(e,t){r(Object(i.a)(Object(i.a)({},n),{},{items:ae(e,t)}))}}),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useMemo)((function(){return n}),[n]);return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(se.Provider,{value:a,children:Object(j.jsx)(Ze,{})})})},tt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,497)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))},nt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ct(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(et,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/experiment-501.V2",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/experiment-501.V2","/service-worker.js");nt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ct(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ct(t,e)}))}}(),tt()}},[[483,1,2]]]);
//# sourceMappingURL=main.66c31284.chunk.js.map