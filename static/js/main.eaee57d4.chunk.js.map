{"version":3,"sources":["../node_modules/peerjs/dist sync","router/FadeInTransitionRouter/index.tsx","router/NestedRoute.tsx","components/card/card.tsx","model/interfaces.ts","components/remirror-editor/extensions/link-extension/link-extention.ts","components/remirror-editor/extensions/image-extension/image-extension.ts","components/remirror-editor/remirror-editor.tsx","db/pouch/notes.ts","store/index.ts","components/editor-container/editor-container.tsx","components/note-list/note-list.tsx","components/canvas/canvas.tsx","components/searchbar/searchbar.tsx","pages/canvas-workspace.tsx","components/add-note-fab/add-note-fab.tsx","pages/panel-workspace/panel-workspace.tsx","pages/library.tsx","replication/webrtc.ts","pages/demo.tsx","router/Routes.jsx","App.tsx","reportWebVitals.ts","serviceWorkerRegistration.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","FadeInTransitionRouter","props","location","TransitionGroup","className","CSSTransition","classNames","timeout","children","key","NestedRoute","Card","useDrag","item","collect","monitor","isDragging","drag","preview","ref","style","display","hideSourceOnDrag","opacity","top","y","left","x","ItemTypes","LinkExtension","args","addHandler","_","data","window","open","href","markInputRule","regexp","RegExp","type","this","getAttributes","matches","text","RemirrorLinkExtension","ImageExtension","nodeInputRule","alt","src","RemirrorImageExtension","Editor","forwardRef","handleOnError","useCallback","json","invalidContent","transformers","remove","useRemirror","extensions","BoldExtension","ItalicExtension","BlockquoteExtension","defaultTarget","autoLink","HeadingExtension","BulletListExtension","OrderedListExtension","TaskListExtension","enableResizing","CodeExtension","onError","content","state","doc","manager","setState","getContext","useImperativeHandle","initialContent","onChange","params","onFocus","event","onBlur","PouchDB","plugin","Upsert","QuickSearch","db","search","fields","build","then","console","log","catch","err","defaultState","updateNote","inputDocument","a","docId","upsert","response","insertNote","title","meta","createdTime","lastEditedTime","newDocument","_id","uuidv4","Date","now","putIfNotExists","storedDocument","getNotes","allDocs","include_docs","result","rows","map","row","getNoteById","get","callback","changes","since","live","on","query","res","ADD_ITEM_TO_CANVAS","REMOVE_ITEM_FROM_CANVAS","UPDATE_ITEM","openCanvas","items","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION__","compose","store","createStore","payload","find","update","$push","filter","oldItem","itemIdx","indexOf","$merge","SET_NOTE","SET_NOTE_STATE","NEW_NOTE","reducer","note","currentTime","EditorContainer","useReducer","dispatch","reduxDispatch","useDispatch","useState","setFocused","ctxRef","useRef","initialiseNote","useEffect","handleOnChange","toJSON","handleBlur","current","getState","textContent","placeholder","defaultValue","target","value","replace","wrap","onClick","NoteList","allNotes","setAllNotes","fetchAllNotes","idx","noteText","handleNoteButtonClick","CanvasContainer","DndProvider","backend","HTML5Backend","Canvas","setMousePos","noteListPos","setNoteListPos","cards","useSelector","useDrop","accept","drop","delta","getDifferenceFromInitialOffset","Math","round","moveCardPosition","createCard","newCard","onMouseMove","nativeEvent","offsetX","offsetY","onDoubleClick","Object","entries","index","card","SearchBar","setQuery","results","setResults","Search","total_rows","val","addNoteToCanvas","CanvasWorkspace","AddNoteFAB","handleClick","PanelWorkspace","Library","navigate","useNavigate","Replicator","peer","localStorage","getItem","Peer","setItem","dataConnection","Array","isArray","forEach","error","peerId","connect","Demo","video","canvasElement","replicator","setPeerId","setDataToSend","canvas","document","getElementById","QRCode","toCanvas","navigator","mediaDevices","getUserMedia","facingMode","stream","srcObject","setAttribute","play","requestAnimationFrame","tick","readyState","HAVE_ENOUGH_DATA","canvasCtx","height","videoHeight","width","videoWidth","drawImage","imageData","getImageData","jsQR","inversionAttempts","Connect","Replicate","hidden","Routes","from","to","noThrow","path","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","StrictMode","URL","process","origin","addEventListener","fetch","headers","contentType","status","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.eaee57d4.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 443;","import { TransitionGroup, CSSTransition } from \"react-transition-group\";\nimport { Router, Location } from \"@reach/router\";\nimport \"./style.css\";\n\nconst FadeInTransitionRouter = (props) => {\n  return (\n    <Location>\n      {({ location }) => (\n        <TransitionGroup className=\"transition-group\">\n          <CSSTransition key={location.key} classNames=\"fade\" timeout={500}>\n            <Router location={location}>{props.children}</Router>\n          </CSSTransition>\n        </TransitionGroup>\n      )}\n    </Location>\n  );\n};\n\nexport default FadeInTransitionRouter;\n","const NestedRoute = ({ children }) => {\n  return children;\n};\n\nexport default NestedRoute;\n","import React from \"react\";\nimport { useDrag } from \"react-dnd\";\nimport { ICanvasCard } from \"model/interfaces\";\nimport \"./card.css\";\n\ndeclare interface CardProps {\n  item: ICanvasCard;\n  onRemove?;\n  hideSourceOnDrag?: boolean;\n  children?: any;\n}\n\nconst Card = (props: CardProps) => {\n  const [{ isDragging }, drag, preview] = useDrag({\n    item: props.item,\n    collect: (monitor) => ({\n      isDragging: !!monitor.isDragging(),\n    }),\n  });\n\n  return (\n    <div\n      id={props.item.id}\n      ref={preview}\n      className=\"card\"\n      style={{\n        display: isDragging && props.hideSourceOnDrag ? \"none\" : \"flex\",\n        opacity: isDragging ? 0.5 : 1,\n        top: props.item.y,\n        left: props.item.x,\n      }}\n    >\n      <div className=\"flex justify-end p-3\">\n        <div\n          ref={drag}\n          id={`${props.item.id}-drag-handle`}\n          className=\"card-drag-handle\"\n        ></div>\n      </div>\n\n      {props.children}\n    </div>\n  );\n};\n\nexport default Card;\n","export const ItemTypes = {\n  CARD: \"card\",\n  COLLECTION: \"collection\",\n};\n\nexport interface ICanvasCard {\n  type: string;\n  id: string;\n  // The x,y co-ords of the element\n  x: number;\n  y: number;\n}\n\nexport interface ICanvas {\n  id: string;\n  title: string;\n  items: ICanvasCard[];\n}\n\nexport interface INote {\n  id: string;\n  title: string;\n  createdTime: number;\n  lastEditedTime: number;\n  meta: object;\n  state: PMState;\n  text: string;\n}\n\n// JSON serialised prosemirror state returned by state.toJSON()\nexport interface PMState {\n  doc: any;\n  selection: object;\n}\n\nexport interface SearchResult {\n  rows: SearchResultRow[];\n  total_rows: number;\n}\n\nexport interface SearchResultRow {\n  id: string;\n  score: number;\n  doc: INote;\n}\n","import { InputRule } from \"@remirror/pm\";\nimport { LinkExtension as RemirrorLinkExtension } from \"remirror/extensions\";\nimport { markInputRule } from \"@remirror/core-utils\";\nimport { MarkPasteRule } from \"@remirror/pm/paste-rules\";\n\nclass LinkExtension extends RemirrorLinkExtension {\n  constructor(args) {\n    super(args);\n    this.addHandler(\"onClick\", (_, data) => {\n      window.open(data.href);\n      return true;\n    });\n  }\n\n  createInputRules(): InputRule[] {\n    return [\n      markInputRule({\n        regexp: (() => {\n          try {\n            return new RegExp(\"?<!!)[(.*?)]((.*?))\");\n          } catch {\n            return /[^!]\\[(.+?)\\]\\((.+?)\\)/;\n          }\n        })(),\n        type: this.type,\n        getAttributes: (matches: string[]) => {\n          const [_, text, href] = matches;\n          return { text: text, href: href };\n        },\n      }),\n    ];\n  }\n\n  // Overwrite the paste rule\n  createPasteRules(): MarkPasteRule[] {\n    return [];\n  }\n}\n\nexport default LinkExtension;\n","import { ImageExtension as RemirrorImageExtension } from \"remirror/extensions\";\nimport { InputRule } from \"@remirror/pm\";\nimport { nodeInputRule } from \"@remirror/core-utils\";\n\nclass ImageExtension extends RemirrorImageExtension {\n  createInputRules(): InputRule[] {\n    return [\n      nodeInputRule({\n        regexp: /!\\[(.+?)\\]\\((.+?)\\)/,\n        type: this.type,\n        getAttributes: (matches: string[]) => {\n          const [_, alt, src] = matches;\n          return { src: src, alt: alt };\n        },\n      }),\n    ];\n  }\n}\n\nexport default ImageExtension;\n","import \"remirror/styles/all.css\";\nimport \"./remirror-editor.css\";\nimport React, { forwardRef, useCallback, useImperativeHandle } from \"react\";\nimport {\n  BoldExtension,\n  BlockquoteExtension,\n  CodeExtension,\n  HeadingExtension,\n  ItalicExtension,\n  BulletListExtension,\n  OrderedListExtension,\n  TaskListExtension,\n} from \"remirror/extensions\";\nimport {\n  EditorComponent,\n  ReactFrameworkOutput,\n  Remirror,\n  useRemirror,\n} from \"@remirror/react\";\nimport {\n  Extension,\n  InvalidContentHandler,\n  RemirrorEventListener,\n  RemirrorEventListenerProps,\n} from \"@remirror/core\";\nimport { PMState } from \"model/interfaces\";\nimport {\n  LinkExtension,\n  ImageExtension,\n} from \"components/remirror-editor/extensions\";\n\ninterface EditorProps {\n  onFocus?: (\n    params: RemirrorEventListenerProps<Extension>,\n    event: Event\n  ) => void;\n  onBlur?: (\n    params: RemirrorEventListenerProps<Extension>,\n    event: Event\n  ) => void;\n  onChange?: RemirrorEventListener<Extension>;\n  state?: PMState;\n}\n\nconst Editor = forwardRef<ReactFrameworkOutput<Extension>, EditorProps>(\n  (props: EditorProps, ref) => {\n    const handleOnError: InvalidContentHandler = useCallback(\n      ({ json, invalidContent, transformers }) => {\n        // Automatically remove all invalid nodes and marks.\n        return transformers.remove(json, invalidContent);\n      },\n      []\n    );\n\n    const { manager, state, setState, getContext } = useRemirror({\n      extensions: () => [\n        new BoldExtension({}),\n        new ItalicExtension(),\n        new BlockquoteExtension(),\n        new LinkExtension({ defaultTarget: \"_blank\", autoLink: true }),\n        new HeadingExtension({}),\n        new BulletListExtension({}),\n        new OrderedListExtension(),\n        new TaskListExtension(),\n        new ImageExtension({ enableResizing: true }),\n        new CodeExtension(),\n      ],\n      onError: handleOnError,\n      content: props.state?.doc,\n    });\n\n    useImperativeHandle(ref, () => getContext() as any, [getContext]);\n\n    return (\n      <div className=\"remirror-theme\">\n        <Remirror\n          manager={manager}\n          initialContent={state}\n          onChange={(params) => {\n            setState(params.state);\n            props.onChange?.(params);\n          }}\n          onFocus={(params, event) => {\n            props.onFocus?.(params, event);\n          }}\n          onBlur={(params, event) => {\n            props.onBlur?.(params, event);\n          }}\n        >\n          <EditorComponent />\n        </Remirror>\n      </div>\n    );\n  }\n);\n\nexport default Editor;\n","import PouchDB from \"pouchdb\";\nimport Upsert from \"pouchdb-upsert\";\nimport { INote, PMState, SearchResult } from \"model/interfaces\";\nimport QuickSearch from \"pouchdb-quick-search\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { schema } from \"components/editor/schema\";\n\nPouchDB.plugin(Upsert);\nPouchDB.plugin(QuickSearch);\n\nlet db = new PouchDB(\"notes\");\n\n(db as any)\n  .search({ fields: [\"title\", \"text\"], build: true })\n  .then(() => console.log(\"Index created succesfully\"))\n  .catch((err) => console.log(\"ERROR failed to build index\"));\n\nexport const defaultState = { type: \"doc\", content: [{ type: \"paragraph\" }] };\n\nexport async function updateNote(inputDocument: INote) {\n  try {\n    const docId = inputDocument.id || inputDocument[\"_id\"];\n    const response = await db.upsert(docId, (doc) => {\n      return inputDocument as Partial<PouchDB.Core.IdMeta>;\n    });\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't update \\n${error}`);\n  }\n}\n\n// Create a new note\nexport async function insertNote(\n  id?: string,\n  title?: string,\n  meta?: object,\n  state?: PMState,\n  createdTime?: string,\n  lastEditedTime?: string\n) {\n  try {\n    let newDocument = {\n      _id: id || uuidv4(),\n      title: title || null,\n      meta: meta || {},\n      state: state || defaultState,\n      createdTime: createdTime || Date.now(),\n      lastEditedTime: lastEditedTime || Date.now(),\n    };\n\n    const storedDocument = await db.putIfNotExists(newDocument);\n    return storedDocument;\n  } catch (error) {\n    console.log(`ERROR: couldn't create doc ${error}`);\n  }\n}\n\nexport async function deleteNote(inputDocument: INote) {\n  try {\n    const docId = inputDocument.id || inputDocument[\"_id\"];\n    const response = await db.remove(docId);\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't delete \\n${error}`);\n  }\n}\n\nexport async function getNotes(): Promise<\n  PouchDB.Core.ExistingDocument<PouchDB.Core.AllDocsMeta>[]\n> {\n  try {\n    let result = await db.allDocs({ include_docs: true });\n    return result?.rows?.map((row) => row.doc);\n  } catch (error) {\n    console.log(`ERROR fetching all notes \\n${error}`);\n  }\n}\n\nexport async function getNoteById(id: string) {\n  try {\n    const doc = await db.get(id);\n    return doc;\n  } catch (error) {\n    console.log(`ERROR fetching  ${id} \\n${error}`);\n  }\n}\n\nexport function onChange(callback) {\n  db.changes({\n    since: \"now\",\n    live: true,\n  }).on(\"change\", () => callback());\n}\n\nexport async function search(\n  query: string,\n  fields = [\"title\", \"text\"]\n): Promise<SearchResult> {\n  return (db as any)\n    ?.search({ query: query, fields: fields, include_docs: true })\n    .then((res) => {\n      return res;\n    })\n    .catch((err) => console.log(`Search failed ${err}`));\n}\n","import { createStore, compose } from \"redux\";\nimport { ICanvas } from \"model/interfaces\";\nimport update from \"immutability-helper\";\n\nexport const ADD_ITEM_TO_CANVAS = \"ADD_ITEM_TO_CANVAS\";\nexport const REMOVE_ITEM_FROM_CANVAS = \"REMOVE_ITEM_FROM_CANVAS\";\nexport const UPDATE_ITEM = \"UPDATE_ITEM_POSITION\";\n\nconst openCanvas: ICanvas = {\n  id: \"randomID\",\n  title: \"Main Canvas\",\n  items: [],\n};\n\nconst reducer = function (\n  state = { openCanvas: openCanvas },\n  { type, payload }\n) {\n  switch (type) {\n    case ADD_ITEM_TO_CANVAS:\n      const { items } = state.openCanvas;\n      if (!items.find((item) => item.id === payload?.id)) {\n        state.openCanvas.items = update(items, { $push: [payload] });\n        return state;\n      }\n      return state;\n    case REMOVE_ITEM_FROM_CANVAS:\n      state.openCanvas.items = state.openCanvas.items.filter(\n        (item) => item.id !== payload?.id\n      );\n      return state;\n    case UPDATE_ITEM:\n      const oldItem = state.openCanvas.items.find(\n        (item) => item.id === payload?.id\n      );\n\n      if (!oldItem) {\n        return state;\n      }\n\n      const itemIdx = state.openCanvas.items.indexOf(oldItem);\n      state.openCanvas.items = update(state.openCanvas.items, {\n        [itemIdx]: { $merge: { ...payload } },\n      });\n\n      return state;\n\n    default:\n      return state;\n  }\n};\n\nconst composeEnhancers =\n  (window as any).__REDUX_DEVTOOLS_EXTENSION__ || compose;\nlet store = createStore(reducer, composeEnhancers());\n\nexport default store;\n","/* Manage the editor's interaction with the db & global state */\nimport React, { useCallback, useEffect, useReducer, useRef } from \"react\";\nimport Editor from \"components/remirror-editor/remirror-editor\";\nimport { insertNote, updateNote, getNoteById } from \"db/pouch/notes\";\nimport { INote } from \"model/interfaces\";\nimport { useDispatch } from \"react-redux\";\nimport { REMOVE_ITEM_FROM_CANVAS } from \"store\";\nimport { useState } from \"react\";\nimport { ReactFrameworkOutput } from \"@remirror/react\";\nimport { Extension } from \"@remirror/core\";\ninterface EditorContainerProps {\n  id?: string;\n  note?: INote;\n}\n\nconst SET_NOTE = \"SET_NOTE\";\nconst SET_NOTE_STATE = \"SET_NOTE_STATE\";\nconst NEW_NOTE = \"NEW_NOTE\";\n\nconst reducer = (note: INote, { type, payload }) => {\n  switch (type) {\n    case SET_NOTE:\n      return payload;\n    case NEW_NOTE:\n      let currentTime = Date.now();\n      const newNote = {\n        ...payload,\n        createdTime: currentTime,\n        lastEditedTime: currentTime,\n      };\n      return newNote;\n    case SET_NOTE_STATE:\n      const updatedNote = {\n        ...note,\n        state: payload,\n        lastEditedTime: Date.now(),\n      };\n      return updatedNote;\n  }\n};\nconst EditorContainer = (props: EditorContainerProps) => {\n  const [note, dispatch] = useReducer(reducer, props.note);\n  const reduxDispatch = useDispatch();\n  const [focused, setFocused] = useState(false);\n\n  const ctxRef = useRef<ReactFrameworkOutput<Extension>>();\n\n  const initialiseNote = useCallback(async () => {\n    if (props.id) {\n      // try fetch the note from the db\n      let doc = await getNoteById(props.id);\n      if (doc) {\n        dispatch({ type: SET_NOTE, payload: doc });\n      } else {\n        // No note found create one with the passed in id\n        const doc = await insertNote(props.id);\n        dispatch({ type: NEW_NOTE, payload: doc });\n      }\n    } else {\n      // No id create note with db generated id\n      const doc = await insertNote();\n      dispatch({ type: NEW_NOTE, payload: doc });\n    }\n  }, [props.id]);\n\n  // On init\n  useEffect(() => {\n    void initialiseNote();\n  }, [initialiseNote]);\n\n  const handleOnChange = useCallback((params) => {\n    dispatch({\n      type: SET_NOTE_STATE,\n      payload: params.state.toJSON(),\n    });\n  }, []);\n\n  const handleBlur = useCallback(\n    (params, e) => {\n      note.text = ctxRef.current.getState().doc.textContent;\n      void updateNote(note);\n      setFocused(false);\n    },\n    [note]\n  );\n\n  if (!note) return null;\n\n  return (\n    <div className=\"w-full md:w-5/12 lg:w-1/3 shadow-lg rounded-lg p-5 lg:mr-4 mb-4\">\n      <div className=\"flex justify-between\">\n        <textarea\n          placeholder=\"Title\"\n          defaultValue={note?.title}\n          className=\"font-medium text-3xl w-11/12\"\n          onChange={(e) => {\n            let title = e.target.value;\n            title.replace(/\\n/, \"\");\n            note.title = title;\n            updateNote(note);\n          }}\n          wrap=\"soft\"\n        />\n        <button\n          className=\"h-4 w-4 rounded-full bg-red-300 hover:bg-red-500\"\n          onClick={() =>\n            reduxDispatch({\n              type: REMOVE_ITEM_FROM_CANVAS,\n              payload: note,\n            })\n          }\n        />\n      </div>\n      <Editor\n        state={note.state}\n        onChange={handleOnChange}\n        onBlur={handleBlur}\n        onFocus={() => setFocused(true)}\n        ref={ctxRef}\n      />\n    </div>\n  );\n};\n\nexport default EditorContainer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { getNotes, onChange } from \"db/pouch/notes\";\nimport { INote } from \"model/interfaces\";\n\ninterface NoteListProps {\n  handleNoteButtonClick(note: INote): any;\n}\n\nconst NoteList = (props: NoteListProps) => {\n  const [allNotes, setAllNotes] = useState([]);\n\n  const fetchAllNotes = useCallback(async () => {\n    const response = await getNotes();\n    setAllNotes(response);\n  }, [setAllNotes]);\n\n  useEffect(() => {\n    fetchAllNotes();\n    onChange(fetchAllNotes);\n  }, [fetchAllNotes]);\n\n  return (\n    <div className=\"flex w-64 flex-col rounded items-center divide-y divide-gray-200 divide-opacity-50\">\n      {allNotes.map((note, idx) => {\n        const noteText = note?.state?.doc ? note.text : \"\";\n\n        return (\n          <button\n            className=\"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200\"\n            key={idx}\n            onClick={() => {\n              props.handleNoteButtonClick(note);\n            }}\n          >\n            {note.title || noteText}\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default NoteList;\n","import React, { useCallback, useState } from \"react\";\nimport { DndProvider, useDrop, XYCoord } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport Card from \"components/card/card\";\nimport { ItemTypes, ICanvasCard, INote, ICanvas } from \"model/interfaces\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport EditorContainer from \"components/editor-container/editor-container\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { ADD_ITEM_TO_CANVAS, UPDATE_ITEM } from \"store\";\nimport \"./canvas.css\";\nimport NoteList from \"components/note-list/note-list\";\n\nfunction CanvasContainer() {\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <Canvas />\n    </DndProvider>\n  );\n}\n\nexport default CanvasContainer;\n\nconst Canvas = (props) => {\n  const debug = false;\n  const [mousePos, setMousePos] = useState<XYCoord>({ x: 0, y: 0 });\n  const [noteListPos, setNoteListPos] = useState<XYCoord>({ x: 0, y: 0 });\n\n  const cards: ICanvasCard[] = useSelector(\n    (state: { openCanvas: ICanvas }) => state.openCanvas.items\n  );\n  const dispatch = useDispatch();\n\n  const [, drop] = useDrop({\n    accept: [ItemTypes.CARD, ItemTypes.COLLECTION],\n    drop: (item: ICanvasCard, monitor) => {\n      const delta = monitor.getDifferenceFromInitialOffset() as XYCoord;\n      const x = Math.round(item.x + delta.x);\n      const y = Math.round(item.y + delta.y);\n      item.type === ItemTypes.CARD\n        ? moveCardPosition(item.id, x, y)\n        : setNoteListPos({ x, y });\n\n      return { x, y };\n    },\n  });\n\n  const createCard = useCallback(\n    (x: number, y: number) => {\n      const newCard: ICanvasCard = {\n        type: ItemTypes.CARD,\n        id: uuidv4(),\n        x: x,\n        y: y,\n      };\n      dispatch({ type: ADD_ITEM_TO_CANVAS, payload: newCard });\n    },\n    [dispatch]\n  );\n\n  const moveCardPosition = useCallback(\n    (id: string, x: number, y: number) => {\n      dispatch({ type: UPDATE_ITEM, payload: { id: id, x: x, y: y } });\n    },\n    [dispatch]\n  );\n\n  const addNoteToCanvas = (note: INote) => {\n    const item: ICanvasCard = {\n      id: note?.id,\n      type: ItemTypes.CARD,\n      x: 690,\n      y: 320,\n    };\n    dispatch({ type: ADD_ITEM_TO_CANVAS, payload: item });\n  };\n\n  return (\n    <div\n      className=\"canvas\"\n      ref={drop}\n      onMouseMove={(e) => {\n        setMousePos({ x: e.nativeEvent.offsetX, y: e.nativeEvent.offsetY });\n      }}\n      onDoubleClick={(e) => {\n        createCard(e.nativeEvent.offsetX, e.nativeEvent.offsetY);\n      }}\n    >\n      {debug && (\n        <span style={{ color: \"white\" }}>\n          x: {mousePos.x},y: {mousePos.y}\n        </span>\n      )}\n\n      <Card\n        item={{\n          type: ItemTypes.COLLECTION,\n          id: uuidv4(),\n          x: noteListPos.x,\n          y: noteListPos.y,\n        }}\n      >\n        <NoteList handleNoteButtonClick={addNoteToCanvas} />\n      </Card>\n\n      {Object.entries(cards).map(([key, card], index) => (\n        <Card key={index} item={card} hideSourceOnDrag>\n          <EditorContainer id={card.id} />\n        </Card>\n      ))}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { VscSearch } from \"react-icons/vsc\";\nimport { search } from \"db/pouch/notes\";\nimport \"./searchbar.css\";\nimport { ICanvasCard, INote, ItemTypes, SearchResult } from \"model/interfaces\";\nimport { useDispatch } from \"react-redux\";\nimport { ADD_ITEM_TO_CANVAS } from \"store\";\n\nexport default function SearchBar() {\n  const [focused, setFocused] = useState(false);\n  const [query, setQuery] = useState(\"\");\n  const [results, setResults] = useState<SearchResult>();\n\n  const Search = (query: string) => {\n    search(query).then((res) => setResults(res));\n  };\n\n  const dispatch = useDispatch();\n\n  const addNoteToCanvas = (note: INote) => {\n    const item: ICanvasCard = {\n      id: note?.id,\n      type: ItemTypes.CARD,\n      x: 690,\n      y: 320,\n    };\n    dispatch({ type: ADD_ITEM_TO_CANVAS, payload: item });\n  };\n\n  return (\n    <div className=\"relative\">\n      <div className=\"h-14 w-80 border border-black rounded-full flex justify-between pl-6 items-center relative\">\n        <input\n          placeholder=\"Search\"\n          className=\"w-3/4 h-full bg-transparent overflow-ellipsis\"\n          type=\"text\"\n          value={query}\n          onChange={(e) => {\n            const { value } = e.target;\n            setQuery(value);\n            Search(value);\n          }}\n          onFocus={(e) => setFocused(true)}\n          onBlur={(e) => setFocused(false)}\n        />\n        <button className=\"h-14 w-14 rounded-full bg-black text-white flex justify-center items-center\">\n          <VscSearch />\n        </button>\n      </div>\n\n      {query !== \"\" && results?.total_rows > 0 && (\n        <div className=\"search-results border border-black border-t-0 rounded-b-lg overflow-hidden\">\n          {results?.rows?.map((val, idx) => {\n            return (\n              <button\n                key={idx}\n                className=\"result\"\n                onClick={(_) => {\n                  addNoteToCanvas(val.doc);\n                  setQuery(\"\");\n                }}\n              >\n                {val.doc.title ?? val.doc.title}\n              </button>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport Canvas from \"components/canvas/canvas\";\nimport SearchBar from \"components/searchbar/searchbar\";\n\nexport default function CanvasWorkspace() {\n  return (\n    <div className=\"min-h-screen\">\n      <div id=\"top-bar\" className=\"flex flex-row-reverse p-8\">\n        <SearchBar />\n      </div>\n      <Canvas />\n    </div>\n  );\n}\n","import React, { useCallback } from \"react\";\nimport { ItemTypes, ICanvasCard, INote, ICanvas } from \"model/interfaces\";\nimport { VscAdd } from \"react-icons/vsc\";\nimport { useDispatch } from \"react-redux\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { ADD_ITEM_TO_CANVAS } from \"store\";\n\nexport default function AddNoteFAB(props) {\n  const dispatch = useDispatch();\n\n  const createCard = useCallback(() => {\n    const newCard: ICanvasCard = {\n      type: ItemTypes.CARD,\n      id: uuidv4(),\n      x: 0,\n      y: 0,\n    };\n    dispatch({ type: ADD_ITEM_TO_CANVAS, payload: newCard });\n  }, [dispatch]);\n\n  return (\n    <button\n      onClick={() => {\n        createCard();\n        props?.handleClick?.();\n      }}\n      className=\"rounded-full h-16 w-16 fixed right-8 bottom-8 bg-black text-white flex justify-center items-center shadow-md hover:pointer\"\n    >\n      <VscAdd />\n    </button>\n  );\n}\n","import React from \"react\";\nimport SearchBar from \"components/searchbar/searchbar\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ICanvas, ICanvasCard, INote, ItemTypes } from \"model/interfaces\";\nimport NoteList from \"components/note-list/note-list\";\nimport { ADD_ITEM_TO_CANVAS } from \"store\";\nimport EditorContainer from \"components/editor-container/editor-container\";\nimport AddNoteFAB from \"components/add-note-fab/add-note-fab\";\nimport \"./panel-workspace.css\";\n\nexport default function PanelWorkspace() {\n  const cards: ICanvasCard[] = useSelector(\n    (state: { openCanvas: ICanvas }) => state.openCanvas.items\n  );\n  const dispatch = useDispatch();\n  const addNoteToCanvas = (note: INote) => {\n    const item: ICanvasCard = {\n      id: note?.id,\n      type: ItemTypes.CARD,\n      x: 690,\n      y: 320,\n    };\n    dispatch({ type: ADD_ITEM_TO_CANVAS, payload: item });\n  };\n\n  return (\n    <div className=\"min-h-screen\">\n      <div id=\"top-bar\" className=\"hidden md:flex flex-row-reverse p-8\">\n        <SearchBar />\n      </div>\n      {/* <div>\n        <NoteList handleNoteButtonClick={addNoteToCanvas} />\n      </div> */}\n      <div className=\"editor-list sibling-fade\">\n        {cards.map((card, idx) => (\n          <EditorContainer key={idx} id={card.id} />\n        ))}\n      </div>\n\n      <AddNoteFAB />\n    </div>\n  );\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { getNotes, onChange } from \"db/pouch/notes\";\nimport { ADD_ITEM_TO_CANVAS } from \"store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ICanvas, ICanvasCard, INote, ItemTypes } from \"model/interfaces\";\nimport { useNavigate } from \"@reach/router\";\nimport AddNoteFAB from \"components/add-note-fab/add-note-fab\";\n\nexport default function Library() {\n  const [allNotes, setAllNotes] = useState([]);\n\n  const navigate = useNavigate();\n\n  const openCanvasCards: ICanvasCard[] = useSelector(\n    (state: { openCanvas: ICanvas }) => state.openCanvas.items\n  );\n\n  const dispatch = useDispatch();\n  const addNoteToCanvas = (note: INote) => {\n    const item: ICanvasCard = {\n      id: note?.id,\n      type: ItemTypes.CARD,\n      x: 690,\n      y: 320,\n    };\n    dispatch({ type: ADD_ITEM_TO_CANVAS, payload: item });\n  };\n\n  const fetchAllNotes = useCallback(async () => {\n    const response = await getNotes();\n    setAllNotes(response);\n  }, [setAllNotes]);\n\n  useEffect(() => {\n    fetchAllNotes();\n    onChange(fetchAllNotes);\n  }, [fetchAllNotes]);\n\n  return (\n    <div className=\"min-h-screen\">\n      <div className=\"h-full w-full rounded-lg divide-y divide-gray-200 flex flex-col p-5\">\n        {allNotes.map((note, idx) => {\n          const noteText = note?.state?.doc ? note.text : \"\";\n\n          return (\n            <button\n              className=\"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200\"\n              key={idx}\n              onClick={() => {\n                addNoteToCanvas(note);\n                navigate(\"/experiment-501.V2/p\");\n              }}\n            >\n              {note.title || noteText || \"Empty\"}\n            </button>\n          );\n        })}\n        <AddNoteFAB handleClick={() => navigate(\"/experiment-501.V2/p\")} />\n      </div>\n    </div>\n  );\n}\n","import Peer from \"peerjs\";\nimport { getNotes, updateNote } from \"db/pouch/notes\";\n\nclass Replicator {\n  id: string;\n  peer: Peer;\n\n  constructor() {\n    this.id = localStorage.getItem(\"peerId\");\n    this.peer = new Peer(this.id);\n\n    this.peer.on(\"open\", function (id) {\n      localStorage.setItem(\"peerId\", id);\n      console.log(\"My peer ID is: \" + id);\n    });\n\n    this.peer.on(\"connection\", (dataConnection) => {\n      dataConnection.on(\"data\", (data) => {\n        console.log(`Recieved data from ${dataConnection.peer}`);\n        if (Array.isArray(data)) {\n          data.forEach((item) => updateNote(item));\n        }\n      });\n    });\n\n    this.peer.on(\"error\", (error) => {\n      console.error(error);\n    });\n  }\n\n  Connect(peerId: string) {\n    this.peer.connect(peerId);\n  }\n\n  async Replicate() {\n    try {\n      let dataToSend = await getNotes();\n    } catch (e) {\n      console.log(e);\n    }\n  }\n}\n\nexport default Replicator;\n","import React, { useEffect, useState } from \"react\";\nimport SearchBar from \"components/searchbar/searchbar\";\nimport Replicator from \"replication/webrtc\";\nimport QRCode from \"qrcode\";\nimport jsQR from \"jsqr\";\n\nexport default function Demo() {\n  const [peerId, setPeerId] = useState<string>(\"\");\n  const [dataToSend, setDataToSend] = useState<string>();\n  let qrcode;\n  let video;\n  let canvasElement: HTMLCanvasElement;\n  let replicator: Replicator;\n\n  useEffect(() => {\n    replicator = new Replicator();\n    // Generate QR Code\n    let canvas = document.getElementById(\"qrcode\");\n    QRCode.toCanvas(canvas, localStorage.getItem(\"peerId\"));\n\n    // Read QR Code\n    canvasElement = document.getElementById(\n      \"outputCanvas\"\n    ) as HTMLCanvasElement;\n\n    video = document.getElementById(\"video\");\n\n    navigator.mediaDevices\n      .getUserMedia({ video: { facingMode: \"environment\" } })\n      .then(function (stream) {\n        video.srcObject = stream;\n        video.setAttribute(\"playsinline\", true); // required to tell iOS safari we don't want fullscreen\n        video.play();\n      });\n  }, []);\n\n  let tick = () => {\n    if (video && video.readyState === video.HAVE_ENOUGH_DATA) {\n      let canvasCtx = canvasElement.getContext(\"2d\");\n\n      canvasElement.height = video.videoHeight;\n      canvasElement.width = video.videoWidth;\n      canvasCtx.drawImage(\n        video,\n        0,\n        0,\n        canvasElement.width,\n        canvasElement.height\n      );\n      var imageData = canvasCtx.getImageData(\n        0,\n        0,\n        canvasElement.width,\n        canvasElement.height\n      );\n      var code = jsQR(imageData.data, imageData.width, imageData.height, {\n        inversionAttempts: \"dontInvert\",\n      });\n\n      if (code) {\n        console.log(\"Got QR Code\");\n        console.log(code.data);\n        setPeerId(code.data);\n      }\n    }\n    requestAnimationFrame(tick);\n  };\n\n  requestAnimationFrame(tick);\n\n  return (\n    <div className=\"min-h-screen\">\n      <div id=\"top-bar\" className=\"flex flex-row-reverse p-8\">\n        <SearchBar />\n      </div>\n      <div className=\"flex\">\n        <div className=\"flex flex-col\">\n          <input\n            className=\"border border-black\"\n            type=\"text\"\n            value={peerId}\n            onChange={(e) => {\n              setPeerId(e.target.value);\n            }}\n          />\n          <button\n            className=\"rounded bg-blue-500 text-white\"\n            onClick={(e) => {\n              replicator.Connect(peerId);\n            }}\n          >\n            Connect\n          </button>\n        </div>\n        <div className=\"flex flex-col\">\n          <textarea\n            className=\"border border-black\"\n            onChange={(e) => {\n              setDataToSend(e.target.value);\n            }}\n          ></textarea>\n          <button\n            className=\"bg-green-500 text-white rounded\"\n            onClick={(e) => {\n              replicator.Replicate();\n            }}\n          >\n            Send\n          </button>\n        </div>\n      </div>\n\n      <canvas id=\"qrcode\"></canvas>\n      <canvas id=\"outputCanvas\" hidden></canvas>\n      <video id=\"video\"></video>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Redirect } from \"@reach/router\";\nimport FadeInTransitionRouter from \"./FadeInTransitionRouter\";\nimport NestedRoute from \"./NestedRoute\";\nimport CanvasWorkspace from \"pages/canvas-workspace\";\nimport PanelWorkspace from \"pages/panel-workspace/panel-workspace\";\nimport Library from \"pages/library\";\nimport Demo from \"pages/demo\";\n\nexport default function Routes(props) {\n  return (\n    <FadeInTransitionRouter>\n      <Redirect from=\"/\" to=\"experiment-501.V2\" noThrow />\n      <NestedRoute path=\"/experiment-501.V2\">\n        <CanvasWorkspace path=\"/c\" />\n        <PanelWorkspace path=\"/p\" />\n        <Demo path=\"/demo\" />\n        <Library path=\"/\" />\n      </NestedRoute>\n    </FadeInTransitionRouter>\n  );\n}\n","import React from \"react\";\nimport Routes from \"router/Routes\";\nimport { Provider } from \"react-redux\";\nimport store from \"store\";\nimport \"./App.css\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Provider store={store}>\n        <Routes />\n      </Provider>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}