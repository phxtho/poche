(this.webpackJsonp501v2=this.webpackJsonp501v2||[]).push([[0],{205:function(t,e,n){},211:function(t,e,n){},213:function(t,e,n){},232:function(t,e,n){},233:function(t,e){},259:function(t,e){},261:function(t,e){},272:function(t,e){},274:function(t,e){},301:function(t,e){},302:function(t,e){},307:function(t,e){},309:function(t,e){},316:function(t,e){},335:function(t,e){},360:function(t,e,n){},361:function(t,e,n){},362:function(t,e,n){},363:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(60),i=n.n(c),o=(n(205),n(88)),s=n(376),u=n(372),l=(n(211),n(6)),d=function(t){return Object(l.jsx)(o.a,{children:function(e){var n=e.location;return Object(l.jsx)(s.a,{className:"transition-group",children:Object(l.jsx)(u.a,{classNames:"fade",timeout:500,children:Object(l.jsx)(o.c,{location:n,children:t.children})},n.key)})}})},f=function(t){return t.children},b=n(18),j=n(371),p=n(375),v=n(194),O=n(374),h=(n(213),function(t){var e=Object(O.a)({item:t.item,collect:function(t){return{isDragging:!!t.isDragging()}}}),n=Object(b.a)(e,3),r=n[0].isDragging,a=n[1],c=n[2];return Object(l.jsxs)("div",{id:t.item.id,ref:c,className:"card",style:{display:r&&t.hideSourceOnDrag?"none":"flex",opacity:r?.5:1,top:t.item.y,left:t.item.x},children:[Object(l.jsx)("div",{className:"flex justify-end p-3",children:Object(l.jsx)("div",{ref:a,id:"".concat(t.item.id,"-drag-handle"),className:"card-drag-handle"})}),t.children]})}),g="card",x="collection",m=n(373),y=n(29),w=n.n(y),k=n(51),D=n(34),N=n(4),M=n(47),C=n(2),E=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=Object.assign({},e),null!==t.ychange&&(e.ychange_user=t.ychange.user,e.ychange_state=t.ychange.state),e},_={doc:{content:"block+"},paragraph:{attrs:{ychange:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function(t){return["p",E(t.attrs),0]}},blockquote:{attrs:{ychange:{default:null}},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:function(t){return["blockquote",E(t.attrs),0]}},horizontal_rule:{attrs:{ychange:{default:null}},group:"block",parseDOM:[{tag:"hr"}],toDOM:function(t){return["hr",E(t.attrs)]}},heading:{attrs:{level:{default:1},ychange:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function(t){return["h"+t.attrs.level,E(t.attrs),0]}},code_block:{attrs:{ychange:{default:null}},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:function(t){return["pre",E(t.attrs),["code",0]]}},text:{group:"inline"},image:{inline:!0,attrs:{ychange:{default:null},src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function(t){return{src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")}}}],toDOM:function(t){var e={src:t.attrs.src,title:t.attrs.title,alt:t.attrs.alt};return["img",E(t.attrs,e)]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}}},S=new C.i({nodes:_,marks:{link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(t){return{href:t.getAttribute("href"),title:t.getAttribute("title")}}}],toDOM:function(t){return["a",t.attrs,0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em",0]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(t){return"normal"!==t.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(t){return/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}}],toDOM:function(){return["strong",0]}},code:{parseDOM:[{tag:"code"}],toDOM:function(){return["code",0]}},ychange:{attrs:{user:{default:null},state:{default:null}},inclusive:!1,parseDOM:[{tag:"ychange"}],toDOM:function(t){return["ychange",{ychange_user:t.attrs.user,ychange_state:t.attrs.state},0]}}}}),T=n(195),R=n(8),A=n(196),F=n(99),I=n(369),B=n(370),V=n(66),J=Object(T.a)({schema:S,menuBar:!1}),P=new R.d,X=new A.a("prosemirror-debug",P),q=P.getXmlFragment("prosemirror"),z=([Object(F.c)(q),Object(I.a)(X.awareness),Object(B.c)(),Object(V.b)({"Mod-z":B.b,"Mod-y":B.a,"Mod-Shift-z":B.a})].concat(J),n(232),function(t){var e=t.onFocus,n=t.onBlur,a=t.onChange,c=Object(r.useRef)(),i=Object(r.useState)(null),o=Object(b.a)(i,2),s=o[0],u=o[1],d=Object(r.useCallback)((function(){return{dispatchTransaction:function(t){var e=this.state.apply(t);this.updateState(e),null===a||void 0===a||a(this)},handleDOMEvents:{focus:function(t,n){var r=t.state.tr.setMeta("focused",!0);return t.dispatch(r),null===e||void 0===e||e(s),!1},blur:function(t,e){var r=t.state.tr.setMeta("focused",!1);return t.dispatch(r),null===n||void 0===n||n(s),!1}}}}),[a,n,e,s]),f=Object(r.useCallback)((function(){var e,n,r={schema:S,plugins:J};(null===(e=t.state)||void 0===e?void 0:e.doc)&&(r.doc=S.nodeFromJSON(t.state.doc),(null===(n=t.state)||void 0===n?void 0:n.selection)&&(r.selection=N.f.fromJSON(r.doc,t.state.selection)));return N.b.create(r)}),[t.state]);return Object(r.useEffect)((function(){var t=Object(D.a)({state:f()},d()),e=new M.c(c.current,t);return u(e),function(){e.destroy()}}),[]),Object(r.useEffect)((function(){null===s||void 0===s||s.setProps(d())}),[d,s]),Object(r.useEffect)((function(){null===s||void 0===s||s.updateState(f())}),[f,s]),Object(l.jsx)("div",{id:"editorContainer",children:Object(l.jsx)("div",{id:"editor",ref:c})})}),L=n(101),W=n(191),$=n.n(W),U=n(193),Y=n.n(U);L.a.plugin($.a),L.a.plugin(Y.a);var G=new L.a("notes");function H(t){return K.apply(this,arguments)}function K(){return(K=Object(k.a)(w.a.mark((function t(e){var n,r,a;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=S.nodeFromJSON(e.state.doc).textContent,e.text=n,r=e.id||e._id,t.next=6,G.upsert(r,(function(t){return e}));case 6:return a=t.sent,t.abrupt("return",a);case 10:t.prev=10,t.t0=t.catch(0),console.log("ERROR: couldn't update \n".concat(t.t0));case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function Q(t,e,n,r,a,c){return Z.apply(this,arguments)}function Z(){return(Z=Object(k.a)(w.a.mark((function t(e,n,r,a,c,i){var o,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o={_id:e||Object(m.a)(),title:n||null,meta:r||{},state:a||{},createdTime:c||Date.now(),lastEditedTime:i||Date.now()},t.next=4,G.putIfNotExists(o);case 4:return s=t.sent,t.abrupt("return",s);case 8:t.prev=8,t.t0=t.catch(0),console.log("ERROR: couldn't create doc ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}function tt(){return et.apply(this,arguments)}function et(){return(et=Object(k.a)(w.a.mark((function t(){var e,n;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G.allDocs({include_docs:!0});case 3:return n=t.sent,t.abrupt("return",null===n||void 0===n||null===(e=n.rows)||void 0===e?void 0:e.map((function(t){return t.doc})));case 7:t.prev=7,t.t0=t.catch(0),console.log("ERROR fetching all notes \n".concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function nt(t){return rt.apply(this,arguments)}function rt(){return(rt=Object(k.a)(w.a.mark((function t(e){var n;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G.get(e);case 3:return n=t.sent,t.abrupt("return",n);case 7:t.prev=7,t.t0=t.catch(0),console.log("ERROR fetching  ".concat(e," \n").concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function at(){return(at=Object(k.a)(w.a.mark((function t(e){var n,r=arguments;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:["title","text"],t.abrupt("return",null===G||void 0===G?void 0:G.search({query:e,fields:n,include_docs:!0}).then((function(t){return t})).catch((function(t){return console.log("Search failed ".concat(t))})));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}G.search({fields:["title","text"],build:!0}).then((function(){return console.log("Index created succesfully")})).catch((function(t){return console.log("ERROR failed to build index")}));var ct=n(38),it=n(19),ot=n(89),st=n(132),ut=n.n(st),lt="ADD_ITEM_TO_CANVAS",dt="REMOVE_ITEM_FROM_CANVAS",ft="UPDATE_ITEM_POSITION",bt={id:"randomID",title:"Main Canvas",items:[]},jt=window.__REDUX_DEVTOOLS_EXTENSION__||ot.a,pt=Object(ot.b)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{openCanvas:bt},e=arguments.length>1?arguments[1]:void 0,n=e.type,r=e.payload;switch(n){case lt:var a=t.openCanvas.items;return a.find((function(t){return t.id===(null===r||void 0===r?void 0:r.id)}))||(t.openCanvas.items=ut()(a,{$push:[r]})),t;case dt:return t.openCanvas.items=t.openCanvas.items.filter((function(t){return t.id!==(null===r||void 0===r?void 0:r.id)})),t;case ft:var c=t.openCanvas.items.find((function(t){return t.id===(null===r||void 0===r?void 0:r.id)}));if(!c)return t;var i=t.openCanvas.items.indexOf(c);return t.openCanvas.items=ut()(t.openCanvas.items,Object(it.a)({},i,{$merge:Object(D.a)({},r)})),t;default:return t}}),jt()),vt="SET_NOTE",Ot="SET_NOTE_STATE",ht="NEW_NOTE",gt=function(t,e){var n=e.type,r=e.payload;switch(n){case vt:return r;case ht:var a=Date.now();return Object(D.a)(Object(D.a)({},r),{},{createdTime:a,lastEditedTime:a});case Ot:return Object(D.a)(Object(D.a)({},t),{},{state:r,lastEditedTime:Date.now()})}},xt=function(t){var e=t.note,n=Object(r.useReducer)(gt,e),a=Object(b.a)(n,2),c=a[0],i=a[1],o=Object(ct.b)(),s=Object(r.useState)(!1),u=Object(b.a)(s,2),d=(u[0],u[1]),f=Object(r.useCallback)(Object(k.a)(w.a.mark((function e(){var n,r,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.id){e.next=14;break}return e.next=3,nt(t.id);case 3:if(!(n=e.sent)){e.next=8;break}i({type:vt,payload:n}),e.next=12;break;case 8:return e.next=10,Q(t.id);case 10:r=e.sent,i({type:ht,payload:r});case 12:e.next=18;break;case 14:return e.next=16,Q();case 16:a=e.sent,i({type:ht,payload:a});case 18:case"end":return e.stop()}}),e)}))),[t.id]);Object(r.useEffect)((function(){f()}),[f]);var j=Object(r.useCallback)((function(t){var e;i({type:Ot,payload:null===t||void 0===t||null===(e=t.state)||void 0===e?void 0:e.toJSON()})}),[]),p=Object(r.useCallback)((function(t){H(c),d(!1)}),[c]);return Object(l.jsxs)("div",{className:"w-1/4 shadow-lg rounded-lg p-5 mr-4 mb-4",children:[Object(l.jsxs)("div",{className:"flex justify-between",children:[Object(l.jsx)("textarea",{placeholder:"Title",defaultValue:null===c||void 0===c?void 0:c.title,className:"font-medium text-3xl w-11/12",onChange:function(t){var e=t.target.value;e.replace(/\n/,""),c.title=e,H(c)},wrap:"soft"}),Object(l.jsx)("button",{className:"h-4 w-4 rounded-full bg-red-300 hover:bg-red-500",onClick:function(t){return o({type:dt,payload:c})}})]}),Object(l.jsx)(z,{state:null===c||void 0===c?void 0:c.state,onChange:j,onBlur:p,onFocus:function(t){return d(!0)}})]})},mt=(n(360),function(t){var e=Object(r.useState)([]),n=Object(b.a)(e,2),a=n[0],c=n[1],i=Object(r.useCallback)(Object(k.a)(w.a.mark((function t(){var e;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,tt();case 2:e=t.sent,c(e);case 4:case"end":return t.stop()}}),t)}))),[c]);return Object(r.useEffect)((function(){var t;i(),t=i,G.changes({since:"now",live:!0}).on("change",(function(){return t()}))}),[i]),Object(l.jsx)("div",{className:"flex w-64 flex-col rounded items-center divide-y divide-gray-200 divide-opacity-50",children:a.map((function(e,n){var r,a=(null===e||void 0===e||null===(r=e.state)||void 0===r?void 0:r.doc)?e.text:"";return Object(l.jsx)("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:function(){t.handleNoteButtonClick(e)},children:e.title||a},n)}))})});var yt=function(){return Object(l.jsx)(j.a,{backend:v.a,children:Object(l.jsx)(wt,{})})},wt=function(t){var e=Object(r.useState)({x:0,y:0}),n=Object(b.a)(e,2),a=(n[0],n[1]),c=Object(r.useState)({x:0,y:0}),i=Object(b.a)(c,2),o=i[0],s=i[1],u=Object(ct.c)((function(t){return t.openCanvas.items})),d=Object(ct.b)(),f=Object(p.a)({accept:[g,x],drop:function(t,e){var n=e.getDifferenceFromInitialOffset(),r=Math.round(t.x+n.x),a=Math.round(t.y+n.y);return t.type===g?O(t.id,r,a):s({x:r,y:a}),{x:r,y:a}}}),j=Object(b.a)(f,2)[1],v=Object(r.useCallback)((function(t,e){var n={type:g,id:Object(m.a)(),x:t,y:e};d({type:lt,payload:n})}),[d]),O=Object(r.useCallback)((function(t,e,n){d({type:ft,payload:{id:t,x:e,y:n}})}),[d]);return Object(l.jsxs)("div",{className:"canvas",ref:j,onMouseMove:function(t){a({x:t.nativeEvent.offsetX,y:t.nativeEvent.offsetY})},onDoubleClick:function(t){v(t.nativeEvent.offsetX,t.nativeEvent.offsetY)},children:[!1,Object(l.jsx)(h,{item:{type:x,id:Object(m.a)(),x:o.x,y:o.y},children:Object(l.jsx)(mt,{handleNoteButtonClick:function(t){var e={id:null===t||void 0===t?void 0:t.id,type:g,x:690,y:320};d({type:lt,payload:e})}})}),Object.entries(u).map((function(t,e){var n=Object(b.a)(t,2),r=(n[0],n[1]);return Object(l.jsx)(h,{item:r,hideSourceOnDrag:!0,children:Object(l.jsx)(xt,{id:r.id})},e)}))]})},kt=n(97);n(361);function Dt(){var t,e=Object(r.useState)(!1),n=Object(b.a)(e,2),a=(n[0],n[1]),c=Object(r.useState)(""),i=Object(b.a)(c,2),o=i[0],s=i[1],u=Object(r.useState)(),d=Object(b.a)(u,2),f=d[0],j=d[1],p=function(t){(function(t){return at.apply(this,arguments)})(t).then((function(t){return j(t)}))},v=Object(ct.b)();return Object(l.jsxs)("div",{className:"relative",children:[Object(l.jsxs)("div",{className:"h-14 w-80 border border-black rounded-full flex justify-between pl-6 items-center relative",children:[Object(l.jsx)("input",{placeholder:"Search",className:"w-3/4 h-full bg-transparent overflow-ellipsis",type:"text",value:o,onChange:function(t){var e=t.target.value;s(e),p(e)},onFocus:function(t){return a(!0)},onBlur:function(t){return a(!1)}}),Object(l.jsx)("button",{className:"h-14 w-14 rounded-full bg-black text-white flex justify-center items-center",children:Object(l.jsx)(kt.b,{})})]}),""!==o&&(null===f||void 0===f?void 0:f.total_rows)>0&&Object(l.jsx)("div",{className:"search-results border border-black border-t-0 rounded-b-lg overflow-hidden",children:null===f||void 0===f||null===(t=f.rows)||void 0===t?void 0:t.map((function(t,e){var n;return Object(l.jsx)("button",{className:"result",onClick:function(e){!function(t){var e={id:null===t||void 0===t?void 0:t.id,type:g,x:690,y:320};v({type:lt,payload:e})}(t.doc),s("")},children:null!==(n=t.doc.title)&&void 0!==n?n:t.doc.title},e)}))})]})}function Nt(){return Object(l.jsxs)("div",{className:"min-h-screen",children:[Object(l.jsx)("div",{id:"top-bar",className:"flex flex-row-reverse p-8",children:Object(l.jsx)(Dt,{})}),Object(l.jsx)(yt,{})]})}function Mt(){var t=Object(ct.b)(),e=Object(r.useCallback)((function(){var e={type:g,id:Object(m.a)(),x:0,y:0};t({type:lt,payload:e})}),[t]);return Object(l.jsx)("button",{onClick:function(){return e()},className:"rounded-full h-16 w-16 fixed right-8 bottom-8 bg-black text-white flex justify-center items-center shadow-md hover:pointer",children:Object(l.jsx)(kt.a,{})})}function Ct(){var t=Object(ct.c)((function(t){return t.openCanvas.items})),e=Object(ct.b)();return Object(l.jsxs)("div",{className:"min-h-screen",children:[Object(l.jsx)("div",{id:"top-bar",className:"flex flex-row-reverse p-8",children:Object(l.jsx)(Dt,{})}),Object(l.jsx)("div",{children:Object(l.jsx)(mt,{handleNoteButtonClick:function(t){var n={id:null===t||void 0===t?void 0:t.id,type:g,x:690,y:320};e({type:lt,payload:n})}})}),Object(l.jsx)("div",{className:"flex flex-wrap h-full w-full justify-center",children:t.map((function(t,e){return Object(l.jsx)(xt,{id:t.id},e)}))}),Object(l.jsx)(Mt,{})]})}function Et(t){return Object(l.jsxs)(d,{children:[Object(l.jsx)(o.b,{from:"/",to:"experiment-501.V2",noThrow:!0}),Object(l.jsxs)(f,{path:"experiment-501.V2",children:[Object(l.jsx)(Nt,{path:"c"}),Object(l.jsx)(Ct,{path:"/"})]})]})}n(362);var _t=function(){return Object(l.jsx)("div",{className:"App",children:Object(l.jsx)(ct.a,{store:pt,children:Object(l.jsx)(Et,{})})})},St=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,377)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};i.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(_t,{})}),document.getElementById("root")),St()}},[[363,1,2]]]);
//# sourceMappingURL=main.b3a1fc85.chunk.js.map