{"version":3,"sources":["router/FadeInTransitionRouter/index.tsx","components/card/card.tsx","model/interfaces.ts","components/remirror-editor/extensions/link-extension/link-extention.ts","components/remirror-editor/extensions/image-extension/image-extension.ts","components/remirror-editor/extensions/math-inline-extension/math-parse-rules.ts","components/remirror-editor/extensions/math-inline-extension/math-inline-extension.ts","components/remirror-editor/extensions/codeblock-extension/supportedLanguages.ts","components/remirror-editor/remirror-editor.tsx","db/pouch/notes.ts","components/NotesContext.tsx","components/note-options-modal/note-options-modal.tsx","components/export-options/export-options.tsx","components/editor-container/editor-container.tsx","components/note-list/note-list.tsx","components/canvas/canvas.tsx","components/searchbar/searchbar.tsx","pages/canvas-workspace.tsx","components/add-note-fab/add-note-fab.tsx","components/remirror-editor/toolbar/index.tsx","pages/panel-workspace/panel-workspace.tsx","components/settings-fab/settings-fab.tsx","pages/library/library.tsx","db/pouch/peers.ts","replication/webrtc.ts","components/peer-connections/peer-connections.tsx","pages/demo.tsx","components/peer-details-modal/peer-details-modal.tsx","components/qr-code-scanner/qr-code-scanner.tsx","components/file-upload-btn/file-upload-btn.tsx","pages/settings/settings.tsx","utils/import/importHtml.ts","components/back-button/back-button.tsx","components/shell/shell.tsx","router/Routes.jsx","App.tsx","reportWebVitals.ts","serviceWorkerRegistration.ts","index.tsx","../node_modules/peerjs/dist sync"],"names":["FadeInTransitionRouter","props","location","TransitionGroup","className","CSSTransition","classNames","timeout","children","key","Card","useDrag","item","collect","monitor","isDragging","drag","preview","id","ref","style","display","hideSourceOnDrag","opacity","top","y","left","x","ItemTypes","LinkExtension","args","addHandler","_","data","window","open","href","markInputRule","regexp","RegExp","type","this","getAttributes","matches","text","RemirrorLinkExtension","ImageExtension","nodeInputRule","alt","src","RemirrorImageExtension","makeTextFragment","schema","Fragment","from","texFromMediaWikiFallbackImage","root","match","querySelector","getAttribute","texFromMathML_01","texFromMathML_02","textContent","matchWikipedia","rules","rule","getFirstMatch","defaultInlineMathParseRules","tag","getAttrs","p","classList","contains","getContent","MathInlineExtension","extension","defaultOptions","command","ExtensionTag","InlineNode","extra","override","group","content","inline","atom","attrs","defaults","parseDOM","toDOM","class","makeInlineMathInputRule","REGEX_INLINE_MATH_DOLLARS_ESCAPED","mathPlugin","extractShortcutNames","Backspace","chainKeyBindingCommands","convertCommand","deleteSelection","mathBackspaceCmd","joinBackward","selectNodeBackward","insertMathCmd","NodeExtension","SupportedLanguages","bash","c","clojure","csharp","cpp","css","go","jsx","markdown","markup","python","regex","rust","sql","typescript","Editor","forwardRef","handleOnError","useCallback","json","invalidContent","transformers","remove","useRemirror","extensions","MarkdownExtension","BoldExtension","ItalicExtension","BlockquoteExtension","defaultTarget","autoLink","HeadingExtension","BulletListExtension","OrderedListExtension","TaskListExtension","enableResizing","CodeExtension","UnderlineExtension","CodeBlockExtension","supportedLanguages","defaultLanguage","HorizontalRuleExtension","onError","state","doc","manager","setState","getContext","useImperativeHandle","initialContent","onChange","params","onFocus","event","onBlur","PouchDB","plugin","Upsert","db","defaultState","updateNote","inputDocument","a","docId","upsert","response","console","log","insertNote","title","meta","createdTime","lastEditedTime","newDocument","_id","uuidv4","Date","now","putIfNotExists","storedDocument","get","then","res","_rev","rev","getNotes","allDocs","include_docs","result","rows","map","row","getNoteById","callback","changes","since","live","on","query","Fuse","keys","includeMatches","minMatchCharLength","includeScore","threshold","ignoreLocation","fuse","results","search","defaultContextValue","items","addItem","addArrayItem","removeItem","removeArrayItem","array","filter","find","NotesContext","React","createContext","displayName","modalStyle","borderRadius","height","maxWidth","marginLeft","marginRight","NoteOptionsModal","Modal","setAppElement","useContext","isOpen","onAfterClose","onAfterOpen","onRequestClose","onClick","note","deleteNote","ExportOptions","useHelpers","getHTML","getMarkdown","htmlContent","fileName","fileBlob","Blob","FileSaver","saveAs","EditorContainer","useState","setNote","focused","setFocused","noteOptionsOpen","setNoteOptionsOpen","remirrorContextRef","useRef","elRef","useLocation","initialiseNote","useEffect","hash","substring","current","scrollIntoView","behavior","handleOnChange","updatedNote","toJSON","handleBlur","e","helpers","getText","handleFocus","placeholder","defaultValue","target","value","replace","wrap","Provider","NoteList","allNotes","setAllNotes","fetchAllNotes","idx","noteText","handleNoteButtonClick","CanvasContainer","DndProvider","backend","HTML5Backend","Canvas","setMousePos","noteListPos","setNoteListPos","cards","useSelector","useDrop","accept","drop","delta","getDifferenceFromInitialOffset","Math","round","moveCardPosition","createCard","onMouseMove","nativeEvent","offsetX","offsetY","onDoubleClick","Object","entries","index","card","SearchBar","setQuery","setResults","navigate","useNavigate","pathToPanel","Search","length","val","onResultClick","pathname","SearchBarResult","matchTitle","some","matchText","HighlightMatch","indices","start","end","CanvasWorkspace","AddNoteFAB","newNote","handleClick","ActiveClass","isActive","Toolbar","commands","useCommands","active","useActive","undo","focus","redo","bold","toggleBold","italic","toggleItalic","underline","toggleUnderline","code","toggleCode","blockquote","toggleBlockquote","bulletList","toggleBulletList","taskList","toggleTaskList","PanelWorkspace","focusedEditorContext","setEditorContext","editorCtx","SettingsFab","Library","selectedNote","setSelectedNote","sort","b","el","toLocaleString","openNoteOptions","peer","dataConnection","inputPeer","getPeers","localStorage","getItem","Peer","setItem","connections","forEach","addPeer","Array","isArray","error","peerId","upsertPeer","Connect","connect","serialization","Replicate","dataToSend","send","PeerConnections","peers","setPeers","Demo","video","videoOutCanvasElement","setPeerId","setDataToSend","canvas","document","getElementById","QRCode","toCanvas","requestAnimationFrame","tick","readyState","HAVE_ENOUGH_DATA","canvasCtx","videoHeight","width","videoWidth","drawImage","imageData","getImageData","jsQR","inversionAttempts","hidden","PeerDetailsModal","canvasEl","setCanvasEl","canvasRef","node","storedPeerId","QRCodeScanner","videoEl","setVideoEl","setScannedData","stream","setStream","videoRef","navigator","mediaDevices","getUserMedia","facingMode","frameRate","ideal","max","mediaStream","srcObject","setAttribute","play","getTracks","track","stop","onScanned","FileUploadBtn","onUpload","maxFileSize","multiple","fileInputField","click","files","Settings","showPeerDetails","setShowPeerDetails","showQRCodeScanner","setShowQRCodeScanner","fileReader","FileReader","i","file","onload","prosemirrorJson","Renderer","render","name","selection","readAsText","ImportFromHtml","BackButton","AppShell","Routes","to","noThrow","path","App","setNoteContext","noteContext","contextValue","useMemo","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","ReactDOM","StrictMode","URL","process","origin","addEventListener","fetch","headers","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration","webpackEmptyContext","req","Error","resolve","module","exports"],"mappings":"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","file":"static/js/main.a9e4a6fb.chunk.js","sourcesContent":["import { TransitionGroup, CSSTransition } from \"react-transition-group\";\nimport { Router, Location } from \"@reach/router\";\nimport \"./style.css\";\n\nconst FadeInTransitionRouter = (props) => {\n  return (\n    <Location>\n      {({ location }) => (\n        <TransitionGroup className=\"transition-group\">\n          <CSSTransition key={location.key} classNames=\"fade\" timeout={500}>\n            <Router location={location}>{props.children}</Router>\n          </CSSTransition>\n        </TransitionGroup>\n      )}\n    </Location>\n  );\n};\n\nexport default FadeInTransitionRouter;\n","import React from \"react\";\nimport { useDrag } from \"react-dnd\";\nimport { ICanvasCard } from \"model/interfaces\";\nimport \"./card.css\";\n\ndeclare interface CardProps {\n  item: ICanvasCard;\n  onRemove?;\n  hideSourceOnDrag?: boolean;\n  children?: any;\n}\n\nconst Card = (props: CardProps) => {\n  const [{ isDragging }, drag, preview] = useDrag({\n    item: props.item,\n    collect: (monitor) => ({\n      isDragging: !!monitor.isDragging(),\n    }),\n  });\n\n  return (\n    <div\n      id={props.item.id}\n      ref={preview}\n      className=\"card\"\n      style={{\n        display: isDragging && props.hideSourceOnDrag ? \"none\" : \"flex\",\n        opacity: isDragging ? 0.5 : 1,\n        top: props.item.y,\n        left: props.item.x,\n      }}\n    >\n      <div className=\"flex justify-end p-3\">\n        <div\n          ref={drag}\n          id={`${props.item.id}-drag-handle`}\n          className=\"card-drag-handle\"\n        ></div>\n      </div>\n\n      {props.children}\n    </div>\n  );\n};\n\nexport default Card;\n","import Fuse from \"fuse.js\";\n\nexport const ItemTypes = {\n  CARD: \"card\",\n  COLLECTION: \"collection\",\n};\n\nexport interface ICanvasCard {\n  type: string;\n  id: string;\n  // The x,y co-ords of the element\n  x: number;\n  y: number;\n}\n\nexport interface ICanvas {\n  id: string;\n  title: string;\n  items: ICanvasCard[];\n}\n\nexport interface INote {\n  id: string;\n  title: string;\n  createdTime: number;\n  lastEditedTime: number;\n  meta: object;\n  state: PMState;\n  text: string;\n}\n\n// JSON serialised prosemirror state returned by state.toJSON()\nexport interface PMState {\n  doc: any;\n  selection: object;\n}\n\nexport interface SearchResult {\n  item: INote;\n  matches: Fuse.FuseResultMatch[];\n}\n\nexport interface IPeer {\n  id: string;\n  name?: string;\n}\n","import { InputRule } from \"@remirror/pm\";\nimport { LinkExtension as RemirrorLinkExtension } from \"remirror/extensions\";\nimport { markInputRule } from \"@remirror/core-utils\";\nimport { MarkPasteRule } from \"@remirror/pm/paste-rules\";\n\nclass LinkExtension extends RemirrorLinkExtension {\n  constructor(args) {\n    super(args);\n    this.addHandler(\"onClick\", (_, data) => {\n      window.open(data.href);\n      return true;\n    });\n  }\n\n  createInputRules(): InputRule[] {\n    return [\n      markInputRule({\n        regexp: (() => {\n          try {\n            return new RegExp(\"?<!!)[(.*?)]((.*?))\");\n          } catch {\n            return /[^!]\\[(.+?)\\]\\((.+?)\\)/;\n          }\n        })(),\n        type: this.type,\n        getAttributes: (matches: string[]) => {\n          const [_, text, href] = matches;\n          return { text: text, href: href };\n        },\n      }),\n    ];\n  }\n\n  // Overwrite the paste rule\n  createPasteRules(): MarkPasteRule[] {\n    return [];\n  }\n}\n\nexport default LinkExtension;\n","import { ImageExtension as RemirrorImageExtension } from \"remirror/extensions\";\nimport { InputRule } from \"@remirror/pm\";\nimport { nodeInputRule } from \"@remirror/core-utils\";\n\nclass ImageExtension extends RemirrorImageExtension {\n  createInputRules(): InputRule[] {\n    return [\n      nodeInputRule({\n        regexp: /!\\[(.+?)\\]\\((.+?)\\)/,\n        type: this.type,\n        getAttributes: (matches: string[]) => {\n          const [_, alt, src] = matches;\n          return { src: src, alt: alt };\n        },\n      }),\n    ];\n  }\n}\n\nexport default ImageExtension;\n","/*---------------------------------------------------------\n *  Author: Benjamin R. Bray\n *  License: MIT\n *--------------------------------------------------------*/\n\n// TODO: Export parse rules benrbray's source repo\n\n/**\n * Note that for some of the `ParseRule`s defined below,\n * we define a `getAttrs` function, which, other than\n * defining node attributes, can be used to describe complex\n * match conditions for a rule.  \n \n * Returning `false` from `ParseRule.getAttrs` prevents the\n * rule from matching, while returning `null` indicates that\n * the default set of note attributes should be used.\n */\n\nimport {\n  Node as ProseNode,\n  Fragment,\n  ParseRule,\n  Schema,\n} from \"prosemirror-model\";\n\n////////////////////////////////////////////////////////////\n\nfunction getFirstMatch(\n  root: Element,\n  rules: ((root: Element) => false | string)[]\n): false | string {\n  for (let rule of rules) {\n    let match: false | string = rule(root);\n    if (match !== false) {\n      return match;\n    }\n  }\n  return false;\n}\n\nfunction makeTextFragment<S extends Schema<any, any>>(\n  text: string,\n  schema: S\n): Fragment<S> {\n  return Fragment.from(schema.text(text) as ProseNode<S>);\n}\n\n////////////////////////////////////////////////////////////\n\n// -- Wikipedia ----------------------------------------- //\n\n/**\n * Look for a child node that matches the following template:\n * <img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/...\"\n *              class=\"mwe-math-fallback-image-inline\"\n *              alt=\"...\" />\n */\nfunction texFromMediaWikiFallbackImage(root: Element): false | string {\n  let match = root.querySelector(\"img.mwe-math-fallback-image-inline[alt]\");\n  return match?.getAttribute(\"alt\") ?? false;\n}\n\n/**\n * Look for a child node that matches the following template:\n * <math xmlns=\"http://www.w3.org/1998/Math/MathML\" alttext=\"...\">\n */\nfunction texFromMathML_01(root: Element): false | string {\n  let match = root.querySelector(\"math[alttext]\");\n  return match?.getAttribute(\"alttext\") ?? false;\n}\n\n/**\n * Look for a child node that matches the following template:\n * <math xmlns=\"http://www.w3.org/1998/Math/MathML\" alttext=\"...\">\n */\nfunction texFromMathML_02(root: Element): false | string {\n  let match = root.querySelector(\n    \"math annotation[encoding='application/x-tex'\"\n  );\n  return match?.textContent ?? false;\n}\n\n/**\n * Look for a child node that matches the following template:\n * <script type=\"math/tex\"></script>\n */\nfunction texFromScriptTag(root: Element): false | string {\n  console.log(\"texFromScriptTag ::\", root);\n  let match = root.querySelector(\"script[type*='math/tex']\");\n  return match?.textContent ?? false;\n}\n\nfunction matchWikipedia(root: Element): false | string {\n  let match: false | string = getFirstMatch(root, [\n    texFromMediaWikiFallbackImage,\n    texFromMathML_01,\n    texFromMathML_02,\n  ]);\n  // TODO: if no tex string was found, but we have MathML, try to parse it\n  return match;\n}\n\n/**\n * Wikipedia formats block math inside a <dl>...</dl> element, as below.\n *\n *   - Evidently no CSS class is used to distinguish inline vs block math\n *   - Sometimes the `\\displaystyle` TeX command is present even in inline math\n *\n * ```html\n * <dl><dd><span class=\"mwe-math-element\">\n *     <span class=\"mwe-math-mathml-inline mwe-math-mathml-ally\" style=\"...\">\n *         <math xmlns=\"http://www.w3.org/1998/Math/MathML\" alttext=\"...\">\n *             <semantics>\n *                 <mrow class=\"MJX-TeXAtom-ORD\">...</mrow>\n *                 <annotation encoding=\"application/x-tex\">...</annotation>\n *             </semantics>\n *         </math>\n *         <img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/...\"\n *              class=\"mwe-math-fallback-image-inline\"\n *              alt=\"...\" />\n *     </span>\n * </span></dd></dl>\n * ```\n */\nexport const wikipediaBlockMathParseRule: ParseRule = {\n  tag: \"dl\",\n  getAttrs(p: Node | string): false | null {\n    let dl = p as HTMLDListElement;\n\n    // <dl> must contain exactly one child\n    if (dl.childElementCount !== 1) {\n      return false;\n    }\n    let dd = dl.firstChild as Element;\n    if (dd.tagName !== \"DD\") {\n      return false;\n    }\n\n    // <dd> must contain exactly one child\n    if (dd.childElementCount !== 1) {\n      return false;\n    }\n    let mweElt = dd.firstChild as Element;\n    if (!mweElt.classList.contains(\"mwe-math-element\")) {\n      return false;\n    }\n\n    // success!  proceed to `getContent` for further processing\n    return null;\n  },\n  getContent<S extends Schema<any, any>>(p: Node, schema: S): Fragment<S> {\n    // search the matched element for a TeX string\n    let match: false | string = matchWikipedia(p as Element);\n    // return a fragment representing the math node's children\n    let texString: string = match || \"\\\\text{\\\\color{red}(paste error)}\";\n    return makeTextFragment(texString, schema);\n  },\n};\n\n/**\n * Parse rule for inline math content on Wikipedia of the following form:\n *\n * ```html\n * <span class=\"mwe-math-element\">\n *     <span class=\"mwe-math-mathml-inline mwe-math-mathml-ally\" style=\"...\">\n *         <math xmlns=\"http://www.w3.org/1998/Math/MathML\" alttext=\"...\">\n *             <semantics>\n *                 <mrow class=\"MJX-TeXAtom-ORD\">...</mrow>\n *                 <annotation encoding=\"application/x-tex\">...</annotation>\n *             </semantics>\n *         </math>\n *         <img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/...\"\n *              class=\"mwe-math-fallback-image-inline\"\n *              alt=\"...\" />\n *     </span>\n * </span>\n * ```\n */\nexport const wikipediaInlineMathParseRule: ParseRule = {\n  tag: \"span\",\n  getAttrs(p: Node | string): false | null {\n    let span = p as HTMLSpanElement;\n    if (!span.classList.contains(\"mwe-math-element\")) {\n      return false;\n    }\n    // success!  proceed to `getContent` for further processing\n    return null;\n  },\n  getContent<S extends Schema<any, any>>(p: Node, schema: S): Fragment<S> {\n    // search the matched element for a TeX string\n    let match: false | string = matchWikipedia(p as Element);\n    // return a fragment representing the math node's children\n    let texString: string = match || \"\\\\text{\\\\color{red}(paste error)}\";\n    return makeTextFragment(texString, schema);\n  },\n};\n\n// -- MathJax ------------------------------------------- //\n\n////////////////////////////////////////////////////////////\n\nexport const defaultInlineMathParseRules: ParseRule[] = [\n  wikipediaInlineMathParseRule,\n];\n\nexport const defaultBlockMathParseRules: ParseRule[] = [\n  wikipediaBlockMathParseRule,\n];\n","import {\n  ApplySchemaAttributes,\n  command,\n  CommandFunction,\n  extension,\n  ExtensionTag,\n  NodeExtension,\n  NodeExtensionSpec,\n  NodeSpecOverride,\n  PrioritizedKeyBindings,\n} from \"@remirror/core\";\nimport { chainKeyBindingCommands, convertCommand } from \"@remirror/core-utils\";\nimport { InputRule, ProsemirrorPlugin } from \"@remirror/pm\";\nimport {\n  deleteSelection,\n  selectNodeBackward,\n  joinBackward,\n} from \"@remirror/pm/commands\";\nimport {\n  REGEX_INLINE_MATH_DOLLARS_ESCAPED,\n  insertMathCmd,\n  mathBackspaceCmd,\n  mathPlugin,\n  makeInlineMathInputRule,\n} from \"@benrbray/prosemirror-math\";\nimport { defaultInlineMathParseRules } from \"./math-parse-rules\";\n// CSS\nimport \"@benrbray/prosemirror-math/style/math.css\";\nimport \"katex/dist/katex.min.css\";\n\nexport interface MathInlineOptions {}\n\n@extension<MathInlineOptions>({\n  defaultOptions: {},\n})\nexport class MathInlineExtension extends NodeExtension<MathInlineOptions> {\n  get name() {\n    return \"math_inline\" as const;\n  }\n\n  createTags() {\n    return [ExtensionTag.InlineNode];\n  }\n\n  createNodeSpec(\n    extra: ApplySchemaAttributes,\n    override: NodeSpecOverride\n  ): NodeExtensionSpec {\n    return {\n      group: \"inline math\",\n      content: \"text*\",\n      inline: true,\n      atom: true,\n      ...override,\n      attrs: {\n        ...extra.defaults(),\n      },\n      parseDOM: [\n        {\n          tag: \"math-inline\",\n        },\n        ...defaultInlineMathParseRules,\n      ],\n      toDOM: () => [\"math-inline\", { class: \"math-node\" }, 0],\n    };\n  }\n\n  createInputRules(): InputRule[] {\n    return [\n      makeInlineMathInputRule(REGEX_INLINE_MATH_DOLLARS_ESCAPED, this.type),\n    ];\n  }\n\n  createExternalPlugins(): ProsemirrorPlugin[] {\n    return [mathPlugin];\n  }\n\n  createKeymap(\n    extractShortcutNames: (shortcut: string) => string[]\n  ): PrioritizedKeyBindings {\n    const command = chainKeyBindingCommands(\n      convertCommand(deleteSelection),\n      convertCommand(mathBackspaceCmd),\n      convertCommand(joinBackward),\n      convertCommand(selectNodeBackward)\n    );\n    return { Backspace: command };\n  }\n\n  @command()\n  insertMathInline(): CommandFunction {\n    return (props) => {\n      insertMathCmd(this.type);\n      return null;\n    };\n  }\n}\n\ndeclare global {\n  namespace Remirror {\n    interface AllExtensions {\n      math_inline: MathInlineExtension;\n    }\n  }\n}\n","import type { RefractorSyntax } from \"refractor/core\";\nimport bash from \"refractor/lang/bash\";\nimport c from \"refractor/lang/c\";\nimport clojure from \"refractor/lang/clojure\";\nimport csharp from \"refractor/lang/csharp\";\nimport cpp from \"refractor/lang/cpp\";\nimport css from \"refractor/lang/css\";\nimport go from \"refractor/lang/go\";\nimport jsx from \"refractor/lang/jsx\";\nimport markdown from \"refractor/lang/markdown\";\nimport markup from \"refractor/lang/markup\";\nimport python from \"refractor/lang/python\";\nimport regex from \"refractor/lang/regex\";\nimport rust from \"refractor/lang/rust\";\nimport sql from \"refractor/lang/sql\";\nimport typescript from \"refractor/lang/typescript\";\n\nconst SupportedLanguages: RefractorSyntax[] = [\n  bash,\n  c,\n  clojure,\n  csharp,\n  cpp,\n  css,\n  go,\n  jsx,\n  markdown,\n  markup,\n  python,\n  regex,\n  rust,\n  sql,\n  typescript,\n];\n\nexport default SupportedLanguages;\n","import \"remirror/styles/all.css\";\nimport \"./remirror-editor.css\";\nimport React, { forwardRef, useCallback, useImperativeHandle } from \"react\";\nimport {\n  BoldExtension,\n  BlockquoteExtension,\n  CodeExtension,\n  HeadingExtension,\n  ItalicExtension,\n  BulletListExtension,\n  OrderedListExtension,\n  TaskListExtension,\n  UnderlineExtension,\n  CodeBlockExtension,\n  HorizontalRuleExtension,\n  MarkdownExtension,\n} from \"remirror/extensions\";\nimport {\n  EditorComponent,\n  ReactFrameworkOutput,\n  Remirror,\n  useRemirror,\n} from \"@remirror/react\";\nimport {\n  Extension,\n  InvalidContentHandler,\n  RemirrorEventListener,\n  RemirrorEventListenerProps,\n} from \"@remirror/core\";\nimport { PMState } from \"model/interfaces\";\nimport {\n  LinkExtension,\n  ImageExtension,\n  MathInlineExtension,\n  SupportedLanguages,\n} from \"components/remirror-editor/extensions\";\n\ninterface EditorProps {\n  onFocus?: (\n    params: RemirrorEventListenerProps<Extension>,\n    event: Event\n  ) => void;\n  onBlur?: (\n    params: RemirrorEventListenerProps<Extension>,\n    event: Event\n  ) => void;\n  onChange?: RemirrorEventListener<Extension>;\n  state?: PMState;\n}\n\nconst Editor = forwardRef<ReactFrameworkOutput<Extension>, EditorProps>(\n  (props: EditorProps, ref) => {\n    const handleOnError: InvalidContentHandler = useCallback(\n      ({ json, invalidContent, transformers }) => {\n        // Automatically remove all invalid nodes and marks.\n        return transformers.remove(json, invalidContent);\n      },\n      []\n    );\n\n    const { manager, state, setState, getContext } = useRemirror({\n      extensions: () => [\n        new MarkdownExtension({}),\n        new BoldExtension({}),\n        new ItalicExtension(),\n        new BlockquoteExtension(),\n        new LinkExtension({ defaultTarget: \"_blank\", autoLink: true }),\n        new HeadingExtension({}),\n        new BulletListExtension({}),\n        new OrderedListExtension(),\n        new TaskListExtension(),\n        new ImageExtension({ enableResizing: true }),\n        new CodeExtension(),\n        new UnderlineExtension(),\n        new MathInlineExtension(),\n        new CodeBlockExtension({\n          supportedLanguages: SupportedLanguages,\n          defaultLanguage: \"typescript\",\n        }),\n        new HorizontalRuleExtension(),\n      ],\n      onError: handleOnError,\n      content: props.state?.doc,\n    });\n\n    useImperativeHandle(ref, () => getContext() as any, [getContext]);\n\n    return (\n      <div className=\"remirror-theme\">\n        <Remirror\n          manager={manager}\n          initialContent={state}\n          onChange={(params) => {\n            setState(params.state);\n            props.onChange?.(params);\n          }}\n          onFocus={(params, event) => {\n            props.onFocus?.(params, event);\n          }}\n          onBlur={(params, event) => {\n            props.onBlur?.(params, event);\n          }}\n        >\n          <EditorComponent />\n        </Remirror>\n      </div>\n    );\n  }\n);\n\nexport default Editor;\n","import PouchDB from \"pouchdb\";\nimport Upsert from \"pouchdb-upsert\";\nimport { INote, PMState, SearchResult } from \"model/interfaces\";\nimport Fuse from \"fuse.js\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport Debug from \"pouchdb-debug\";\n\nPouchDB.plugin(Upsert);\n\n//Enables debugging\n// PouchDB.plugin(Debug);\n// PouchDB.debug.enable(\"*\");\n\nlet db = new PouchDB(\"notes\");\n\nexport const defaultState = { type: \"doc\", content: [{ type: \"paragraph\" }] };\n\nexport async function updateNote(inputDocument: INote) {\n  try {\n    const docId = inputDocument.id || inputDocument[\"_id\"];\n    const response = await db.upsert(docId, (doc) => {\n      return inputDocument as Partial<PouchDB.Core.IdMeta>;\n    });\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't update \\n${error}`);\n  }\n}\n\n// Create a new note\nexport async function insertNote(\n  id?: string,\n  title?: string,\n  meta?: object,\n  state?: PMState,\n  createdTime?: string,\n  lastEditedTime?: string\n) {\n  try {\n    let newDocument = {\n      _id: id || uuidv4(),\n      id: null,\n      title: title || null,\n      meta: meta || {},\n      state: state || defaultState,\n      createdTime: createdTime || Date.now(),\n      lastEditedTime: lastEditedTime || Date.now(),\n    };\n\n    newDocument.id = newDocument._id;\n    const storedDocument = await db.putIfNotExists(newDocument);\n    return storedDocument;\n  } catch (error) {\n    console.log(`ERROR: couldn't create doc ${error}`);\n  }\n}\n\nexport async function deleteNote(id: string) {\n  try {\n    const rev = await db.get(id).then((res) => res._rev);\n    const response = await db.remove(id, rev);\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't delete \\n${error}`);\n  }\n}\n\nexport async function getNotes(): Promise<\n  PouchDB.Core.ExistingDocument<PouchDB.Core.AllDocsMeta>[]\n> {\n  try {\n    let result = await db.allDocs({ include_docs: true });\n    return result?.rows?.map((row) => row.doc);\n  } catch (error) {\n    console.log(`ERROR fetching all notes \\n${error}`);\n  }\n}\n\nexport async function getNoteById(id: string) {\n  try {\n    const doc = await db.get(id);\n    return doc;\n  } catch (error) {\n    console.log(`ERROR fetching  ${id} \\n${error}`);\n  }\n}\n\nexport function onChange(callback) {\n  db.changes({\n    since: \"now\",\n    live: true,\n  }).on(\"change\", () => callback());\n}\n\nexport async function search(query: string): Promise<SearchResult[]> {\n  let fuse = new Fuse(await getNotes(), {\n    keys: [\"title\", \"text\"],\n    includeMatches: true,\n    minMatchCharLength: 2,\n    includeScore: true,\n    threshold: 0.5,\n    ignoreLocation: true,\n  });\n\n  let results = fuse.search(query) as any as SearchResult[];\n  return results;\n}\n","import React from \"react\";\n\nexport let defaultContextValue = {\n  items: [],\n  addItem: (items, item) => {\n    // const { items } = defaultContextValue;\n    defaultContextValue.items = addArrayItem(items, item);\n  },\n  removeItem: (items, item) => {\n    // const { items } = defaultContextValue;\n    defaultContextValue.items = removeArrayItem(items, item);\n  },\n};\n\nexport const removeArrayItem = (array: any[], item: any): any[] =>\n  array.filter((x) => x !== item);\n\nexport const addArrayItem = (array: any[], item: any): any[] =>\n  !array.find((x) => x === item) ? [...array, item] : array;\n\nconst NotesContext = React.createContext(defaultContextValue);\nNotesContext.displayName = \"NotesContext\";\nexport default NotesContext;\n","import React, { useContext, FunctionComponent } from \"react\";\nimport { INote } from \"model/interfaces\";\nimport { deleteNote } from \"db/pouch/notes\";\nimport { FiTrash, FiX } from \"react-icons/fi\";\nimport Modal, { Styles } from \"react-modal\";\nimport NotesContext from \"components/NotesContext\";\n\ninterface NoteOptionsModalProps {\n  note?: INote;\n  isOpen?: boolean;\n  onAfterOpen?;\n  onRequestClose?;\n}\n\nconst modalStyle: Styles = {\n  content: {\n    borderRadius: \".5rem\",\n    height: \"fit-content\",\n    maxWidth: \"40rem\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n};\n\nconst NoteOptionsModal: FunctionComponent<NoteOptionsModalProps> = (props) => {\n  Modal.setAppElement(\"#root\");\n\n  const { items, removeItem } = useContext(NotesContext);\n\n  return (\n    <Modal\n      isOpen={props.isOpen}\n      onAfterClose={props.onAfterOpen}\n      onRequestClose={props.onRequestClose}\n      style={modalStyle}\n    >\n      <div>\n        <h1 className=\"text-center mb-2\">actions</h1>\n        <div className=\"flex flex-col space-y-4\">\n          {props.children}\n          <button\n            className=\"w-full h-16 rounded-lg shadow-md hover:shadow-lg hover:bg-gray-200\"\n            onClick={() => {\n              removeItem(items, props.note.id);\n              props.onRequestClose();\n            }}\n          >\n            <FiX className=\"mx-auto\" /> Close\n          </button>\n\n          <button\n            className=\"w-full h-16 rounded-lg shadow-md bg-red-500 text-white hover:shadow-lg hover:bg-red-600\"\n            onClick={() => {\n              removeItem(items, props.note.id);\n              deleteNote(props.note.id);\n              props.onRequestClose();\n            }}\n          >\n            <FiTrash className=\"mx-auto\" /> Delete\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default NoteOptionsModal;\n","import React, { FunctionComponent } from \"react\";\nimport { useHelpers } from \"@remirror/react\";\nimport { FaMarkdown, FaHtml5 } from \"react-icons/fa\";\nimport FileSaver from \"file-saver\";\nimport { INote } from \"model/interfaces\";\n\ninterface ExportOptionsProps {\n  onRequestClose?;\n  note: INote;\n}\n\nconst ExportOptions: FunctionComponent<ExportOptionsProps> = (props) => {\n  const { getHTML, getMarkdown } = useHelpers();\n  return (\n    <>\n      <button\n        className=\"w-full h-16 rounded-lg shadow-md hover:shadow-lg hover:bg-gray-200\"\n        onClick={() => {\n          const htmlContent = `<!DOCTYPE html>\n          <html>\n          <head>\n            <link href=\"https://cdn.jsdelivr.net/npm/base-css-theme@1.1.3/base.css\" rel=\"stylesheet\">\n          </head>\n          <body style=\"padding: 16px;\">${getHTML()}</body>\n          </html>`;\n\n          let fileName = `${props.note.title}.html`;\n          let fileBlob = new Blob([htmlContent], {\n            type: \"text/plain;charset=utf-8\",\n          });\n          FileSaver.saveAs(fileBlob, fileName);\n\n          props.onRequestClose?.();\n        }}\n      >\n        <FaHtml5 className=\"mx-auto\" /> Export HTML\n      </button>\n\n      <button\n        className=\"w-full h-16 rounded-lg shadow-md hover:shadow-lg hover:bg-gray-200\"\n        onClick={() => {\n          let fileName = `${props.note.title}.md`;\n          let fileBlob = new Blob([getMarkdown()], {\n            type: \"text/plain;charset=utf-8\",\n          });\n          FileSaver.saveAs(fileBlob, fileName);\n\n          props.onRequestClose?.();\n        }}\n      >\n        <FaMarkdown className=\"mx-auto\" /> Export Markdown\n      </button>\n    </>\n  );\n};\n\nexport default ExportOptions;\n","/* Manage the editor's interaction with the db & global state */\nimport React, { useCallback, useEffect, useRef } from \"react\";\nimport Editor from \"components/remirror-editor/remirror-editor\";\nimport { updateNote, getNoteById } from \"db/pouch/notes\";\nimport { useState } from \"react\";\nimport { ReactFrameworkOutput, RemirrorContext } from \"@remirror/react\";\nimport { Extension, RemirrorEventListenerProps } from \"@remirror/core\";\nimport NoteOptionsModal from \"components/note-options-modal/note-options-modal\";\nimport { useLocation } from \"@reach/router\";\nimport ExportOption from \"components/export-options/export-options\";\nimport \"./editor-container.css\";\n\ninterface EditorContainerProps {\n  id: string;\n  handleFocus?;\n}\n\nconst EditorContainer = (props: EditorContainerProps) => {\n  const [note, setNote] = useState<any>();\n  const [focused, setFocused] = useState(false);\n  const [noteOptionsOpen, setNoteOptionsOpen] = useState<boolean>(false);\n\n  const remirrorContextRef = useRef<ReactFrameworkOutput<Extension>>();\n  const elRef = useRef<HTMLDivElement>();\n\n  const location = useLocation();\n\n  const initialiseNote = useCallback(async () => {\n    if (props.id) {\n      // try fetch the note from the db\n      let doc = await getNoteById(props.id);\n      if (doc) {\n        setNote(doc);\n      }\n    }\n  }, [props.id]);\n\n  // On init\n  useEffect(() => {\n    void initialiseNote();\n  }, [initialiseNote]);\n\n  useEffect(() => {\n    if (location.hash) {\n      const id = location.hash.substring(1);\n      if (props.id === id && elRef.current) {\n        elRef.current.scrollIntoView({ behavior: \"smooth\" });\n      }\n    }\n  }, [location.hash, props.id]);\n\n  const handleOnChange = useCallback(\n    (params: RemirrorEventListenerProps<Remirror.Extensions>) => {\n      const updatedNote = {\n        ...note,\n        state: params.state.toJSON(),\n        lastEditedTime: Date.now(),\n      };\n      setNote(updatedNote);\n    },\n    [note]\n  );\n\n  const handleBlur = useCallback(\n    (params: RemirrorEventListenerProps<Remirror.Extensions>, e) => {\n      note.text = params.helpers.getText();\n      void updateNote(note);\n      setFocused(false);\n    },\n    [note]\n  );\n\n  const handleFocus = useCallback(\n    (params: RemirrorEventListenerProps<Remirror.Extensions>, e) => {\n      setFocused(true);\n      props.handleFocus?.(remirrorContextRef.current);\n    },\n    [props]\n  );\n\n  if (!note) return null;\n\n  return (\n    <>\n      <div\n        id={props.id}\n        ref={elRef}\n        className=\"w-full md:w-5/12 lg:w-1/3 shadow-lg rounded-lg p-5 lg:mr-4 mb-4 editor-container\"\n      >\n        <div className=\"flex justify-between\">\n          <textarea\n            placeholder=\"Title\"\n            defaultValue={note?.title}\n            className=\"font-semibold text-4xl w-11/12\"\n            onChange={(e) => {\n              let title = e.target.value;\n              title.replace(/\\n/, \"\");\n              note.title = title;\n              updateNote(note);\n            }}\n            wrap=\"soft\"\n          />\n          <div className=\"flex space-x-2\">\n            <button\n              className={`h-4 w-4 rounded-full border hover:bg-gray-700 hover:border-gray-700 ${\n                focused ? \"border-black bg-black\" : \"border-gray-400\"\n              }`}\n              onClick={() => setNoteOptionsOpen(true)}\n            />\n          </div>\n        </div>\n        <Editor\n          state={note.state}\n          onChange={handleOnChange}\n          onBlur={handleBlur}\n          onFocus={handleFocus}\n          ref={remirrorContextRef}\n        />\n      </div>\n      {remirrorContextRef.current && (\n        <RemirrorContext.Provider value={remirrorContextRef.current}>\n          <NoteOptionsModal\n            isOpen={noteOptionsOpen}\n            note={note}\n            onRequestClose={() => {\n              setNoteOptionsOpen(false);\n            }}\n          >\n            <ExportOption\n              note={note}\n              onRequestClose={() => {\n                setNoteOptionsOpen(false);\n              }}\n            />\n          </NoteOptionsModal>\n        </RemirrorContext.Provider>\n      )}\n    </>\n  );\n};\n\nexport default EditorContainer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { getNotes, onChange } from \"db/pouch/notes\";\nimport { INote } from \"model/interfaces\";\n\ninterface NoteListProps {\n  handleNoteButtonClick(note: INote): any;\n}\n\nconst NoteList = (props: NoteListProps) => {\n  const [allNotes, setAllNotes] = useState([]);\n\n  const fetchAllNotes = useCallback(async () => {\n    const response = await getNotes();\n    setAllNotes(response);\n  }, [setAllNotes]);\n\n  useEffect(() => {\n    fetchAllNotes();\n    onChange(fetchAllNotes);\n  }, [fetchAllNotes]);\n\n  return (\n    <div className=\"flex w-64 flex-col rounded items-center divide-y divide-gray-200 divide-opacity-50\">\n      {allNotes.map((note, idx) => {\n        const noteText = note?.state?.doc ? note.text : \"\";\n\n        return (\n          <button\n            className=\"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200\"\n            key={idx}\n            onClick={() => {\n              props.handleNoteButtonClick(note);\n            }}\n          >\n            {note.title || noteText}\n          </button>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default NoteList;\n","import React, { useCallback, useState } from \"react\";\nimport { DndProvider, useDrop, XYCoord } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport Card from \"components/card/card\";\nimport { ItemTypes, ICanvasCard, INote, ICanvas } from \"model/interfaces\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport EditorContainer from \"components/editor-container/editor-container\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { ADD_ITEM_TO_CANVAS, UPDATE_ITEM } from \"store\";\nimport \"./canvas.css\";\nimport NoteList from \"components/note-list/note-list\";\n\nfunction CanvasContainer() {\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <Canvas />\n    </DndProvider>\n  );\n}\n\nexport default CanvasContainer;\n\nconst Canvas = (props) => {\n  const debug = false;\n  const [mousePos, setMousePos] = useState<XYCoord>({ x: 0, y: 0 });\n  const [noteListPos, setNoteListPos] = useState<XYCoord>({ x: 0, y: 0 });\n\n  const cards: ICanvasCard[] = useSelector(\n    (state: { cards: ICanvasCard[] }) => state.cards\n  );\n  // const dispatch = useDispatch();\n\n  const [, drop] = useDrop({\n    accept: [ItemTypes.CARD, ItemTypes.COLLECTION],\n    drop: (item: ICanvasCard, monitor) => {\n      const delta = monitor.getDifferenceFromInitialOffset() as XYCoord;\n      const x = Math.round(item.x + delta.x);\n      const y = Math.round(item.y + delta.y);\n      item.type === ItemTypes.CARD\n        ? moveCardPosition(item.id, x, y)\n        : setNoteListPos({ x, y });\n\n      return { x, y };\n    },\n  });\n\n  const createCard = useCallback((x: number, y: number) => {\n    const newCard: ICanvasCard = {\n      type: ItemTypes.CARD,\n      id: uuidv4(),\n      x: x,\n      y: y,\n    };\n    // dispatch({ type: ADD_ITEM_TO_CANVAS, payload: newCard });\n  }, []);\n\n  const moveCardPosition = useCallback((id: string, x: number, y: number) => {\n    // dispatch({ type: UPDATE_ITEM, payload: { id: id, x: x, y: y } });\n  }, []);\n\n  const addNoteToCanvas = (note: INote) => {\n    const item: ICanvasCard = {\n      id: note?.id,\n      type: ItemTypes.CARD,\n      x: 690,\n      y: 320,\n    };\n    // dispatch({ type: ADD_ITEM_TO_CANVAS, payload: item });\n  };\n\n  return (\n    <div\n      className=\"canvas\"\n      ref={drop}\n      onMouseMove={(e) => {\n        setMousePos({ x: e.nativeEvent.offsetX, y: e.nativeEvent.offsetY });\n      }}\n      onDoubleClick={(e) => {\n        createCard(e.nativeEvent.offsetX, e.nativeEvent.offsetY);\n      }}\n    >\n      {debug && (\n        <span style={{ color: \"white\" }}>\n          x: {mousePos.x},y: {mousePos.y}\n        </span>\n      )}\n\n      <Card\n        item={{\n          type: ItemTypes.COLLECTION,\n          id: uuidv4(),\n          x: noteListPos.x,\n          y: noteListPos.y,\n        }}\n      >\n        <NoteList handleNoteButtonClick={addNoteToCanvas} />\n      </Card>\n\n      {Object.entries(cards).map(([key, card], index) => (\n        <Card key={index} item={card} hideSourceOnDrag>\n          <EditorContainer id={card.id} />\n        </Card>\n      ))}\n    </div>\n  );\n};\n","import React, { useContext, FunctionComponent } from \"react\";\nimport { useState } from \"react\";\nimport { VscSearch } from \"react-icons/vsc\";\nimport { search } from \"db/pouch/notes\";\nimport \"./searchbar.css\";\nimport { SearchResult } from \"model/interfaces\";\nimport NotesContext from \"components/NotesContext\";\nimport Fuse from \"fuse.js\";\nimport { useNavigate, useLocation } from \"@reach/router\";\n\nexport default function SearchBar() {\n  const [focused, setFocused] = useState(false);\n  const [query, setQuery] = useState(\"\");\n  const [results, setResults] = useState<SearchResult[]>([]);\n\n  const { items, addItem } = useContext(NotesContext);\n\n  const navigate = useNavigate();\n  const location = useLocation();\n  const pathToPanel = \"/poche/p\";\n\n  const Search = (query: string) => {\n    search(query).then((res) => setResults(res));\n  };\n\n  return (\n    <div className=\"relative shadow-sm\">\n      <div className=\"h-10 w-72  rounded-full flex justify-between pl-6 items-center relative\">\n        <input\n          placeholder=\"Search\"\n          className=\"w-3/4 h-full bg-transparent overflow-ellipsis\"\n          type=\"text\"\n          value={query}\n          onChange={(e) => {\n            const { value } = e.target;\n            setQuery(value);\n            Search(value);\n          }}\n          onFocus={(e) => setFocused(true)}\n          onBlur={(e) => setFocused(false)}\n        />\n        <button className=\"h-10 w-10 rounded-full bg-black text-white flex justify-center items-center\">\n          <VscSearch />\n        </button>\n      </div>\n\n      {query !== \"\" && results.length > 0 && (\n        <div className=\"search-results rounded-b-lg overflow-hidden\">\n          {results.map((val) => {\n            return (\n              <SearchBarResult\n                key={val.item.id}\n                onResultClick={() => {\n                  setQuery(\"\");\n                  addItem(items, val.item.id);\n                  if (location.pathname !== pathToPanel) navigate(pathToPanel);\n                }}\n                result={val}\n              />\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface SearchBarResultProps {\n  onResultClick?;\n  result: SearchResult;\n}\n\nconst SearchBarResult: FunctionComponent<SearchBarResultProps> = ({\n  result,\n  onResultClick,\n}) => {\n  const matchTitle = result.matches.some((match) => match.key === \"title\");\n  const matchText = result.matches.some((match) => match.key === \"text\");\n\n  return (\n    <button\n      className=\"result bg-white text-left p-2\"\n      onClick={(_) => {\n        onResultClick?.();\n      }}\n    >\n      <div className=\"text-sm\">\n        {matchTitle &&\n          result.matches.map((match, idx) => {\n            if (match.key === \"title\") {\n              return <HighlightMatch key={idx} match={match} />;\n            } else return null;\n          })}\n        {!matchTitle && result.item.title}\n      </div>\n      <div className=\"text-xs font-extralight\">\n        {matchText &&\n          result.matches.map((match, idx) => {\n            if (match.key === \"text\") {\n              return <HighlightMatch key={idx} match={match} />;\n            } else return null;\n          })}\n        {!matchText && result.item.text}\n      </div>\n    </button>\n  );\n};\n\ninterface HiglightMatchProps {\n  match: Fuse.FuseResultMatch;\n}\nconst HighlightMatch: FunctionComponent<HiglightMatchProps> = ({ match }) => {\n  const [[start, end]] = match.indices;\n  return (\n    <>\n      {match.value?.substring(0, start)}\n      <span className=\"bg-yellow-300\">\n        {match.value?.substring(start, end)}\n      </span>\n      {match.value?.substring(end, match.value?.length)}\n    </>\n  );\n};\n","import React from \"react\";\nimport Canvas from \"components/canvas/canvas\";\nimport SearchBar from \"components/searchbar/searchbar\";\n\nexport default function CanvasWorkspace() {\n  return (\n    <div className=\"min-h-screen\">\n      <div id=\"top-bar\" className=\"flex flex-row-reverse p-8\">\n        <SearchBar />\n      </div>\n      <Canvas />\n    </div>\n  );\n}\n","import React, { useCallback, useContext } from \"react\";\nimport { VscAdd } from \"react-icons/vsc\";\nimport { insertNote } from \"db/pouch/notes\";\nimport NotesContext from \"components/NotesContext\";\n\nexport default function AddNoteFAB(props) {\n  const { items, addItem } = useContext(NotesContext);\n\n  const createCard = useCallback(async () => {\n    let newNote = await insertNote();\n    addItem(items, newNote.id);\n    return newNote.id;\n  }, [addItem, items]);\n\n  return (\n    <button\n      onClick={async () => {\n        const id = await createCard();\n        props?.handleClick?.(id);\n      }}\n      className=\"rounded-full h-16 w-16 fixed right-8 bottom-8 bg-black text-white flex justify-center items-center shadow-md hover:pointer border-2 border-white\"\n    >\n      <VscAdd />\n    </button>\n  );\n}\n","import { useCommands, useActive, useRemirrorContext } from \"@remirror/react\";\nimport { BsTypeUnderline } from \"react-icons/bs\";\nimport {\n  VscBold,\n  VscChecklist,\n  VscCode,\n  VscDiscard,\n  VscItalic,\n  VscListUnordered,\n  VscQuote,\n  VscRedo,\n} from \"react-icons/vsc\";\nimport \"./toolbar.css\";\n\nconst ActiveClass = (isActive: boolean) => {\n  return isActive ? \"active\" : \"\";\n};\n\nconst Toolbar = () => {\n  const commands = useCommands();\n  const active = useActive();\n\n  return (\n    <div className=\"toolbar space-x-2\">\n      <button\n        onClick={() => {\n          commands.undo();\n          commands.focus();\n        }}\n      >\n        <VscDiscard />\n      </button>\n\n      <button\n        onClick={() => {\n          commands.redo();\n          commands.focus();\n        }}\n      >\n        <VscRedo />\n      </button>\n\n      <button\n        className={ActiveClass(active.bold())}\n        onClick={() => {\n          commands.toggleBold();\n          commands.focus();\n        }}\n      >\n        <VscBold />\n      </button>\n      <button\n        className={ActiveClass(active.italic())}\n        onClick={() => {\n          commands.toggleItalic();\n          commands.focus();\n        }}\n      >\n        <VscItalic />\n      </button>\n\n      <button\n        className={ActiveClass(active.underline())}\n        onClick={() => {\n          commands.toggleUnderline();\n          commands.focus();\n        }}\n      >\n        <BsTypeUnderline />\n      </button>\n      <button\n        className={ActiveClass(active.code())}\n        onClick={() => {\n          commands.toggleCode();\n          commands.focus();\n        }}\n      >\n        <VscCode />\n      </button>\n\n      <button\n        className={ActiveClass(active.blockquote())}\n        onClick={() => {\n          commands.toggleBlockquote();\n          commands.focus();\n        }}\n      >\n        <VscQuote />\n      </button>\n\n      <button\n        className={ActiveClass(active.bulletList())}\n        onClick={() => {\n          commands.toggleBulletList();\n          commands.focus();\n        }}\n      >\n        <VscListUnordered />\n      </button>\n\n      <button\n        className={ActiveClass(active.taskList())}\n        onClick={() => {\n          commands.toggleTaskList();\n          commands.focus();\n        }}\n      >\n        <VscChecklist />\n      </button>\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import React, { useEffect, useContext, useState } from \"react\";\nimport { useNavigate } from \"@reach/router\";\nimport EditorContainer from \"components/editor-container/editor-container\";\nimport AddNoteFAB from \"components/add-note-fab/add-note-fab\";\nimport { ReactFrameworkOutput, RemirrorContext } from \"@remirror/react-core\";\nimport Toolbar from \"components/remirror-editor/toolbar\";\nimport NotesContext from \"components/NotesContext\";\nimport \"./panel-workspace.css\";\n\nexport default function PanelWorkspace() {\n  const { items } = useContext(NotesContext);\n\n  const [focusedEditorContext, setEditorContext] =\n    useState<ReactFrameworkOutput<any>>();\n\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (items.length === 0) {\n      navigate(\"/poche\");\n    }\n  }, [items]);\n\n  return (\n    <>\n      <div className=\"editor-list\">\n        {items.map((item) => (\n          <EditorContainer\n            key={item}\n            id={item}\n            handleFocus={(editorCtx) => setEditorContext(editorCtx)}\n          />\n        ))}\n      </div>\n\n      {focusedEditorContext && (\n        <RemirrorContext.Provider value={focusedEditorContext}>\n          <Toolbar />\n        </RemirrorContext.Provider>\n      )}\n      <AddNoteFAB />\n    </>\n  );\n}\n","import { useNavigate } from \"@reach/router\";\nimport React, { FunctionComponent } from \"react\";\nimport { BsGearWideConnected } from \"react-icons/bs\";\n\ninterface SettingsFabProps {}\n\nconst SettingsFab: FunctionComponent<SettingsFabProps> = () => {\n  const navigate = useNavigate();\n  return (\n    <button\n      onClick={() => navigate(\"/poche/settings\")}\n      className=\"rounded-full h-16 w-16 fixed left-8 bottom-8 bg:white hover:bg-black hover:text-white flex justify-center items-center shadow-md hover:pointer\"\n    >\n      <BsGearWideConnected />\n    </button>\n  );\n};\n\nexport default SettingsFab;\n","import React, { useContext, useCallback, useEffect, useState } from \"react\";\nimport { getNotes, onChange } from \"db/pouch/notes\";\nimport { INote } from \"model/interfaces\";\nimport { useNavigate } from \"@reach/router\";\nimport AddNoteFAB from \"components/add-note-fab/add-note-fab\";\nimport { VscKebabVertical } from \"react-icons/vsc\";\nimport NoteOptionsModal from \"components/note-options-modal/note-options-modal\";\nimport \"./library.css\";\nimport NotesContext from \"components/NotesContext\";\nimport SettingsFab from \"components/settings-fab/settings-fab\";\n\nexport default function Library() {\n  const [allNotes, setAllNotes] = useState<INote[]>([]);\n  const [noteOptionsOpen, setNoteOptionsOpen] = useState<boolean>(false);\n  const [selectedNote, setSelectedNote] = useState<INote>();\n\n  const navigate = useNavigate();\n  const { items, addItem } = useContext(NotesContext);\n\n  const fetchAllNotes = useCallback(async () => {\n    const response = (await getNotes()) as any;\n    setAllNotes(response);\n  }, [setAllNotes]);\n\n  const openNoteOptions = (note: INote) => {\n    setSelectedNote(note);\n    setNoteOptionsOpen(true);\n  };\n\n  useEffect(() => {\n    fetchAllNotes();\n    onChange(fetchAllNotes);\n\n    return () => {\n      setAllNotes([]);\n    };\n  }, [fetchAllNotes]);\n\n  return (\n    <>\n      <div className=\"p-5\">\n        <table className=\"rounded-lg divide-y divide-gray-200 note-list shadow-md\">\n          <thead>\n            <tr>\n              <th className=\"w-11/12 lg:w-9/12\">Note</th>\n              <th className=\"hidden lg:block w-2/12\">Edited</th>\n              <th className=\"w-1/12\"></th>\n            </tr>\n          </thead>\n          <tbody>\n            {allNotes\n              .sort((a, b) => (a.lastEditedTime < b.lastEditedTime ? 1 : -1)) // Sort by last edited date descending\n              .map((note, idx) => {\n                return (\n                  <tr key={idx} id={`row-${note.id}`}>\n                    <td>\n                      <button\n                        className=\"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200\"\n                        onClick={() => {\n                          addItem(items, note.id);\n                          navigate(`/poche/p#${note.id}`);\n                        }}\n                      >\n                        <div className=\"flex flex-col text-left\">\n                          <div className=\"font-medium flex space-x-1\">\n                            <span>{note.title || \"No Title\"}</span>\n                            <span\n                              className={`rounded-full h-2 w-2 bg-green-500 ${\n                                items.find((el) => el == note.id)\n                                  ? \"inline\"\n                                  : \"hidden\"\n                              } `}\n                            ></span>\n                          </div>\n                          <span className=\"text-sm text-gray-500 font-light\">\n                            {note.text || \"empty\"}\n                          </span>\n                        </div>\n                      </button>\n                    </td>\n                    <td className=\"hidden md:block\">\n                      {new Date(note.lastEditedTime).toLocaleString()}\n                    </td>\n                    <td>\n                      <button onClick={() => openNoteOptions(note)}>\n                        <VscKebabVertical />\n                      </button>\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n\n        <SettingsFab />\n        <AddNoteFAB\n          handleClick={(id) => navigate(`/poche/p#${id}`)}\n        />\n      </div>\n\n      <NoteOptionsModal\n        isOpen={noteOptionsOpen}\n        note={selectedNote}\n        onRequestClose={() => {\n          setSelectedNote(null);\n          setNoteOptionsOpen(false);\n        }}\n      />\n    </>\n  );\n}\n","import PouchDB from \"pouchdb\";\nimport Upsert from \"pouchdb-upsert\";\nimport { IPeer } from \"model/interfaces\";\n\nPouchDB.plugin(Upsert);\n\nlet db = new PouchDB(\"peers\");\n\nexport function onChange(callback) {\n  db.changes({\n    since: \"now\",\n    live: true,\n  }).on(\"change\", () => callback());\n}\n\nexport async function upsertPeer(inputPeer: IPeer) {\n  try {\n    const docId = inputPeer.id || inputPeer[\"_id\"];\n    const response = await db.upsert(docId, (doc) => {\n      return inputPeer as Partial<PouchDB.Core.IdMeta>;\n    });\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't upsert \\n${error}`);\n  }\n}\n\nexport async function deletePeer(peerId: string) {\n  try {\n    const docId = peerId;\n    const rev = await db.get(docId).then((res) => res._rev);\n    const response = await db.remove(docId, rev);\n    return response;\n  } catch (error) {\n    console.log(`ERROR: couldn't delete \\n${error}`);\n  }\n}\n\nexport async function getPeers(): Promise<\n  PouchDB.Core.ExistingDocument<PouchDB.Core.AllDocsMeta>[]\n> {\n  try {\n    let result = await db.allDocs({ include_docs: true });\n    return result?.rows?.map((row) => row.doc);\n  } catch (error) {\n    console.log(`ERROR fetching all peers \\n${error}`);\n  }\n}\n","import Peer from \"peerjs\";\nimport { getNotes, updateNote } from \"db/pouch/notes\";\nimport { upsertPeer } from \"db/pouch/peers\";\nimport { IPeer } from \"model/interfaces\";\n\nlet id: string;\nlet peer: Peer;\nlet dataConnection: Peer.DataConnection;\n\nid = localStorage.getItem(\"peerId\");\n\ntry {\n  peer = new Peer(id);\n} catch {\n  peer = new Peer();\n  id = peer.id;\n}\n\npeer.on(\"open\", function (id) {\n  localStorage.setItem(\"peerId\", id);\n  console.log(\"My peer ID is: \" + id);\n});\n\npeer.on(\"connection\", (dataConnection) => {\n  console.log(`Connected to ${dataConnection.peer}`);\n  Object.keys(peer.connections).forEach((x) => {\n    addPeer(x);\n  });\n\n  dataConnection = dataConnection;\n  dataConnection.on(\"open\", () => {\n    // Emitted when the connection is established and ready-to-use.\n    dataConnection.on(\"data\", (data) => {\n      console.log(`Recieved data from ${dataConnection.peer}`);\n      console.log(data);\n      if (Array.isArray(data)) {\n        data.forEach((item) => updateNote(item));\n      }\n    });\n  });\n});\n\npeer.on(\"error\", (error) => {\n  console.error(error);\n});\n\nconst addPeer = (peerId: string) => {\n  let peer: IPeer = { id: peerId };\n  upsertPeer(peer);\n};\n\nexport function Connect(peerId: string) {\n  try {\n    dataConnection = peer.connect(peerId, { serialization: \"json\" });\n    Object.keys(peer.connections).forEach((x) => {\n      addPeer(x);\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport async function Replicate() {\n  try {\n    dataConnection.on(\"open\", async () => {\n      // Emitted when the connection is established and ready-to-use.\n      let dataToSend = await getNotes();\n      dataConnection.send(dataToSend);\n      console.log(\"data sent\");\n    });\n  } catch (e) {\n    console.log(e);\n  }\n}\n","import React, { useState, useEffect } from \"react\";\nimport { VscVm } from \"react-icons/vsc\";\nimport { getPeers, onChange } from \"db/pouch/peers\";\nimport { Connect } from \"replication/webrtc\";\n\ninterface Props {}\n\nconst PeerConnections = () => {\n  const [peers, setPeers] = useState<any[]>([]);\n\n  useEffect(() => {\n    getPeers().then((val) => setPeers(val));\n    onChange((_) => getPeers().then((val) => setPeers(val)));\n\n    return () => {\n      setPeers([]);\n    };\n  }, []);\n\n  return (\n    <div className=\"flex space-x-2\">\n      {peers?.map((peer, idx) => (\n        <button\n          key={idx}\n          className=\"rounded-3xl shadow-lg bg-black text-white h-10 w-10 flex flex-col justify-center items-center overflow-hidden \"\n        >\n          <VscVm />\n        </button>\n      ))}\n    </div>\n  );\n};\n\nexport default PeerConnections;\n","import React, { useEffect, useState } from \"react\";\nimport SearchBar from \"components/searchbar/searchbar\";\nimport { Connect, Replicate } from \"replication/webrtc\";\nimport QRCode from \"qrcode\";\nimport jsQR from \"jsqr\";\nimport PeerConnections from \"components/peer-connections/peer-connections\";\n\nexport default function Demo() {\n  const [peerId, setPeerId] = useState<string>(\"\");\n  const [dataToSend, setDataToSend] = useState<string>();\n  let qrcode;\n  let video;\n  let videoOutCanvasElement: HTMLCanvasElement;\n\n  const setupVideoStream = async () => {\n    const constraints = {\n      video: { facingMode: \"environment\", frameRate: { ideal: 10, max: 15 } },\n    };\n\n    let stream = await navigator.mediaDevices.getUserMedia(constraints);\n\n    video = document.getElementById(\"video\");\n    video.srcObject = stream;\n    video.setAttribute(\"playsinline\", true); // required to tell iOS safari we don't want fullscreen\n    video.play();\n  };\n\n  useEffect(() => {\n    // Generate QR Code\n    let canvas = document.getElementById(\"qrcode\");\n    QRCode?.toCanvas(canvas, localStorage.getItem(\"peerId\"));\n\n    // Read QR Code\n    videoOutCanvasElement = document.getElementById(\n      \"videoOutCanvas\"\n    ) as HTMLCanvasElement;\n  }, []);\n\n  let tick = () => {\n    if (video && video.readyState === video.HAVE_ENOUGH_DATA) {\n      let canvasCtx = videoOutCanvasElement.getContext(\"2d\");\n\n      videoOutCanvasElement.height = video.videoHeight;\n      videoOutCanvasElement.width = video.videoWidth;\n      canvasCtx.drawImage(\n        video,\n        0,\n        0,\n        videoOutCanvasElement.width,\n        videoOutCanvasElement.height\n      );\n      var imageData = canvasCtx.getImageData(\n        0,\n        0,\n        videoOutCanvasElement.width,\n        videoOutCanvasElement.height\n      );\n      var code = jsQR(imageData.data, imageData.width, imageData.height, {\n        inversionAttempts: \"dontInvert\",\n      });\n\n      if (code) {\n        console.log(\"Got QR Code\");\n        console.log(code.data);\n        setPeerId(code.data);\n      }\n    }\n    requestAnimationFrame(tick);\n  };\n\n  requestAnimationFrame(tick);\n\n  return (\n    <>\n      <div className=\"flex\">\n        <div className=\"flex flex-col\">\n          <input\n            className=\"border border-black\"\n            type=\"text\"\n            value={peerId}\n            onChange={(e) => {\n              setPeerId(e.target.value);\n            }}\n          />\n          <button\n            className=\"rounded bg-blue-500 text-white\"\n            onClick={(e) => {\n              Connect(peerId);\n            }}\n          >\n            Connect\n          </button>\n        </div>\n        <div className=\"flex flex-col\">\n          <textarea\n            className=\"border border-black\"\n            onChange={(e) => {\n              setDataToSend(e.target.value);\n            }}\n          ></textarea>\n          <button\n            className=\"bg-green-500 text-white rounded\"\n            onClick={(e) => {\n              Replicate();\n            }}\n          >\n            Send\n          </button>\n        </div>\n      </div>\n\n      <PeerConnections />\n      <canvas id=\"videoOutCanvas\" hidden></canvas>\n      <video id=\"video\"></video>\n    </>\n  );\n}\n","import React, {\n  FunctionComponent,\n  useState,\n  useEffect,\n  useCallback,\n} from \"react\";\nimport Modal, { Styles } from \"react-modal\";\nimport QRCode from \"qrcode\";\n\ninterface PeerDetailsModalProps {\n  isOpen?: boolean;\n  onAfterOpen?;\n  onRequestClose?;\n}\n\nconst modalStyle: Styles = {\n  content: {\n    borderRadius: \".5rem\",\n    height: \"fit-content\",\n    maxWidth: \"40rem\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n};\nModal.setAppElement(\"#root\");\n\nconst PeerDetailsModal: FunctionComponent<PeerDetailsModalProps> = (\n  props: PeerDetailsModalProps\n) => {\n  const [peerId, setPeerId] = useState<string>();\n  const [canvasEl, setCanvasEl] = useState(null);\n\n  const canvasRef = useCallback((node) => {\n    if (node !== null) {\n      setCanvasEl(node);\n    }\n  }, []);\n\n  useEffect(() => {\n    const storedPeerId = localStorage.getItem(\"peerId\");\n    setPeerId(storedPeerId);\n  }, []);\n\n  useEffect(() => {\n    if (canvasEl) QRCode?.toCanvas(canvasEl, peerId);\n  }, [peerId, canvasEl]);\n\n  return (\n    <Modal\n      isOpen={props.isOpen}\n      onAfterClose={props.onAfterOpen}\n      onRequestClose={props.onRequestClose}\n      style={modalStyle}\n    >\n      <div className=\"flex flex-col justify-center items-center\">\n        <canvas id=\"qrcode\" ref={canvasRef} />\n        <p className=\"text-center\">{peerId}</p>\n      </div>\n    </Modal>\n  );\n};\n\nexport default PeerDetailsModal;\n","import React, {\n  FunctionComponent,\n  useCallback,\n  useState,\n  useEffect,\n} from \"react\";\nimport Modal, { Styles } from \"react-modal\";\nimport jsQR from \"jsqr\";\n\ninterface QRCodeScannerProps {\n  isOpen?: boolean;\n  onAfterOpen?;\n  onRequestClose?;\n  onScanned?;\n}\nconst modalStyle: Styles = {\n  content: {\n    borderRadius: \".5rem\",\n    height: \"fit-content\",\n    maxWidth: \"40rem\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n};\nModal.setAppElement(\"#root\");\n\nconst QRCodeScanner: FunctionComponent<QRCodeScannerProps> = (props) => {\n  const [canvasEl, setCanvasEl] = useState(null);\n  const [videoEl, setVideoEl] = useState(null);\n  const [_, setScannedData] = useState<string>(\"\");\n  const [stream, setStream] = useState<MediaStream>();\n\n  const canvasRef = useCallback((node) => {\n    if (node !== null) {\n      setCanvasEl(node);\n    }\n  }, []);\n  const videoRef = useCallback((node) => {\n    if (node !== null) {\n      setVideoEl(node);\n    }\n  }, []);\n\n  useEffect(() => {\n    const constraints = {\n      video: { facingMode: \"environment\", frameRate: { ideal: 10, max: 15 } },\n    };\n\n    try {\n      navigator.mediaDevices.getUserMedia(constraints).then((mediaStream) => {\n        setStream(mediaStream);\n        if (videoEl) {\n          videoEl.srcObject = mediaStream;\n          videoEl.setAttribute(\"playsinline\", \"true\"); // required to tell iOS safari we don't want fullscreen\n          videoEl.play();\n          requestAnimationFrame(tick);\n        }\n      });\n    } catch (error) {\n      console.log(`Couldn't set up video stream \\n:${error}`);\n    }\n\n    return () => {\n      tick = null;\n      stream?.getTracks().forEach((track) => {\n        track.stop();\n      });\n    };\n  }, [videoEl]);\n\n  // Attempt to close the video stream while QRCode component is in the DOM\n  useEffect(() => {\n    if (!props.isOpen && stream?.active) {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n      });\n    }\n  }, [props.isOpen, stream]);\n\n  let tick = () => {\n    if (videoEl && videoEl.readyState === videoEl.HAVE_ENOUGH_DATA) {\n      let canvasCtx = canvasEl.getContext(\"2d\");\n\n      canvasEl.height = videoEl.videoHeight;\n      canvasEl.width = videoEl.videoWidth;\n      canvasCtx.drawImage(videoEl, 0, 0, canvasEl.width, canvasEl.height);\n      var imageData = canvasCtx.getImageData(\n        0,\n        0,\n        canvasEl.width,\n        canvasEl.height\n      );\n      var code = jsQR(imageData.data, imageData.width, imageData.height, {\n        inversionAttempts: \"dontInvert\",\n      });\n\n      if (code?.data) {\n        console.log(\"Got QR Code\");\n        console.log(code.data);\n        setScannedData(code.data);\n        props?.onScanned(code.data);\n        tick = null;\n      }\n    }\n    if (tick) requestAnimationFrame(tick);\n  };\n\n  return (\n    <Modal\n      isOpen={props.isOpen}\n      onAfterClose={props.onAfterOpen}\n      onRequestClose={props.onRequestClose}\n      style={modalStyle}\n    >\n      <canvas id=\"videoOutCanvas\" ref={canvasRef} hidden></canvas>\n      <video id=\"video\" ref={videoRef}></video>\n    </Modal>\n  );\n};\n\nexport default QRCodeScanner;\n","import React, { FunctionComponent, useRef } from \"react\";\nimport { FiUpload } from \"react-icons/fi\";\n\nconst DEFAULT_MAX_FILE_SIZE_IN_BYTES = 500000;\n\ninterface FileUploadBtnProps {\n  maxFileSize?: number;\n  multiple?: boolean;\n  onUpload?(files: FileList): any;\n  accept?: string;\n}\n\nconst FileUploadBtn: FunctionComponent<FileUploadBtnProps> = ({\n  onUpload,\n  maxFileSize = DEFAULT_MAX_FILE_SIZE_IN_BYTES,\n  multiple = false,\n  accept = \"*\",\n}) => {\n  const fileInputField = useRef(null);\n\n  return (\n    <section>\n      <button\n        type=\"button\"\n        className=\"flex space-x-2 items-center bg-black text-white px-5 py-2 rounded-3xl\"\n        onClick={(e) => fileInputField.current.click()}\n      >\n        <FiUpload />\n        <span> Upload {multiple ? \"files\" : \"a file\"}</span>\n      </button>\n      <input\n        type=\"file\"\n        ref={fileInputField}\n        title=\"\"\n        value=\"\"\n        accept={accept}\n        className=\"hidden\"\n        onChange={(e) => {\n          const { files } = e.target;\n          if (files.length) {\n            onUpload?.(files);\n          }\n        }}\n      />\n    </section>\n  );\n};\n\nexport default FileUploadBtn;\n","import React, { FunctionComponent, useState } from \"react\";\nimport PeerDetailsModal from \"components/peer-details-modal/peer-details-modal\";\nimport { ImQrcode } from \"react-icons/im\";\nimport { BsUpcScan } from \"react-icons/bs\";\nimport PeerConnections from \"components/peer-connections/peer-connections\";\nimport QRCodeScanner from \"components/qr-code-scanner/qr-code-scanner\";\nimport FileUploadBtn from \"components/file-upload-btn/file-upload-btn\";\nimport { Connect, Replicate } from \"replication/webrtc\";\nimport ImportFromHtml from \"utils/import/importHtml\";\n\ninterface SettingsProps {}\n\nconst Settings: FunctionComponent<SettingsProps> = () => {\n  const [showPeerDetails, setShowPeerDetails] = useState(false);\n  const [showQRCodeScanner, setShowQRCodeScanner] = useState(false);\n  return (\n    <>\n      <div className=\"p-5\">\n        <h1>Import HTML</h1>\n        <FileUploadBtn\n          accept=\".html\"\n          onUpload={(files) => ImportFromHtml(files)}\n        />\n        <h1>Replication</h1>\n        <div className=\"flex flex-col items-center\">\n          <h3>Connected Devices</h3>\n          <PeerConnections />\n\n          <h3>Add Devices</h3>\n          <div className=\"flex items-center justify-center w-full flex-wrap md:space-x-4\">\n            <button\n              className=\"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2\"\n              onClick={() => setShowPeerDetails(true)}\n            >\n              <ImQrcode /> <span>Show QR Code</span>\n            </button>\n            <button\n              className=\"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2\"\n              onClick={() => setShowQRCodeScanner(true)}\n            >\n              <BsUpcScan /> <span>Scan</span>\n            </button>\n          </div>\n        </div>\n      </div>\n      <PeerDetailsModal\n        isOpen={showPeerDetails}\n        onRequestClose={() => setShowPeerDetails(false)}\n      />\n\n      <QRCodeScanner\n        isOpen={showQRCodeScanner}\n        onRequestClose={() => setShowQRCodeScanner(false)}\n        onScanned={async (data) => {\n          Connect(data);\n          await Replicate();\n          setShowQRCodeScanner(false);\n        }}\n      />\n    </>\n  );\n};\n\nexport default Settings;\n","import { insertNote } from \"db/pouch/notes\";\nimport { Renderer } from \"html-to-prosemirror\";\n\nexport default function ImportFromHtml(files: FileList) {\n  const fileReader = new FileReader();\n\n  for (let i = 0; i < files.length; i++) {\n    const file = files[i];\n    fileReader.onload = (e) => {\n      const htmlContent = e.target.result;\n      const renderer = new Renderer();\n      const prosemirrorJson = renderer.render(htmlContent);\n      const title = file.name.replace(\".html\", \"\");\n      insertNote(null, title, null, {\n        doc: prosemirrorJson,\n        selection: null,\n      });\n    };\n\n    if (file.type === \"text/html\") fileReader.readAsText(file);\n  }\n}\n","import React, { FunctionComponent } from \"react\";\nimport { useNavigate } from \"@reach/router\";\nimport { VscChevronLeft } from \"react-icons/vsc\";\n\ninterface BackButtonProps {}\n\nconst BackButton: FunctionComponent<BackButtonProps> = () => {\n  const navigate = useNavigate();\n  return (\n    <button\n      className=\"h-8 w-8 hover:bg-black hover:text-white rounded-full flex justify-center items-center\"\n      onClick={() => navigate(-1)}\n    >\n      <VscChevronLeft />\n    </button>\n  );\n};\n\nexport default BackButton;\n","import React, { FunctionComponent } from \"react\";\nimport BackButton from \"components/back-button/back-button\";\nimport SearchBar from \"components/searchbar/searchbar\";\n\ninterface AppShellProps {}\n\nconst AppShell: FunctionComponent<AppShellProps> = (props) => {\n  return (\n    <div className=\"min-h-screen max-w-full\">\n      <div className=\"w-full flex justify-between items-center mb-2 p-2\">\n        <BackButton />\n        <div className=\"hidden md:inline-block\">\n          <SearchBar />\n        </div>\n      </div>\n      {props.children}\n    </div>\n  );\n};\n\nexport default AppShell;\n","import React from \"react\";\nimport { Redirect } from \"@reach/router\";\nimport FadeInTransitionRouter from \"./FadeInTransitionRouter\";\nimport CanvasWorkspace from \"pages/canvas-workspace\";\nimport PanelWorkspace from \"pages/panel-workspace/panel-workspace\";\nimport Library from \"pages/library/library\";\nimport Demo from \"pages/demo\";\nimport Settings from \"pages/settings/settings\";\nimport AppShell from \"components/shell/shell\";\n\nexport default function Routes(props) {\n  return (\n    <FadeInTransitionRouter>\n      <Redirect from=\"/\" to=\"poche\" noThrow />\n      <AppShell path=\"/poche\">\n        <CanvasWorkspace path=\"/c\" />\n        <PanelWorkspace path=\"/p\" />\n        <Library path=\"/\" />\n        <Settings path=\"/settings\" />\n        <Demo path=\"/demo\" />\n      </AppShell>\n    </FadeInTransitionRouter>\n  );\n}\n","import React, { useState, useEffect, useMemo } from \"react\";\nimport Routes from \"router/Routes\";\nimport \"./App.css\";\nimport NoteContext, {\n  addArrayItem,\n  removeArrayItem,\n} from \"components/NotesContext\";\n\nfunction App() {\n  const [noteContext, setNoteContext] = useState({\n    items: [],\n    addItem: (items, item) => {\n      if (!items.find((x) => x === item)) {\n        setNoteContext({\n          ...noteContext,\n          items: addArrayItem(items, item),\n        });\n      }\n    },\n    removeItem: (items, item) => {\n      setNoteContext({\n        ...noteContext,\n        items: removeArrayItem(items, item),\n      });\n    },\n  });\n\n  const contextValue = useMemo(() => noteContext, [noteContext]);\n\n  return (\n    <div className=\"App\">\n      <NoteContext.Provider value={contextValue}>\n        <Routes />\n      </NoteContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 726;"],"sourceRoot":""}