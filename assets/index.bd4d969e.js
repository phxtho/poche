var Q=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var F=(e,t,a)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,x=(e,t)=>{for(var a in t||(t={}))ee.call(t,a)&&F(e,a,t[a]);if(A)for(var a of A(t))te.call(t,a)&&F(e,a,t[a]);return e},w=(e,t)=>Y(e,Z(t));import{L as ne,m as ae,I as se,n as oe,F as re,N as le,E as ie,a as ce,R as de,b as ue,c as he,i as me,d as E,e as fe,j as ge,s as xe,f as pe,g as ve,h as we,k as be,l as ye,o as Ce,p as ke,q as Ne,r as Ee,t as Re,u as Oe,v as _e,w as Se,x as Ie,y as Le,z as Me,A as Ae,B as Fe,C as i,D as Te,M as Be,G as $e,H as Pe,J as We,K as je,O as qe,P as De,T as He,Q as Ve,U as Ue,S as ze,V as Ke,W as n,X as Xe,Y as Ge,Z as j,_ as Je,$ as Qe,a0 as Ye,a1 as p,a2 as T,a3 as c,a4 as Ze,a5 as B,a6 as et,a7 as tt,a8 as _,a9 as nt,aa as at,ab as $,ac as q,ad as D,ae as H,af as st,ag as ot,ah as rt,ai as lt,aj as it,ak as ct,al as dt,am as ut,an as ht,ao as mt,ap as ft,aq as gt,ar as S,as as xt,at as pt,au as vt,av as wt,aw as bt,ax as yt,ay as Ct,az as kt,aA as Nt,aB as Et,aC as R,aD as Rt}from"./vendor.6f5c5b13.js";const Ot=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}};Ot();const _t="modulepreload",P={},St="/poche/",It=function(t,a){return!a||a.length===0?t():Promise.all(a.map(s=>{if(s=`${St}${s}`,s in P)return;P[s]=!0;const o=s.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${l}`))return;const r=document.createElement("link");if(r.rel=o?"stylesheet":_t,o||(r.as="script",r.crossOrigin=""),r.href=s,document.head.appendChild(r),o)return new Promise((d,u)=>{r.addEventListener("load",d),r.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};class Lt extends ne{constructor(t){super(t);this.addHandler("onClick",(a,s)=>(window.open(s.href),!0))}createInputRules(){return[ae({regexp:(()=>{try{return new RegExp("?<!!)[(.*?)]((.*?))")}catch{return/[^!]\[(.+?)\]\((.+?)\)/}})(),type:this.type,getAttributes:t=>{const[a,s,o]=t;return{text:s,href:o}}})]}createPasteRules(){return[]}}class Mt extends se{createInputRules(){return[oe({regexp:/!\[(.+?)\]\((.+?)\)/,type:this.type,getAttributes:t=>{const[a,s,o]=t;return{src:o,alt:s}}})]}}function At(e,t){for(let a of t){let s=a(e);if(s!==!1)return s}return!1}function Ft(e,t){return re.from(t.text(e))}function Tt(e){var a;let t=e.querySelector("img.mwe-math-fallback-image-inline[alt]");return(a=t==null?void 0:t.getAttribute("alt"))!=null?a:!1}function Bt(e){var a;let t=e.querySelector("math[alttext]");return(a=t==null?void 0:t.getAttribute("alttext"))!=null?a:!1}function $t(e){var a;let t=e.querySelector("math annotation[encoding='application/x-tex'");return(a=t==null?void 0:t.textContent)!=null?a:!1}function Pt(e){return At(e,[Tt,Bt,$t])}const Wt={tag:"span",getAttrs(e){return e.classList.contains("mwe-math-element")?null:!1},getContent(e,t){let s=Pt(e)||"\\text{\\color{red}(paste error)}";return Ft(s,t)}},jt=[Wt];var qt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,V=(e,t,a,s)=>{for(var o=s>1?void 0:s?Dt(t,a):t,l=e.length-1,r;l>=0;l--)(r=e[l])&&(o=(s?r(t,a,o):r(o))||o);return s&&o&&qt(t,a,o),o};let O=class extends le{get name(){return"math_inline"}createTags(){return[ie.InlineNode]}createNodeSpec(e,t){return w(x({group:"inline math",content:"text*",inline:!0,atom:!0},t),{attrs:x({},e.defaults()),parseDOM:[{tag:"math-inline"},...jt],toDOM:()=>["math-inline",{class:"math-node"},0]})}createInputRules(){return[ce(de,this.type)]}createExternalPlugins(){return[ue]}createKeymap(e){return{Backspace:he(E(we),E(fe),E(ge),E(xe))}}insertMathInline(){return e=>(me(this.type),null)}};V([pe()],O.prototype,"insertMathInline",1);O=V([ve({defaultOptions:{}})],O);const Ht=[be,ye,Ce,ke,Ne,Ee,Re,Oe,_e,Se,Ie,Le,Me,Ae,Fe],Vt=i.exports.forwardRef((e,t)=>{var d;const a=i.exports.useCallback(({json:u,invalidContent:m,transformers:f})=>f.remove(u,m),[]),{manager:s,state:o,setState:l,getContext:r}=Te({extensions:()=>[new Be({}),new $e({}),new Pe,new We,new Lt({defaultTarget:"_blank",autoLink:!0}),new je({}),new qe({}),new De,new He,new Mt({enableResizing:!0}),new Ve,new Ue,new O,new ze({supportedLanguages:Ht,defaultLanguage:"typescript"}),new Ke],onError:a,content:(d=e.state)==null?void 0:d.doc});return i.exports.useImperativeHandle(t,()=>r(),[r]),n("div",{id:e.id,className:"remirror-theme",children:n(Xe,{manager:s,initialContent:o,onChange:u=>{var m;l(u.state),(m=e.onChange)==null||m.call(e,u)},onFocus:(u,m)=>{var f;(f=e.onFocus)==null||f.call(e,u,m)},onBlur:(u,m)=>{var f;(f=e.onBlur)==null||f.call(e,u,m)},children:n(Ge,{})})})});j.plugin(Je);let y=new j("notes");const Ut={type:"doc",content:[{type:"paragraph"}]};async function W(e){try{const t=e.id||e._id;return await y.upsert(t,s=>e)}catch(t){console.log(`ERROR: couldn't update 
${t}`)}}async function zt(e,t,a,s,o,l){try{let r={_id:e||Ye(),id:null,title:t||null,meta:a||{},state:s||Ut,createdTime:o||Date.now(),lastEditedTime:l||Date.now()};return r.id=r._id,await y.putIfNotExists(r)}catch(r){console.log(`ERROR: couldn't create doc ${r}`)}}async function Kt(e){try{const t=await y.get(e).then(s=>s._rev);return await y.remove(e,t)}catch(t){console.log(`ERROR: couldn't delete 
${t}`)}}async function U(){var e;try{let t=await y.allDocs({include_docs:!0});return(e=t==null?void 0:t.rows)==null?void 0:e.map(a=>a.doc)}catch(t){console.log(`ERROR fetching all notes 
${t}`)}}async function z(e){try{return await y.get(e)}catch(t){console.log(`ERROR fetching  ${e} 
${t}`)}}function Xt(e){y.changes({since:"now",live:!0}).on("change",()=>e())}async function xn(e){return new Qe(await U(),{keys:["title","text"],includeMatches:!0,minMatchCharLength:2,includeScore:!0,threshold:.5,ignoreLocation:!0}).search(e)}let K={items:[],addItem:()=>{},removeItem:()=>{},navOpen:!1,toggleNav:()=>{}};const Gt=(e,t)=>e.filter(a=>a!==t),Jt=(e,t)=>e.find(a=>a===t)?e:[...e,t],v=i.exports.createContext(K);v.displayName="NotesContext";const Qt=e=>{const[t,a]=i.exports.useState(K),s=i.exports.useCallback(r=>{const{items:d}=t;d.find(u=>u===r)||a(w(x({},t),{items:Jt(d,r)}))},[t]),o=i.exports.useCallback(r=>{const{items:d}=t;a(w(x({},t),{items:Gt(d,r)}))},[t]),l=i.exports.useCallback(()=>{a(w(x({},t),{navOpen:!t.navOpen}))},[t]);return n("div",{className:"App",children:n(v.Provider,{value:w(x({},t),{addItem:s,removeItem:o,toggleNav:l}),children:e.children})})},k=({children:e,className:t,onClick:a})=>n(p.button,{whileTap:{scale:.9},className:`h-12 w-full px-4 py-3 bg-gray-200 opacity-80 rounded-xl flex justify-between items-center hover:bg-gray-800 hover:text-white ${t}`,onClick:a,children:e});const X=e=>{var o,l,r;T.setAppElement("#root");const{items:t,removeItem:a}=i.exports.useContext(v),s=(o=e.note)==null?void 0:o.id;return n(T,{isOpen:(l=e.isOpen)!=null?l:!1,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,overlayClassName:"fixed inset-0 bg-[rgba(30,30,30,.5)]",className:"z-20 bg-gray-100 backdrop-blur-lg rounded-t-xl absolute w-full bottom-0 left-0 right-0 p-4 mx-auto max-w-2xl ",children:c("div",{children:[c("div",{className:"flex justify-between mb-6",children:[c("div",{className:"flex items-center space-x-1 text-xl",children:[n(Ze,{}),n("h2",{children:(r=e.note)==null?void 0:r.title})]}),n("button",{className:"rounded-full h-8 w-8 bg-gray-200 opacity-80 hover:bg-gray-800 hover:text-white  flex justify-center items-center",onClick:e.onRequestClose,children:n(B,{})})]}),c("div",{className:"flex flex-col space-y-4 items-center",children:[e.children,t.find(d=>d===s)&&c(k,{onClick:()=>{a(s),e.onRequestClose()},children:[n("span",{children:"Close"})," ",n(B,{})]}),c(k,{onClick:()=>{a(s),Kt(s!=null?s:""),e.onRequestClose()},children:[n("span",{children:"Delete"})," ",n(et,{})]})]})]})})},Yt=e=>{const{getHTML:t,getMarkdown:a}=tt();return c(_,{children:[c(k,{onClick:()=>{var u;const l=`<!DOCTYPE html>
    <html>
    <head>
      <link href="https://cdn.jsdelivr.net/npm/base-css-theme@1.1.3/base.css" rel="stylesheet">
    </head>
    <body style="padding: 16px;">${t()}</body>
    </html>`;let r=`${e.note.title}.html`,d=new Blob([l],{type:"text/plain;charset=utf-8"});$.saveAs(d,r),(u=e.onRequestClose)==null||u.call(e)},children:[n("span",{children:"Export HTML"})," ",n(nt,{})]}),c(k,{onClick:()=>{var d;let l=`${e.note.title}.md`,r=new Blob([a()],{type:"text/plain;charset=utf-8"});$.saveAs(r,l),(d=e.onRequestClose)==null||d.call(e)},children:[n("span",{children:"Export Markdown"})," ",n(at,{})]})]})};const Zt=e=>{const[t,a]=i.exports.useState(),[s,o]=i.exports.useState(!1),[l,r]=i.exports.useState(!1),d=i.exports.useRef(),u=i.exports.useRef(),m=q(),f=i.exports.useCallback(async()=>{if(e.id){let g=await z(e.id);g&&a(g)}},[e.id]);i.exports.useEffect(()=>{f()},[f]),i.exports.useEffect(()=>{if(m.hash){const g=m.hash.substring(1);e.id===g&&u.current&&u.current.scrollIntoView({behavior:"smooth"})}},[m.hash,e.id]);const h=i.exports.useCallback(g=>{const C=w(x({},t),{state:g.state.toJSON(),lastEditedTime:Date.now()});a(C)},[t]),N=i.exports.useCallback((g,C)=>{t.text=g.helpers.getText(),W(t),o(!1)},[t]),I=i.exports.useCallback((g,C)=>{var M;o(!0),(M=e.handleFocus)==null||M.call(e,d.current)},[e]);return t?c(_,{children:[n(D,{children:c(p.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},id:e.id,ref:u,className:"w-full md:w-3/4 lg:w-1/2 xl:w-1/3 hover:shadow-lg rounded-lg p-5 lg:mr-4 mb-4 editor-container",children:[c("div",{className:"flex justify-between",children:[n("textarea",{placeholder:"Title",defaultValue:t==null?void 0:t.title,className:"font-semibold text-4xl w-11/12",onChange:g=>{let C=g.target.value;C.replace(/\n/,""),t.title=C,W(t)},wrap:"soft"}),n("div",{className:"flex space-x-2",children:n(p.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:`h-4 w-4 rounded-full opacity-80 border hover:bg-gray-800 hover:border-gray-800 ${s?"border-gray-200 bg-gray-200":"border-gray-200"}`,onClick:()=>r(!0)})})]}),n(Vt,{id:t.id,state:t.state,onChange:h,onBlur:N,onFocus:I,ref:d})]})}),d.current&&n(H.Provider,{value:d.current,children:n(X,{isOpen:l,note:t,onRequestClose:()=>{r(!1)},children:n(Yt,{note:t,onRequestClose:()=>{r(!1)}})})})]}):null};function G(e){const{addItem:t}=i.exports.useContext(v),a=async()=>{let s=await zt();return t(s.id),s.id};return n(p.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:async()=>{var o;const s=await a();(o=e==null?void 0:e.handleClick)==null||o.call(e,s)},className:"bg-gray-200  text-black backdrop-blur-xl rounded-full h-16 w-16 fixed right-1 bottom-12 md:right-8 md:bottom-8 flex justify-center items-center shadow-md hover:pointer hover:opacity-100 hover:bg-green-500 hover:text-white",children:n(st,{})})}const b=e=>e?"active":"",en=()=>{const e=ot(),t=rt();return c("div",{className:"toolbar space-x-2",children:[n("button",{onClick:()=>{e.undo(),e.focus()},children:n(lt,{})}),n("button",{onClick:()=>{e.redo(),e.focus()},children:n(it,{})}),n("button",{className:b(t.bold()),onClick:()=>{e.toggleBold(),e.focus()},children:n(ct,{})}),n("button",{className:b(t.italic()),onClick:()=>{e.toggleItalic(),e.focus()},children:n(dt,{})}),n("button",{className:b(t.underline()),onClick:()=>{e.toggleUnderline(),e.focus()},children:n(ut,{})}),n("button",{className:b(t.code()),onClick:()=>{e.toggleCode(),e.focus()},children:n(ht,{})}),n("button",{className:b(t.blockquote()),onClick:()=>{e.toggleBlockquote(),e.focus()},children:n(mt,{})}),n("button",{className:b(t.bulletList()),onClick:()=>{e.toggleBulletList(),e.focus()},children:n(ft,{})}),n("button",{className:b(t.taskList()),onClick:()=>{e.toggleTaskList(),e.focus()},children:n(gt,{})})]})};function tn(){const{items:e,addItem:t}=i.exports.useContext(v),[a,s]=i.exports.useState();S();const o=q();return i.exports.useEffect(()=>{if(o.hash){const l=o.hash.substring(1);l&&!e.includes(l)&&z(l).then(r=>{r&&t(l)})}},[o.hash]),c(_,{children:[e.length>0&&n("div",{className:"editor-list",children:e.map(l=>n(Zt,{id:l,handleFocus:r=>s(r)},l))}),e.length===0&&c("div",{className:"absolute mx-auto top-1/2 w-full text-center text-gray-300",children:[n(xt,{className:"h-10 w-10 mx-auto"}),n("h1",{children:"Workspace Empty"})]}),a&&n(H.Provider,{value:a,children:n(en,{})}),n(G,{})]})}function nn(){const[e,t]=i.exports.useState([]),[a,s]=i.exports.useState(!1),[o,l]=i.exports.useState(),r=S(),{items:d,addItem:u}=i.exports.useContext(v),m=i.exports.useCallback(async()=>{const h=await U();t(h)},[t]),f=h=>{l(h),s(!0)};return i.exports.useEffect(()=>(m(),Xt(m),()=>{t([])}),[m]),c(_,{children:[c("div",{className:"p-5 md:px-14 lg:px-36",children:[c("table",{className:"rounded-lg divide-y divide-gray-200 note-list shadow-md",children:[n("thead",{children:c("tr",{children:[n("th",{className:"w-11/12 lg:w-9/12",children:"Note"}),n("th",{className:"hidden lg:block w-2/12",children:"Edited"}),n("th",{className:"w-1/12"})]})}),n("tbody",{children:e.sort((h,N)=>h.lastEditedTime<N.lastEditedTime?1:-1).map((h,N)=>c("tr",{id:`row-${h.id}`,children:[n("td",{children:n("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:()=>{u(h.id),r(`${L.panelWorkspace}#${h.id}`)},children:c("div",{className:"flex flex-col text-left",children:[c("div",{className:"font-medium flex space-x-1",children:[n("span",{children:h.title||"No Title"}),n("span",{className:`rounded-full h-2 w-2 bg-green-500 ${d.find(I=>I==h.id)?"inline":"hidden"} `})]}),n("span",{className:"text-sm text-gray-500 font-light",children:h.text||"empty"})]})})}),n("td",{className:"hidden lg:block",children:new Date(h.lastEditedTime).toLocaleString(navigator.language,{year:"numeric",month:"long",day:"numeric"})}),n("td",{children:n("button",{onClick:()=>f(h),children:n(pt,{})})})]},N))})]}),n(G,{handleClick:h=>r(`${L.panelWorkspace}#${h}`)})]}),n(X,{isOpen:a,note:o,onRequestClose:()=>{l(null),s(!1)}})]})}const an=()=>{const e=S();return c("div",{className:"flex space-x-4",children:[n(p.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"rounded-full h-8 w-8 bg-gray-200 hover:opacity-80 hover:bg-gray-800 hover:text-white  flex justify-center items-center",onClick:()=>e(-1),children:n(vt,{})}),n(p.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"rounded-full h-8 w-8 bg-gray-200 hover:opacity-80 hover:bg-gray-800 hover:text-white  flex justify-center items-center",onClick:()=>e(1),children:n(wt,{})})]})},sn=()=>{const{toggleNav:e}=i.exports.useContext(v);return n(p.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"rounded-full h-8 w-8 bg-white opacity-80 hover:bg-gray-800 hover:text-white  flex justify-center items-center",onClick:e,children:n(bt,{})})},on=()=>{const e=S(),{navOpen:t}=i.exports.useContext(v);return n(D,{children:t&&c(p.div,{initial:{scale:0,left:-50},animate:{scale:1,left:0},exit:{scale:0,left:-50},className:`h-fit bg-gray-200 backdrop-blur-lg rounded-r-xl shadow-lg flex flex-col space-y-2 items-center py-5 px-1  shrink-0 fixed bottom-0 top-0 left-0 my-auto 
      lg:w-32`,children:[c(k,{onClick:()=>e(L.home),children:[n(yt,{})," ",n("span",{className:"hidden lg:block",children:"Home"})]}),c(k,{children:[n(Ct,{})," ",n("span",{className:"hidden lg:block",children:"Search"})]})]})})},rn=e=>c("div",{className:"min-h-screen max-w-full h-full",children:[c("div",{className:"w-full flex justify-between items-center mb-2 py-2 px-3",children:[n(sn,{}),n("div",{children:n(an,{})})]}),c("div",{className:"flex flex-row-reverse",children:[n("div",{className:"w-full overflow-scroll",children:n(kt,{})}),n(on,{})]})]}),ln=i.exports.lazy(()=>It(()=>import("./canvas-workspace.4d82faf4.js"),["assets/canvas-workspace.4d82faf4.js","assets/canvas-workspace.4f101438.css","assets/vendor.6f5c5b13.js"]));function cn(e){return n(Nt,{basename:"/poche",children:n(i.exports.Suspense,{fallback:n("div",{children:"Loading..."}),children:n(Et,{children:c(R,{path:"/",element:n(rn,{}),children:[n(R,{index:!0,element:n(nn,{})}),n(R,{path:"canvas",element:n(ln,{})}),n(R,{path:"panel",element:n(tn,{})})]})})})})}const L={home:"/",panelWorkspace:"/panel"};function dn(){return n(Qt,{children:n(cn,{})})}const un=Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function hn(e){if("serviceWorker"in navigator){if(new URL("/poche/",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const a="/poche//service-worker.js";un?(mn(a,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):J(a,e)})}}function J(e,t){navigator.serviceWorker.register(e).then(a=>{a.onupdatefound=()=>{const s=a.installing;s!=null&&(s.onstatechange=()=>{s.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(a)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(a)))})}}).catch(a=>{console.error("Error during service worker registration:",a)})}function mn(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const s=a.headers.get("content-type");a.status===404||s!=null&&s.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(o=>{o.unregister().then(()=>{window.location.reload()})}):J(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}Rt.render(n(i.exports.StrictMode,{children:n(dn,{})}),document.getElementById("root"));hn();export{Zt as E,v as N,U as g,Xt as o,L as p,xn as s};
