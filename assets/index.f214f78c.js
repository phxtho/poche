var me=Object.defineProperty,fe=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var W=(e,t,s)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,k=(e,t)=>{for(var s in t||(t={}))ge.call(t,s)&&W(e,s,t[s]);if(V)for(var s of V(t))pe.call(t,s)&&W(e,s,t[s]);return e},I=(e,t)=>fe(e,xe(t));import{u as ve,j as i,a as n,L as we,m as be,I as ye,n as Ce,F as Ne,N as ke,E as Ee,b as Re,R as Se,c as Ie,d as Oe,i as Ae,e as A,f as Le,g as _e,s as Me,h as Te,k as Be,l as De,o as Fe,p as Pe,q as je,r as qe,t as $e,v as Ve,w as We,x as He,y as Ue,z as Qe,A as ze,B as Ge,C as Xe,D as Ke,G as Ye,H as l,J as Je,M as Ze,K as et,O as tt,P as nt,Q as st,S as at,T as ot,U as rt,V as lt,W as ct,X as it,Y as dt,Z as ut,_ as ht,$ as M,a0 as X,a1 as B,a2 as mt,a3 as S,a4 as ft,a5 as xt,a6 as gt,a7 as C,a8 as pt,a9 as vt,aa as H,ab as K,ac as Y,ad as wt,ae as bt,af as yt,ag as O,ah as Ct,ai as Nt,aj as kt,ak as Et,al as Rt,am as St,an as It,ao as Ot,ap as At,aq as Lt,ar as _t,as as Mt,at as Tt,au as Bt,av as Dt,aw as U,ax as Ft,ay as J,az as Pt,aA as jt,aB as qt,aC as $t,aD as Vt,aE as Wt,aF as Ht,aG as Ut,aH as Qt,aI as E,aJ as zt}from"./vendor.f4f3363b.js";const Gt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}};Gt();const Q=e=>{const[{isDragging:t},s,a]=ve({item:e.item,collect:o=>({isDragging:!!o.isDragging()})});return i("div",{id:e.item.id,ref:a,className:"card",style:{display:t&&e.hideSourceOnDrag?"none":"flex",opacity:t?.5:1,top:e.item.y,left:e.item.x},children:[n("div",{className:"flex justify-end p-3",children:n("div",{ref:s,id:`${e.item.id}-drag-handle`,className:"card-drag-handle"})}),e.children]})},R={CARD:"card",COLLECTION:"collection"};class Xt extends we{constructor(t){super(t);this.addHandler("onClick",(s,a)=>(window.open(a.href),!0))}createInputRules(){return[be({regexp:(()=>{try{return new RegExp("?<!!)[(.*?)]((.*?))")}catch{return/[^!]\[(.+?)\]\((.+?)\)/}})(),type:this.type,getAttributes:t=>{const[s,a,o]=t;return{text:a,href:o}}})]}createPasteRules(){return[]}}class Kt extends ye{createInputRules(){return[Ce({regexp:/!\[(.+?)\]\((.+?)\)/,type:this.type,getAttributes:t=>{const[s,a,o]=t;return{src:o,alt:a}}})]}}function Yt(e,t){for(let s of t){let a=s(e);if(a!==!1)return a}return!1}function Jt(e,t){return Ne.from(t.text(e))}function Zt(e){var s;let t=e.querySelector("img.mwe-math-fallback-image-inline[alt]");return(s=t==null?void 0:t.getAttribute("alt"))!=null?s:!1}function en(e){var s;let t=e.querySelector("math[alttext]");return(s=t==null?void 0:t.getAttribute("alttext"))!=null?s:!1}function tn(e){var s;let t=e.querySelector("math annotation[encoding='application/x-tex'");return(s=t==null?void 0:t.textContent)!=null?s:!1}function nn(e){return Yt(e,[Zt,en,tn])}const sn={tag:"span",getAttrs(e){return e.classList.contains("mwe-math-element")?null:!1},getContent(e,t){let a=nn(e)||"\\text{\\color{red}(paste error)}";return Jt(a,t)}},an=[sn];var on=Object.defineProperty,rn=Object.getOwnPropertyDescriptor,Z=(e,t,s,a)=>{for(var o=a>1?void 0:a?rn(t,s):t,r=e.length-1,c;r>=0;r--)(c=e[r])&&(o=(a?c(t,s,o):c(o))||o);return a&&o&&on(t,s,o),o};let L=class extends ke{get name(){return"math_inline"}createTags(){return[Ee.InlineNode]}createNodeSpec(e,t){return I(k({group:"inline math",content:"text*",inline:!0,atom:!0},t),{attrs:k({},e.defaults()),parseDOM:[{tag:"math-inline"},...an],toDOM:()=>["math-inline",{class:"math-node"},0]})}createInputRules(){return[Re(Se,this.type)]}createExternalPlugins(){return[Ie]}createKeymap(e){return{Backspace:Oe(A(De),A(Le),A(_e),A(Me))}}insertMathInline(){return e=>(Ae(this.type),null)}};Z([Te()],L.prototype,"insertMathInline",1);L=Z([Be({defaultOptions:{}})],L);const ln=[Fe,Pe,je,qe,$e,Ve,We,He,Ue,Qe,ze,Ge,Xe,Ke,Ye],cn=l.exports.forwardRef((e,t)=>{var h;const s=l.exports.useCallback(({json:f,invalidContent:x,transformers:g})=>g.remove(f,x),[]),{manager:a,state:o,setState:r,getContext:c}=Je({extensions:()=>[new Ze({}),new et({}),new tt,new nt,new Xt({defaultTarget:"_blank",autoLink:!0}),new st({}),new at({}),new ot,new rt,new Kt({enableResizing:!0}),new lt,new ct,new L,new it({supportedLanguages:ln,defaultLanguage:"typescript"}),new dt],onError:s,content:(h=e.state)==null?void 0:h.doc});return l.exports.useImperativeHandle(t,()=>c(),[c]),n("div",{className:"remirror-theme",children:n(ut,{manager:a,initialContent:o,onChange:f=>{var x;r(f.state),(x=e.onChange)==null||x.call(e,f)},onFocus:(f,x)=>{var g;(g=e.onFocus)==null||g.call(e,f,x)},onBlur:(f,x)=>{var g;(g=e.onBlur)==null||g.call(e,f,x)},children:n(ht,{})})})});M.plugin(X);let y=new M("notes");const dn={type:"doc",content:[{type:"paragraph"}]};async function D(e){try{const t=e.id||e._id;return await y.upsert(t,a=>e)}catch(t){console.log(`ERROR: couldn't update 
${t}`)}}async function ee(e,t,s,a,o,r){try{let c={_id:e||B(),id:null,title:t||null,meta:s||{},state:a||dn,createdTime:o||Date.now(),lastEditedTime:r||Date.now()};return c.id=c._id,await y.putIfNotExists(c)}catch(c){console.log(`ERROR: couldn't create doc ${c}`)}}async function un(e){try{const t=await y.get(e).then(a=>a._rev);return await y.remove(e,t)}catch(t){console.log(`ERROR: couldn't delete 
${t}`)}}async function T(){var e;try{let t=await y.allDocs({include_docs:!0});return(e=t==null?void 0:t.rows)==null?void 0:e.map(s=>s.doc)}catch(t){console.log(`ERROR fetching all notes 
${t}`)}}async function hn(e){try{return await y.get(e)}catch(t){console.log(`ERROR fetching  ${e} 
${t}`)}}function te(e){y.changes({since:"now",live:!0}).on("change",()=>e())}async function mn(e){return new mt(await T(),{keys:["title","text"],includeMatches:!0,minMatchCharLength:2,includeScore:!0,threshold:.5,ignoreLocation:!0}).search(e)}let F={items:[],addItem:(e,t)=>{F.items=se(e,t)},removeItem:(e,t)=>{F.items=ne(e,t)}};const ne=(e,t)=>e.filter(s=>s!==t),se=(e,t)=>e.find(s=>s===t)?e:[...e,t],N=l.exports.createContext(F);N.displayName="NotesContext";const _=({children:e,className:t,onClick:s})=>n("button",{className:`h-12 w-full max-w-xs px-4 py-3 bg-gray-200 opacity-80 rounded-xl flex justify-between items-center ${t}`,onClick:s,children:e}),ae=e=>{var o,r;S.setAppElement("#root");const{items:t,removeItem:s}=l.exports.useContext(N),a=(o=e.note)==null?void 0:o.id;return n(S,{isOpen:(r=e.isOpen)!=null?r:!1,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,overlayClassName:"rounded-lg max-w-xl mx-auto",children:i("div",{children:[n("h1",{className:"text-center mb-2",children:"actions"}),i("div",{className:"flex flex-col space-y-4",children:[e.children,i(_,{onClick:()=>{s(t,a),e.onRequestClose()},children:[n("span",{children:"Close"})," ",n(ft,{})]}),i(_,{onClick:()=>{s(t,a),un(a!=null?a:""),e.onRequestClose()},children:[n("span",{children:"Delete"})," ",n(xt,{})]})]})]})})},fn=e=>{const{getHTML:t,getMarkdown:s}=gt();return i(C,{children:[i(_,{onClick:()=>{var f;const r=`<!DOCTYPE html>
    <html>
    <head>
      <link href="https://cdn.jsdelivr.net/npm/base-css-theme@1.1.3/base.css" rel="stylesheet">
    </head>
    <body style="padding: 16px;">${t()}</body>
    </html>`;let c=`${e.note.title}.html`,h=new Blob([r],{type:"text/plain;charset=utf-8"});H.saveAs(h,c),(f=e.onRequestClose)==null||f.call(e)},children:[n("span",{children:"Export HTML"})," ",n(pt,{})]}),i(_,{onClick:()=>{var h;let r=`${e.note.title}.md`,c=new Blob([s()],{type:"text/plain;charset=utf-8"});H.saveAs(c,r),(h=e.onRequestClose)==null||h.call(e)},children:[n("span",{children:"Export Markdown"})," ",n(vt,{})]})]})};const oe=e=>{const[t,s]=l.exports.useState(),[a,o]=l.exports.useState(!1),[r,c]=l.exports.useState(!1),h=l.exports.useRef(),f=l.exports.useRef(),x=K(),g=l.exports.useCallback(async()=>{if(e.id){let p=await hn(e.id);p&&s(p)}},[e.id]);l.exports.useEffect(()=>{g()},[g]),l.exports.useEffect(()=>{if(x.hash){const p=x.hash.substring(1);e.id===p&&f.current&&f.current.scrollIntoView({behavior:"smooth"})}},[x.hash,e.id]);const d=l.exports.useCallback(p=>{const v=I(k({},t),{state:p.state.toJSON(),lastEditedTime:Date.now()});s(v)},[t]),u=l.exports.useCallback((p,v)=>{t.text=p.helpers.getText(),D(t),o(!1)},[t]),m=l.exports.useCallback((p,v)=>{var $;o(!0),($=e.handleFocus)==null||$.call(e,h.current)},[e]);return t?i(C,{children:[i("div",{id:e.id,ref:f,className:"w-full md:w-5/12 lg:w-1/3 shadow-lg rounded-lg p-5 lg:mr-4 mb-4 editor-container",children:[i("div",{className:"flex justify-between",children:[n("textarea",{placeholder:"Title",defaultValue:t==null?void 0:t.title,className:"font-semibold text-4xl w-11/12",onChange:p=>{let v=p.target.value;v.replace(/\n/,""),t.title=v,D(t)},wrap:"soft"}),n("div",{className:"flex space-x-2",children:n("button",{className:`h-4 w-4 rounded-full border hover:bg-gray-700 hover:border-gray-700 ${a?"border-black bg-black":"border-gray-400"}`,onClick:()=>c(!0)})})]}),n(cn,{state:t.state,onChange:d,onBlur:u,onFocus:m,ref:h})]}),h.current&&n(Y.Provider,{value:h.current,children:n(ae,{isOpen:r,note:t,onRequestClose:()=>{c(!1)},children:n(fn,{note:t,onRequestClose:()=>{c(!1)}})})})]}):null};const xn=e=>{const[t,s]=l.exports.useState([]),a=l.exports.useCallback(async()=>{const o=await T();s(o)},[s]);return l.exports.useEffect(()=>{a(),te(a)},[a]),n("div",{className:"flex w-64 flex-col rounded items-center divide-y divide-gray-200 divide-opacity-50",children:t.map((o,r)=>{var h;const c=(h=o==null?void 0:o.state)!=null&&h.doc?o.text:"";return n("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:()=>{e.handleNoteButtonClick(o)},children:o.title||c},r)})})};function gn(){return n(wt,{backend:bt,children:n(pn,{})})}const pn=e=>{const[s,a]=l.exports.useState({x:0,y:0}),[o,r]=l.exports.useState({x:0,y:0}),c=[],[,h]=yt({accept:[R.CARD,R.COLLECTION],drop:(d,u)=>{const m=u.getDifferenceFromInitialOffset(),p=Math.round(d.x+m.x),v=Math.round(d.y+m.y);return d.type===R.CARD?x(d.id,p,v):r({x:p,y:v}),{x:p,y:v}}}),f=l.exports.useCallback((d,u)=>{R.CARD,B()},[]),x=l.exports.useCallback((d,u,m)=>{},[]),g=d=>{d==null||d.id,R.CARD};return i("div",{className:"canvas",ref:h,onMouseMove:d=>{a({x:d.nativeEvent.offsetX,y:d.nativeEvent.offsetY})},onDoubleClick:d=>{f(d.nativeEvent.offsetX,d.nativeEvent.offsetY)},children:[!1,n(Q,{item:{type:R.COLLECTION,id:B(),x:o.x,y:o.y},children:n(xn,{handleNoteButtonClick:g})}),Object.entries(c).map(([d,u],m)=>n(Q,{item:u,hideSourceOnDrag:!0,children:n(oe,{id:u.id})},m))]})};function re(){const[e,t]=l.exports.useState(!1),[s,a]=l.exports.useState(""),[o,r]=l.exports.useState([]),{items:c,addItem:h}=l.exports.useContext(N),f=O(),x=K(),g="/poche/p",d=u=>{mn(u).then(m=>r(m))};return i("div",{className:"relative shadow-sm",children:[i("div",{className:"h-10 w-72  rounded-full flex justify-between pl-6 items-center relative",children:[n("input",{placeholder:"Search",className:"w-3/4 h-full bg-transparent overflow-ellipsis",type:"text",value:s,onChange:u=>{const{value:m}=u.target;a(m),d(m)},onFocus:u=>t(!0),onBlur:u=>t(!1)}),n("button",{className:"h-10 w-10 rounded-full bg-black text-white flex justify-center items-center",children:n(Ct,{})})]}),s!==""&&o.length>0&&n("div",{className:"search-results rounded-b-lg overflow-hidden",children:o.map(u=>n(vn,{onResultClick:()=>{a(""),h(c,u.item.id),x.pathname!==g&&f(g)},result:u},u.item.id))})]})}const vn=({result:e,onResultClick:t})=>{const s=e.matches.some(o=>o.key==="title"),a=e.matches.some(o=>o.key==="text");return i("button",{className:"result bg-white text-left p-2",onClick:o=>{t==null||t()},children:[i("div",{className:"text-sm",children:[s&&e.matches.map((o,r)=>o.key==="title"?n(z,{match:o},r):null),!s&&e.item.title]}),i("div",{className:"text-xs font-extralight",children:[a&&e.matches.map((o,r)=>o.key==="text"?n(z,{match:o},r):null),!a&&e.item.text]})]})},z=({match:e})=>{var a,o,r,c;const[[t,s]]=e.indices;return i(C,{children:[(a=e.value)==null?void 0:a.substring(0,t),n("span",{className:"bg-yellow-300",children:(o=e.value)==null?void 0:o.substring(t,s)}),(c=e.value)==null?void 0:c.substring(s,(r=e.value)==null?void 0:r.length)]})};function wn(){return i("div",{className:"min-h-screen",children:[n("div",{id:"top-bar",className:"flex flex-row-reverse p-8",children:n(re,{})}),n(gn,{})]})}function le(e){const{items:t,addItem:s}=l.exports.useContext(N),a=l.exports.useCallback(async()=>{let o=await ee();return s(t,o.id),o.id},[s,t]);return n("button",{onClick:async()=>{var r;const o=await a();(r=e==null?void 0:e.handleClick)==null||r.call(e,o)},className:"rounded-full h-16 w-16 fixed right-8 bottom-8 bg-black text-white flex justify-center items-center shadow-md hover:pointer border-2 border-white",children:n(Nt,{})})}const b=e=>e?"active":"",bn=()=>{const e=kt(),t=Et();return i("div",{className:"toolbar space-x-2",children:[n("button",{onClick:()=>{e.undo(),e.focus()},children:n(Rt,{})}),n("button",{onClick:()=>{e.redo(),e.focus()},children:n(St,{})}),n("button",{className:b(t.bold()),onClick:()=>{e.toggleBold(),e.focus()},children:n(It,{})}),n("button",{className:b(t.italic()),onClick:()=>{e.toggleItalic(),e.focus()},children:n(Ot,{})}),n("button",{className:b(t.underline()),onClick:()=>{e.toggleUnderline(),e.focus()},children:n(At,{})}),n("button",{className:b(t.code()),onClick:()=>{e.toggleCode(),e.focus()},children:n(Lt,{})}),n("button",{className:b(t.blockquote()),onClick:()=>{e.toggleBlockquote(),e.focus()},children:n(_t,{})}),n("button",{className:b(t.bulletList()),onClick:()=>{e.toggleBulletList(),e.focus()},children:n(Mt,{})}),n("button",{className:b(t.taskList()),onClick:()=>{e.toggleTaskList(),e.focus()},children:n(Tt,{})})]})};function yn(){const{items:e}=l.exports.useContext(N),[t,s]=l.exports.useState(),a=O();return l.exports.useEffect(()=>{e.length===0&&a("/poche")},[e]),i(C,{children:[n("div",{className:"editor-list",children:e.map(o=>n(oe,{id:o,handleFocus:r=>s(r)},o))}),t&&n(Y.Provider,{value:t,children:n(bn,{})}),n(le,{})]})}const Cn=()=>{const e=O();return n("button",{onClick:()=>e("/poche/settings"),className:"rounded-full h-16 w-16 fixed left-8 bottom-8 bg:white hover:bg-black hover:text-white flex justify-center items-center shadow-md hover:pointer",children:n(Bt,{})})};function Nn(){const[e,t]=l.exports.useState([]),[s,a]=l.exports.useState(!1),[o,r]=l.exports.useState(),c=O(),{items:h,addItem:f}=l.exports.useContext(N),x=l.exports.useCallback(async()=>{const d=await T();t(d)},[t]),g=d=>{r(d),a(!0)};return l.exports.useEffect(()=>(x(),te(x),()=>{t([])}),[x]),i(C,{children:[i("div",{className:"p-5",children:[i("table",{className:"rounded-lg divide-y divide-gray-200 note-list shadow-md",children:[n("thead",{children:i("tr",{children:[n("th",{className:"w-11/12 lg:w-9/12",children:"Note"}),n("th",{className:"hidden lg:block w-2/12",children:"Edited"}),n("th",{className:"w-1/12"})]})}),n("tbody",{children:e.sort((d,u)=>d.lastEditedTime<u.lastEditedTime?1:-1).map((d,u)=>i("tr",{id:`row-${d.id}`,children:[n("td",{children:n("button",{className:"truncate w-full transition duration-250 ease-in-out bg-gradient-to-r hover:from-gray-100 hover:to-gray-200",onClick:()=>{f(h,d.id),c(`/poche/p#${d.id}`)},children:i("div",{className:"flex flex-col text-left",children:[i("div",{className:"font-medium flex space-x-1",children:[n("span",{children:d.title||"No Title"}),n("span",{className:`rounded-full h-2 w-2 bg-green-500 ${h.find(m=>m==d.id)?"inline":"hidden"} `})]}),n("span",{className:"text-sm text-gray-500 font-light",children:d.text||"empty"})]})})}),n("td",{className:"hidden md:block",children:new Date(d.lastEditedTime).toLocaleString()}),n("td",{children:n("button",{onClick:()=>g(d),children:n(Dt,{})})})]},u))})]}),n(Cn,{}),n(le,{handleClick:d=>c(`/poche/p#${d}`)})]}),n(ae,{isOpen:s,note:o,onRequestClose:()=>{r(null),a(!1)}})]})}M.plugin(X);let q=new M("peers");function kn(e){q.changes({since:"now",live:!0}).on("change",()=>e())}async function En(e){try{const t=e.id||e._id;return await q.upsert(t,a=>e)}catch(t){console.log(`ERROR: couldn't upsert 
${t}`)}}async function G(){var e;try{let t=await q.allDocs({include_docs:!0});return(e=t==null?void 0:t.rows)==null?void 0:e.map(s=>s.doc)}catch(t){console.log(`ERROR fetching all peers 
${t}`)}}let P,w,j;P=localStorage.getItem("peerId");try{w=new U(P)}catch{w=new U,P=w.id}w.on("open",function(e){localStorage.setItem("peerId",e),console.log("My peer ID is: "+e)});w.on("connection",e=>{console.log(`Connected to ${e.peer}`),Object.keys(w.connections).forEach(t=>{ce(t)}),e=e,e.on("open",()=>{e.on("data",t=>{console.log(`Recieved data from ${e.peer}`),console.log(t),Array.isArray(t)&&t.forEach(s=>D(s))})})});w.on("error",e=>{console.error(e)});const ce=e=>{En({id:e})};function ie(e){try{j=w.connect(e,{serialization:"json"}),Object.keys(w.connections).forEach(t=>{ce(t)})}catch(t){console.log(t)}}async function de(){try{j.on("open",async()=>{let e=await T();j.send(e),console.log("data sent")})}catch(e){console.log(e)}}const ue=()=>{const[e,t]=l.exports.useState([]);return l.exports.useEffect(()=>(G().then(s=>t(s)),kn(s=>G().then(a=>t(a))),()=>{t([])}),[]),n("div",{className:"flex space-x-2",children:e==null?void 0:e.map((s,a)=>n("button",{className:"rounded-3xl shadow-lg bg-black text-white h-10 w-10 flex flex-col justify-center items-center overflow-hidden ",children:n(Ft,{})},a))})};function Rn(){const[e,t]=l.exports.useState(""),[s,a]=l.exports.useState();l.exports.useEffect(()=>{var c;let r=document.getElementById("qrcode");(c=J)==null||c.toCanvas(r,localStorage.getItem("peerId")),document.getElementById("videoOutCanvas")},[]);let o=()=>{requestAnimationFrame(o)};return requestAnimationFrame(o),i(C,{children:[i("div",{className:"flex",children:[i("div",{className:"flex flex-col",children:[n("input",{className:"border border-black",type:"text",value:e,onChange:r=>{t(r.target.value)}}),n("button",{className:"rounded bg-blue-500 text-white",onClick:r=>{ie(e)},children:"Connect"})]}),i("div",{className:"flex flex-col",children:[n("textarea",{className:"border border-black",onChange:r=>{a(r.target.value)}}),n("button",{className:"bg-green-500 text-white rounded",onClick:r=>{de()},children:"Send"})]})]}),n(ue,{}),n("canvas",{id:"videoOutCanvas",hidden:!0}),n("video",{id:"video"})]})}const Sn={content:{borderRadius:".5rem",height:"fit-content",maxWidth:"40rem",marginLeft:"auto",marginRight:"auto"}};S.setAppElement("#root");const In=e=>{const[t,s]=l.exports.useState(),[a,o]=l.exports.useState(null),r=l.exports.useCallback(c=>{c!==null&&o(c)},[]);return l.exports.useEffect(()=>{const c=localStorage.getItem("peerId");s(c)},[]),l.exports.useEffect(()=>{var c;a&&((c=J)==null||c.toCanvas(a,t))},[t,a]),n(S,{isOpen:e.isOpen,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,style:Sn,children:i("div",{className:"flex flex-col justify-center items-center",children:[n("canvas",{id:"qrcode",ref:r}),n("p",{className:"text-center",children:t})]})})},On={content:{borderRadius:".5rem",height:"fit-content",maxWidth:"40rem",marginLeft:"auto",marginRight:"auto"}};S.setAppElement("#root");const An=e=>{const[t,s]=l.exports.useState(null),[a,o]=l.exports.useState(null),[r,c]=l.exports.useState(""),[h,f]=l.exports.useState(),x=l.exports.useCallback(u=>{u!==null&&s(u)},[]),g=l.exports.useCallback(u=>{u!==null&&o(u)},[]);l.exports.useEffect(()=>{const u={video:{facingMode:"environment",frameRate:{ideal:10,max:15}}};try{navigator.mediaDevices.getUserMedia(u).then(m=>{f(m),a&&(a.srcObject=m,a.setAttribute("playsinline","true"),a.play(),requestAnimationFrame(d))})}catch(m){console.log(`Couldn't set up video stream 
:${m}`)}return()=>{d=null,h==null||h.getTracks().forEach(m=>{m.stop()})}},[a]),l.exports.useEffect(()=>{!e.isOpen&&(h==null?void 0:h.active)&&h.getTracks().forEach(u=>{u.stop()})},[e.isOpen,h]);let d=()=>{if(a&&a.readyState===a.HAVE_ENOUGH_DATA){let p=t.getContext("2d");t.height=a.videoHeight,t.width=a.videoWidth,p.drawImage(a,0,0,t.width,t.height);var u=p.getImageData(0,0,t.width,t.height),m=Pt(u.data,u.width,u.height,{inversionAttempts:"dontInvert"});m!=null&&m.data&&(console.log("Got QR Code"),console.log(m.data),c(m.data),e==null||e.onScanned(m.data),d=null)}d&&requestAnimationFrame(d)};return i(S,{isOpen:e.isOpen,onAfterClose:e.onAfterOpen,onRequestClose:e.onRequestClose,style:On,children:[n("canvas",{id:"videoOutCanvas",ref:x,hidden:!0}),n("video",{id:"video",ref:g})]})},Ln=5e5,_n=({onUpload:e,maxFileSize:t=Ln,multiple:s=!1,accept:a="*"})=>{const o=l.exports.useRef(null);return i("section",{children:[i("button",{type:"button",className:"flex space-x-2 items-center bg-black text-white px-5 py-2 rounded-3xl",onClick:r=>o.current.click(),children:[n(jt,{}),i("span",{children:[" Upload ",s?"files":"a file"]})]}),n("input",{type:"file",ref:o,title:"",value:"",accept:a,className:"hidden",onChange:r=>{const{files:c}=r.target;c.length&&(e==null||e(c))}})]})};function Mn(e){const t=new FileReader;for(let s=0;s<e.length;s++){const a=e[s];t.onload=o=>{const r=o.target.result,h=new qt.Renderer().render(r),f=a.name.replace(".html","");ee(null,f,null,{doc:h,selection:null})},a.type==="text/html"&&t.readAsText(a)}}const Tn=()=>{const[e,t]=l.exports.useState(!1),[s,a]=l.exports.useState(!1);return i(C,{children:[i("div",{className:"p-5",children:[n("h1",{children:"Import HTML"}),n(_n,{accept:".html",onUpload:o=>Mn(o)}),n("h1",{children:"Replication"}),i("div",{className:"flex flex-col items-center",children:[n("h3",{children:"Connected Devices"}),n(ue,{}),n("h3",{children:"Add Devices"}),i("div",{className:"flex items-center justify-center w-full flex-wrap md:space-x-4",children:[i("button",{className:"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2",onClick:()=>t(!0),children:[n($t,{})," ",n("span",{children:"Show QR Code"})]}),i("button",{className:"rounded-3xl bg-black text-white flex space-x-1 p-2 items-center justify-center w-full md:w-1/3 mb-2",onClick:()=>a(!0),children:[n(Vt,{})," ",n("span",{children:"Scan"})]})]})]})]}),n(In,{isOpen:e,onRequestClose:()=>t(!1)}),n(An,{isOpen:s,onRequestClose:()=>a(!1),onScanned:async o=>{ie(o),await de(),a(!1)}})]})},Bn=()=>{const e=O();return n("button",{className:"h-8 w-8 hover:bg-black hover:text-white rounded-full flex justify-center items-center",onClick:()=>e(-1),children:n(Wt,{})})},Dn=e=>i("div",{className:"min-h-screen max-w-full",children:[i("div",{className:"w-full flex justify-between items-center mb-2 p-2",children:[n(Bn,{}),n("div",{className:"hidden md:inline-block",children:n(re,{})})]}),n(Ht,{})]});function Fn(e){return n(Ut,{children:n(Qt,{children:i(E,{path:"poche",element:n(Dn,{}),children:[n(E,{index:!0,element:n(Nn,{})}),n(E,{path:"canvas",element:n(wn,{})}),n(E,{path:"p",element:n(yn,{})}),n(E,{path:"settings",element:n(Tn,{})}),n(E,{path:"demo",element:n(Rn,{})})]})})})}function Pn(){const[e,t]=l.exports.useState({items:[],addItem:(a,o)=>{a.find(r=>r===o)||t(I(k({},e),{items:se(a,o)}))},removeItem:(a,o)=>{t(I(k({},e),{items:ne(a,o)}))}}),s=l.exports.useMemo(()=>e,[e]);return n("div",{className:"App",children:n(N.Provider,{value:s,children:n(Fn,{})})})}const jn=Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function qn(e){if("serviceWorker"in navigator){if(new URL({}.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const s=`${{}.PUBLIC_URL}/service-worker.js`;jn?($n(s,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):he(s,e)})}}function he(e,t){navigator.serviceWorker.register(e).then(s=>{s.onupdatefound=()=>{const a=s.installing;a!=null&&(a.onstatechange=()=>{a.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(s)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(s)))})}}).catch(s=>{console.error("Error during service worker registration:",s)})}function $n(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(s=>{const a=s.headers.get("content-type");s.status===404||a!=null&&a.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(o=>{o.unregister().then(()=>{window.location.reload()})}):he(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}zt.render(n(l.exports.StrictMode,{children:n(Pn,{})}),document.getElementById("root"));qn();
